---
title: Criar uma conta de armazenamento do Azure e um cofre de chaves
description: Este tópico explica como criar uma conta de armazenamento do Azure e um cofre de chaves.
author: gionoder
manager: AnnBe
ms.date: 09/22/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 97423
ms.assetid: ''
ms.search.region: Global
ms.author: janeaug
ms.search.validFrom: 2020-07-08
ms.dyn365.ops.version: AX 10.0.12
ms.openlocfilehash: 5a883011bbff6d82504497d739c07f1ada9e5f69
ms.sourcegitcommit: f860ac2b18f6bbbfc4a46b497baec2477105b116
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/19/2020
ms.locfileid: "4440528"
---
# <a name="create-an-azure-storage-account-and-a-key-vault"></a><span data-ttu-id="1ac33-103">Criar uma conta de armazenamento do Azure e um cofre de chaves</span><span class="sxs-lookup"><span data-stu-id="1ac33-103">Create an Azure storage account and a key vault</span></span>

[!include [banner](../includes/banner.md)]



<span data-ttu-id="1ac33-104">O serviço complementar de faturamento eletrônica é responsável pelo armazenamento de todos os dados comerciais nos recursos do Microsoft Azure pertencentes à sua empresa.</span><span class="sxs-lookup"><span data-stu-id="1ac33-104">The Electronic invoicing add-on service takes responsibility for storing all your business data in the Microsoft Azure resources that are owned by your company.</span></span> <span data-ttu-id="1ac33-105">Para garantir que o serviço funcione corretamente e que todos os dados comerciais necessários e gerados pelo complemento de faturamento eletrônico sejam acessados somente pelo complemento, crie dois recursos principais do Azure:</span><span class="sxs-lookup"><span data-stu-id="1ac33-105">To ensure that the service works correctly, and that all the business data that is needed for and generated by the Electronic invoicing add-on is accessed only by the add-on, you must create two main Azure resources:</span></span>

- <span data-ttu-id="1ac33-106">Uma conta de armazenamento do Azure (armazenamento de Blob) para armazenar faturas eletrônicas</span><span class="sxs-lookup"><span data-stu-id="1ac33-106">An Azure storage account (Blob storage) to store electronic invoices</span></span>
- <span data-ttu-id="1ac33-107">Um Azure Key Vault para armazenar certificados e o URI (Uniform Resource Identifier) da conta de armazenamento</span><span class="sxs-lookup"><span data-stu-id="1ac33-107">An Azure key vault to store certificates and the Uniform Resource Identifier (URI) of the storage account</span></span>

> [!NOTE]
> <span data-ttu-id="1ac33-108">Um recurso de compartimento de cofre de chaves e armazenamento de Blob de cliente deve ser alocado especificamente para ser usado com o complemento de faturamento eletrônico.</span><span class="sxs-lookup"><span data-stu-id="1ac33-108">A dedicated key vault resource and customer Blob storage must be allocated specifically for use with the Electronic invoicing add-on.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="1ac33-109">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="1ac33-109">Prerequisites</span></span>

<span data-ttu-id="1ac33-110">Antes de concluir as etapas neste tópico, verifique se as seguintes tarefas foram concluídas:</span><span class="sxs-lookup"><span data-stu-id="1ac33-110">Before you can complete the steps in this topic, you must make sure that the following tasks have been completed:</span></span>

- <span data-ttu-id="1ac33-111">Criar um recurso de cofre de chaves no Azure.</span><span class="sxs-lookup"><span data-stu-id="1ac33-111">Create a key vault resource in Azure.</span></span> <span data-ttu-id="1ac33-112">Para obter mais informações, consulte [Sobre o Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview).</span><span class="sxs-lookup"><span data-stu-id="1ac33-112">For more information, see [About Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview).</span></span>
- <span data-ttu-id="1ac33-113">Crie uma conta de armazenamento do Azure (armazenamento de Blob).</span><span class="sxs-lookup"><span data-stu-id="1ac33-113">Create an Azure storage account (Blob storage).</span></span> <span data-ttu-id="1ac33-114">Para obter mais informações, consulte [Manter a conta de armazenamento do Azure](https://docs.microsoft.com/azure/storage/blobs/).</span><span class="sxs-lookup"><span data-stu-id="1ac33-114">For more information, see [Maintaining Azure Storage Account](https://docs.microsoft.com/azure/storage/blobs/).</span></span>

## <a name="overview"></a><span data-ttu-id="1ac33-115">Visão Geral</span><span class="sxs-lookup"><span data-stu-id="1ac33-115">Overview</span></span>

<span data-ttu-id="1ac33-116">Neste tópico, você executará duas etapas principais:</span><span class="sxs-lookup"><span data-stu-id="1ac33-116">In this topic, you will complete two main steps:</span></span>

- <span data-ttu-id="1ac33-117">Configure a conta de armazenamento do Azure para obter o URI da conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="1ac33-117">Set up the Azure storage account to get the storage account URI.</span></span>
- <span data-ttu-id="1ac33-118">Configure o cofre de chaves para armazenar o URI da conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="1ac33-118">Set up the key vault to store the storage account URI.</span></span>

## <a name="set-up-the-azure-storage-account-to-get-the-storage-account-uri"></a><span data-ttu-id="1ac33-119">Configure a conta de armazenamento do Azure para obter o URI da conta de armazenamento</span><span class="sxs-lookup"><span data-stu-id="1ac33-119">Set up the Azure storage account to get the storage account URI</span></span>

1. <span data-ttu-id="1ac33-120">Abra a conta de armazenamento que você pretende usar com o complemento de faturamento eletrônico.</span><span class="sxs-lookup"><span data-stu-id="1ac33-120">Open the storage account that you plan to use with the Electronic invoicing add-on.</span></span>
2. <span data-ttu-id="1ac33-121">Vá para **Serviço Blob** \> **Contêineres** e crie um novo contêiner.</span><span class="sxs-lookup"><span data-stu-id="1ac33-121">Go to **Blob service** \> **Containers**, and create a new container.</span></span>
3. <span data-ttu-id="1ac33-122">Digite um nome para o contêiner e defina o campo **Nível de acesso público** como **Privado (sem acesso anônimo)**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-122">Enter a name for the container, and set the **Public access level** field to **Private (no anonymous access)**.</span></span>
4. <span data-ttu-id="1ac33-123">Abra o contêiner e vá para **Configurações \> Política de acesso**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-123">Open the container, and go to **Settings \> Access policy**.</span></span>
5. <span data-ttu-id="1ac33-124">Selecione **Adicionar política** para adicionar uma política de acesso armazenada.</span><span class="sxs-lookup"><span data-stu-id="1ac33-124">Select **Add policy** to add a stored access policy.</span></span>
6. <span data-ttu-id="1ac33-125">Defina os campos **Identificador** e **Permissões**, conforme apropriado.</span><span class="sxs-lookup"><span data-stu-id="1ac33-125">Set the **Identifier** and **Permissions** fields as appropriate.</span></span> <span data-ttu-id="1ac33-126">No campo **Permissões**, você deve selecionar todas as permissões.</span><span class="sxs-lookup"><span data-stu-id="1ac33-126">In the **Permissions** field, you should select all permissions.</span></span>

    ![Conceder permissão de armazenamento de Blobs](media/e-Invoicing-services-create-azure-resources-grant-blob-permissions.png)

7. <span data-ttu-id="1ac33-128">Insira as datas de início e de vencimento.</span><span class="sxs-lookup"><span data-stu-id="1ac33-128">Enter the start and expiry dates.</span></span> <span data-ttu-id="1ac33-129">A data de vencimento deve estar no futuro.</span><span class="sxs-lookup"><span data-stu-id="1ac33-129">The expiry date should be in future.</span></span>
8. <span data-ttu-id="1ac33-130">Selecione **OK** para salvar a política e salve as alterações no contêiner.</span><span class="sxs-lookup"><span data-stu-id="1ac33-130">Select **OK** to save the policy, and then save your changes to the container.</span></span>
9. <span data-ttu-id="1ac33-131">Retorne à conta de armazenamento e abra o **Gerenciador de Armazenamento (versão prévia)**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-131">Return to the storage account, and open **Storage Explorer (preview)**.</span></span>
10. <span data-ttu-id="1ac33-132">Clique com o botão direito do mouse no contêiner e selecione **Obter assinatura de acesso compartilhado**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-132">Right-click the container, and then select **Get Shared Access Signature**.</span></span>
11. <span data-ttu-id="1ac33-133">Na caixa de diálogo **Assinatura de acesso compartilhado**, copie e armazene o valor no campo **URI**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-133">In the **Shared Access Signature** dialog box, copy and store the value in the **URI** field.</span></span> <span data-ttu-id="1ac33-134">Esse valor será usado no procedimento seguinte e será referenciado como *URI de assinatura de acesso compartilhado*.</span><span class="sxs-lookup"><span data-stu-id="1ac33-134">This value will be used in the next procedure and will be referred to as the *shared access signature URI*.</span></span>

    ![Selecionar e copiar o valor do URI](media/e-Invoicing-services-create-azure-resources-select-and-copy-uri.png)

## <a name="set-up-the-key-vault-to-store-the-storage-account-uri"></a><span data-ttu-id="1ac33-136">Configure o cofre de chaves para armazenar o URI da conta de armazenamento</span><span class="sxs-lookup"><span data-stu-id="1ac33-136">Set up the key vault to store the storage account URI</span></span>

1. <span data-ttu-id="1ac33-137">Abra o cofre de chaves que você pretende usar com o complemento de faturamento eletrônico.</span><span class="sxs-lookup"><span data-stu-id="1ac33-137">Open the key vault that you intend to use with the Electronic invoicing add-on.</span></span>
2. <span data-ttu-id="1ac33-138">Vá para **Configurações** \> **Segredos** e selecione **Gerar/Importar** para criar um novo segredo.</span><span class="sxs-lookup"><span data-stu-id="1ac33-138">Go to **Settings** \> **Secrets**, and then select **Generate/Import** to create a new secret.</span></span>
3. <span data-ttu-id="1ac33-139">Na página **Criar um segredo**, no campo **Opções de carregamento**, selecione **Manual**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-139">On the **Create a secret** page, in the **Upload options** field, select **Manual**.</span></span>
4. <span data-ttu-id="1ac33-140">Insira o nome do segredo.</span><span class="sxs-lookup"><span data-stu-id="1ac33-140">Enter the name of the secret.</span></span> <span data-ttu-id="1ac33-141">Esse nome será usado durante a configuração do serviço no RCS (Regulatory Configuration Service) e será referenciado como *Nome secreto do cofre de chaves*.</span><span class="sxs-lookup"><span data-stu-id="1ac33-141">This name will be used during setup of the service in Regulatory Configuration Service (RCS) and will be referred to as the *key vault secret name*.</span></span>
5. <span data-ttu-id="1ac33-142">No campo **Valor**, selecione **URI de Assinatura de Acesso Compartilhado** e, em seguida, selecione **Criar**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-142">In the **Value** field, select **Shared Access Signature URI**, and then select **Create**.</span></span>
6. <span data-ttu-id="1ac33-143">Configure a política de acesso para conceder ao complemento de faturamento eletrônico o nível correto de acesso seguro ao segredo criado.</span><span class="sxs-lookup"><span data-stu-id="1ac33-143">Set up the access policy to grant the Electronic invoicing add-on the correct level of secure access to the secret you created.</span></span> <span data-ttu-id="1ac33-144">Vá para **Configurações \> Política de acesso** e selecione **Adicionar Política de Acesso**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-144">Go to **Settings \> Access policy**, and select **Add Access Policy**.</span></span>
7. <span data-ttu-id="1ac33-145">Defina as permissões secretas para as operações **Obter** e **Lista**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-145">Set the secret permissions for the **Get** and **List** operations.</span></span>

    ![Conceder acesso ao serviço](media/e-Invoicing-services-create-azure-resources-grant-service-access.png)

8. <span data-ttu-id="1ac33-147">Defina as permissões de certificado para operações **Obter** e **Lista**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-147">Set the certificate permissions for **Get** and **List** operations.</span></span>

    ![Conceder permissão de certificado](media/e-Invoicing-services-create-azure-resources-grant-certificate-permission.png)

9. <span data-ttu-id="1ac33-149">Na caixa de diálogo **Principal**, selecione o principal, adicionando o **Complemento de faturamento eletrônico**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-149">In the **Principal** dialog box, select the principal by adding **Electronic invoicing add-on**.</span></span>
10. <span data-ttu-id="1ac33-150">Selecione **Adicionar** e, em seguida, **Salvar alterações do Key Vault**.</span><span class="sxs-lookup"><span data-stu-id="1ac33-150">Select **Add**, and then select **Save Key Vault changes**.</span></span>
11. <span data-ttu-id="1ac33-151">Na página **Visão geral**, copie o valor **Nome do DNS** para o cofre de chaves.</span><span class="sxs-lookup"><span data-stu-id="1ac33-151">On the **Overview** page, copy the **DNS name** value for the key vault.</span></span> <span data-ttu-id="1ac33-152">Esse valor será usado durante a configuração do serviço no RCS e será referenciado como o *URI do cofre de chaves*.</span><span class="sxs-lookup"><span data-stu-id="1ac33-152">This value will be used during setup of the service in RCS and will be referred as the *key vault URI*.</span></span>
