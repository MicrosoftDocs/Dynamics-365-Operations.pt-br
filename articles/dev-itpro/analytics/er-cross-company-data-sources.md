---
title: Fontes de dados interempresariais no relatório eletrônico (ER)
description: Este tópico explica como você pode usar fontes de dados interempresariais no relatório eletrônico (ER).
author: NickSelin
manager: AnnBe
ms.date: 05/25/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: 3ff94c49eed378d92e995782e73d76d669b44292
ms.sourcegitcommit: 9d4c7edd0ae2053c37c7d81cdd180b16bf3a9d3b
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/15/2019
ms.locfileid: "1552755"
---
# <a name="cross-company-data-sources-in-electronic-reporting-er"></a><span data-ttu-id="fb2d1-103">Fontes de dados interempresariais no relatório eletrônico (ER)</span><span class="sxs-lookup"><span data-stu-id="fb2d1-103">Cross-company data sources in Electronic reporting (ER)</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="fb2d1-104">Você pode criar os formatos de relatórios eletrônicos (ER) para gerar documentos de saída em vários formatos.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-104">You can design Electronic reporting (ER) formats to generate outgoing documents in various formats.</span></span> <span data-ttu-id="fb2d1-105">Quando um documento é gerado, um formato de ER chama as fontes de dados que foram configuradas em um mapeamento de modelo de ER correspondente.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-105">When a document is generated, an ER format calls data sources that were configured in a corresponding ER model mapping.</span></span> <span data-ttu-id="fb2d1-106">Para configurar o acesso a tabelas de aplicativo para a recuperação do registro, você pode usar fontes de dados de ER do tipo **Registros de tabela** .</span><span class="sxs-lookup"><span data-stu-id="fb2d1-106">To configure access to application tables for record retrieval, you can use ER data sources of the **Table records** type.</span></span> <span data-ttu-id="fb2d1-107">Quando a tabela de acesso é uma tabela compartilhada (isto é, uma tabela na qual os dados são salvos sem um identificador da empresa), esta fonte de dados retorna todos os registros.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-107">When the accessing table is a shared table (that is, a table where data is saved without a company identifier), this data source returns all records.</span></span> <span data-ttu-id="fb2d1-108">Quando a tabela de acesso é uma tabela dependente da empresa (isto é uma tabela onde os dados são salvos por empresa), esta fonte de dados retorna somente os registros que foram salvos para a empresa atual (isto é, o contexto da empresa que o formato de ER está executando).</span><span class="sxs-lookup"><span data-stu-id="fb2d1-108">When the accessing table is a company-dependent table (that is, a table where data is saved per company), this data source returns only the records that have been saved for the current company (that is, the company context that the ER format is running under).</span></span>

<span data-ttu-id="fb2d1-109">Cada fonte de dados do tipo **Registros de tabela** em um mapeamento de modelo pode agora ser marcado como uma fonte de dados interempresariais.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-109">Every data source of the **Table records** type in a model mapping can be now marked as a cross-company data source.</span></span> <span data-ttu-id="fb2d1-110">No entanto, você pode usar as fontes de dados do tipo **Registros da tabela** para acessar os dados interempresariais nas tabelas do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-110">Therefore, you can use data sources of the **Table records** type to access cross-company data in application tables.</span></span>

<span data-ttu-id="fb2d1-111">Se você marcar uma fonte de dados como interempresarial, ocorre o seguinte comportamento:</span><span class="sxs-lookup"><span data-stu-id="fb2d1-111">If you mark a data source as cross-company, the following behavior occurs:</span></span>

- <span data-ttu-id="fb2d1-112">Para uma fonte de dados que se refere a qualquer tabela compartilhada, exceto CompanyInfo, a fonte de dados retorna todos os registros que existem na tabela referenciada.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-112">For a data source that refers to any shared table except CompanyInfo, the data source returns all records that exist in the referenced table.</span></span> 
- <span data-ttu-id="fb2d1-113">Para uma fonte de dados que se refere a tabela de CompanyInfo, mesmo que CompanyInfo seja uma tabela compartilhada, a fonte de dados retorna registros que contêm o identificador de uma empresa do escopo definido.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-113">For a data source that refers to the CompanyInfo table, even though CompanyInfo is a shared table, the data source returns the records that contain the identifier of a company from the defined scope.</span></span>
- <span data-ttu-id="fb2d1-114">Para qualquer tabela dependente da empresa, a fonte de dados retorna os registros da tabela referenciada que contêm o identificador de uma empresa do escopo definido.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-114">For any company-dependent table, the data source returns the records of the referenced table that contain the identifier of a company from the defined scope.</span></span>

<span data-ttu-id="fb2d1-115">Na caixa de diálogo de consulta do sistema, quando a opção **Solicitar consulta** for ativada para qualquer fonte de dados que for marcada como interempresarial, você pode selecionar manualmente uma ou mais empresas para incluir na guia **Intervalo da empresa**.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-115">In the system query dialog box, when the **Ask for query** option is turned on for any data source that is marked as cross-company, you can manually select one or more companies to include on the **Company range** tab.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="fb2d1-116">Como outros filtros, o filtro da empresa é persistente como o último valor usado para consultas quando você executa um formato de ER.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-116">Like other filters, the company filter is persisted as a last-used value for queries when you run an ER format.</span></span> <span data-ttu-id="fb2d1-117">O filtro não é alterado automaticamente se você alterar o valor interempresarial de uma fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-117">The filter isn't automatically changed if you change the cross-company value for a data source.</span></span> <span data-ttu-id="fb2d1-118">Para usar um valor diferente interempresarial para outra fonte de dados, exclua a seleção específica do usuário correspondente.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-118">To use a different cross-company value for another data source, delete the corresponding user-specific selection.</span></span>

<span data-ttu-id="fb2d1-119">Para cada fonte de dados que é marcada como interempresarial, selecione os registros que você deseja, usando as funções **FILTER** e **WHERE** nas expressões do ER.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-119">For every data source that is marked as cross-company, you can select the records that you want by using the **FILTER** and **WHERE** functions in ER expressions.</span></span> <span data-ttu-id="fb2d1-120">O campo **dataAreaID** também pode ser usado como identificador da empresa.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-120">The **dataAreaID** field can also be used as a company identifier.</span></span> <span data-ttu-id="fb2d1-121">Atualmente, o campo **dataAreaID** está limitado aos seguintes tipos de condições, quando a função **FILTER** for usada:</span><span class="sxs-lookup"><span data-stu-id="fb2d1-121">Currently, the **dataAreaID** field is limited to the following types of conditions when the **FILTER** function is used:</span></span>

- <span data-ttu-id="fb2d1-122">Somente condições que têm uma única comparação do campo **dataAreaID** são suportadas.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-122">Only conditions that have a single **dataAreaID** field comparison are supported.</span></span>
- <span data-ttu-id="fb2d1-123">Apenas as comparações com as expressões que não depende dos itens de lista de registros são permitidas.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-123">Only comparisons that have expressions that don't depend on records list items are allowed.</span></span>

<span data-ttu-id="fb2d1-124">No entanto, a seguinte expressão é válida.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-124">Therefore, the following expression is valid.</span></span>

```
FILTER (MyTable, MyTable.dataAreaID = $StringUserInputParameter)
While shown below expressions will not pass the validation:
FILTER (MyTable, MyTable.dataAreaID = MyTable2RecordsList.MyField)
FILTER (MyTable, 
    OR(
        MyTable.dataAreaID = $StringUserInputParameter1,
        MyTable.dataAreaID = $StringUserInputParameter2
    )
)
```

<span data-ttu-id="fb2d1-125">Por padrão, o escopo inclui todas as empresas do aplicativo atual.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-125">By default, the scope includes all companies of the current application.</span></span> <span data-ttu-id="fb2d1-126">Porém, poderá ser restrito.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-126">However, it can be restricted.</span></span> <span data-ttu-id="fb2d1-127">Para restringir o escopo de acesso a dados interempresarial para um único formato de ER, atribua uma hierarquia organizacional específica ao formato.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-127">To restrict the scope of cross-company data access for a single ER format, assign a specific organization hierarchy to the format.</span></span> <span data-ttu-id="fb2d1-128">Quando a hierarquia é definida para um formato de ER, apenas os registros das entidades legais que são apresentados na hierarquia atribuída são retornados, mesmo que o formato chame fontes de dados interempresariais.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-128">When a hierarchy is defined for an ER format, only records for legal entities that are presented in the assigned hierarchy are returned, even though the format calls cross-company data sources.</span></span> <span data-ttu-id="fb2d1-129">Quando uma referência a uma hierarquia que não existe é definida para um formato de ER, o escopo padrão será aplicado e o formato chama as fontes de dados interempresariais.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-129">When a reference to a hierarchy that no longer exists is defined for an ER format, the default scope is applied, and the format calls cross-company data sources.</span></span> <span data-ttu-id="fb2d1-130">Nessa situação, os registros de todas as empresas do aplicativo são retornadas.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-130">In this situation, records for all application companies are returned.</span></span>

<span data-ttu-id="fb2d1-131">Observe que quando a opção **Usar o rascunho** está ativada para aquela atribuída a uma hierarquia de organização do formato de ER único, as entidades legais da versão rascunho desta hierarquia serão usadas para identificar o escopo das fontes de dados interempresariais.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-131">Note that when the **Use draft** option is turned on for the assigned to a single ER format organization hierarchy, the legal entities from the draft version of this hierarchy will be used to identify the scope for cross-company data sources.</span></span> <span data-ttu-id="fb2d1-132">Se a versão de rascunho não existir, as entidades legais da última versão publicada dessa hierarquia da organização serão usadas para isso.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-132">If the draft version does not exist, the legal entities from the last published version of this organization hierarchy will be used for this.</span></span>

<span data-ttu-id="fb2d1-133">Observe que quando a opção **Usar rascunho** estiver desativada para aquela atribuída a uma hierarquia de organização do formato de ER único, as entidades legais da última versão publicada desta hierarquia da organização serão usadas para identificar o escopo das fontes de dados interempresariais.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-133">Note that when the **Use draft** option is turned off for the assigned to a single ER format organization hierarchy, the legal entities from the last published version of this organization hierarchy will be used to identify the scope for cross-company data sources.</span></span> <span data-ttu-id="fb2d1-134">A eficiência de data das hierarquias de organização não é suportada ainda na estrutura de ER.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-134">Date effectiveness of organization hierarchies is not supported yet in the ER framework.</span></span>

<span data-ttu-id="fb2d1-135">A hierarquia pode ser atribuída a um formato em uma página específica que pode ser acessada do espaço de trabalho de ER ou usando o item de menu **Administração da organização \> Relatório eletrônico \> Filtro de entidade legal para formatos**.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-135">The hierarchy can be assigned to a format in a specific page that can be accessed from the ER workspace or by using the **Organization administration \> Electronic reporting \> Legal entity filter for formats** menu item.</span></span> <span data-ttu-id="fb2d1-136">Para acessar a página, o privilégio **Manter filtros de entidade legal para formatos** (ERMaintainFormatMappingLegalEntityFilters) deve ser concedido a um usuário.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-136">To access the page, the **Maintain legal entity filters for format** privilege (ERMaintainFormatMappingLegalEntityFilters) must be granted to a user.</span></span> <span data-ttu-id="fb2d1-137">A restrição do escopo de entidades legais baseadas para o formato é aplicada, além das restrições que o usuário pode especificar manualmente na caixa de diálogo de consulta do sistema.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-137">The scope restriction of hierarchy-based legal entities for the format is applied in addition to the restriction that the user can manually specify in the system query dialog box.</span></span> <span data-ttu-id="fb2d1-138">A interseção dessas restrições é usada quando o formato é executado.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-138">The intersection of these restrictions is used when the format is run.</span></span>

<span data-ttu-id="fb2d1-139">Para saber mais sobre este recurso, execute a guia de tarefas **ER Acessar registro de tabelas dependentes da empresa no modo interempresarial**, que faz parte do processo de negócios 7.5.4.3 Adquirir/Desenvolver componentes de serviço/solução de TI (10677) e pode ser baixada do [Centro de Download Microsoft](https://go.microsoft.com/fwlink/?linkid=874684).</span><span class="sxs-lookup"><span data-stu-id="fb2d1-139">To learn more about this feature, play the task guide, **ER Access records of company dependent tables in cross-company mode**, which is part of the 7.5.4.3 Acquire/Develop IT service/solution components (10677) business process, and can be downloaded from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=874684).</span></span> <span data-ttu-id="fb2d1-140">Este guia de tarefas o orienta por todo o processo de configuração de um mapeamento de modelos de ER e formato de ER para acessar tabelas do aplicativo no modo interempresarial.</span><span class="sxs-lookup"><span data-stu-id="fb2d1-140">This task guide walks you through the process of configuring an ER model mapping and ER format to access application tables in cross-company mode.</span></span>

<span data-ttu-id="fb2d1-141">Baixe os seguintes arquivos para completar o guia de tarefas:</span><span class="sxs-lookup"><span data-stu-id="fb2d1-141">Download the following files to complete the task guide:</span></span>

- [<span data-ttu-id="fb2d1-142">Configuração de modelo ER - CrossCompanyDataAccessModel.xml</span><span class="sxs-lookup"><span data-stu-id="fb2d1-142">ER model configuration - CrossCompanyDataAccessModel.xml</span></span>](https://go.microsoft.com/fwlink/?linkid=874111)
- [<span data-ttu-id="fb2d1-143">Configuração de formato ER - CrossCompanyDataAccessFormat.xml</span><span class="sxs-lookup"><span data-stu-id="fb2d1-143">ER format configuration - CrossCompanyDataAccessFormat.xml</span></span>](https://go.microsoft.com/fwlink/?linkid=874111)
