---
title: "Configurar importação de dados do SharePoint"
description: "Este tópico explica como importar dados do Microsoft SharePoint."
author: NickSelin
manager: AnnBe
ms.date: 05/21/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.translationtype: HT
ms.sourcegitcommit: 2fc887668171175d436b9eb281a35c1c9d089591
ms.openlocfilehash: 4285db9c71208bce45d64933e692a25ef3f46b26
ms.contentlocale: pt-br
ms.lasthandoff: 08/09/2018

---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="caa9c-103">Configurar importação de dados do SharePoint</span><span class="sxs-lookup"><span data-stu-id="caa9c-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="caa9c-104">Para importar dados de um arquivo de entrada usando a estrutura de relatório eletrônico (ER), é necessário configurar um formato de ER que suporta a importação e, em seguida, executar um mapeamento de modelo para o tipo **Para destino** que usa esse formato como uma origem de dados.</span><span class="sxs-lookup"><span data-stu-id="caa9c-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="caa9c-105">Para importar dados, você deve navegar para o arquivo que deseja importar.</span><span class="sxs-lookup"><span data-stu-id="caa9c-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="caa9c-106">O arquivo de entrada pode ser selecionado manualmente pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="caa9c-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="caa9c-107">Com a nova capacidade de ER de suportar importação de dados do Microsoft SharePoint, este processo pode ser configurado como autônomo.</span><span class="sxs-lookup"><span data-stu-id="caa9c-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as the unattended one.</span></span> <span data-ttu-id="caa9c-108">Você pode usar as configurações de ER para executar a importação de dados de arquivos armazenados em pastas do Microsoft SharePoint.</span><span class="sxs-lookup"><span data-stu-id="caa9c-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="caa9c-109">Este tópico explica como concluir a importação do SharePoint para Microsoft Dynamics 365 for Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="caa9c-109">This topic explains how to complete the import from SharePoint to Microsoft Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="caa9c-110">Os exemplos usam transações de fornecedor como dados comerciais.</span><span class="sxs-lookup"><span data-stu-id="caa9c-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="caa9c-111">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="caa9c-111">Prerequisites</span></span>
<span data-ttu-id="caa9c-112">Para concluir os exemplos neste tópico, você deve ter o seguinte acesso:</span><span class="sxs-lookup"><span data-stu-id="caa9c-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="caa9c-113">Acesso ao Finance and Operations para uma das seguintes funções:</span><span class="sxs-lookup"><span data-stu-id="caa9c-113">Access to Finance and Operations for one of the following roles:</span></span>

    - <span data-ttu-id="caa9c-114">Desenvolvedor de relatório eletrônico</span><span class="sxs-lookup"><span data-stu-id="caa9c-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="caa9c-115">Consultor funcional de relatório eletrônico</span><span class="sxs-lookup"><span data-stu-id="caa9c-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="caa9c-116">Administrador do sistema</span><span class="sxs-lookup"><span data-stu-id="caa9c-116">System administrator</span></span>

- <span data-ttu-id="caa9c-117">Acesso à instância do Microsoft SharePoint Server configurado para uso com o Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="caa9c-117">Access to the instance of Microsoft SharePoint Server that is configured for use with Finance and Operations</span></span>
- <span data-ttu-id="caa9c-118">Configurações de formato e modelo de ER para pagamentos de 1099</span><span class="sxs-lookup"><span data-stu-id="caa9c-118">ER format and model configurations for 1099 payments</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="caa9c-119">Criar configurações de ER necessárias</span><span class="sxs-lookup"><span data-stu-id="caa9c-119">Create required ER configurations</span></span>
<span data-ttu-id="caa9c-120">Executar os guias de tarefa **ER Importar dados de um arquivo do Microsoft Excel**, que fazem parte do processo de negócios **7.5.4.3 Adquirir/Desenvolver componentes de serviço/solução de TI (10677)**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="caa9c-121">Esses guias de tarefas o orientam no processo de criação e uso de configurações de ER para importar interativamente transações de fornecedores a partir de arquivos externos do Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="caa9c-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from external Microsoft Excel files.</span></span> <span data-ttu-id="caa9c-122">Para obter mais informações, consulte [Analisar documentos de entrada no Microsoft Excel](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="caa9c-122">For more information, see [Parse incoming documents in Microsoft Excel](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="caa9c-123">Finalmente, você terá:</span><span class="sxs-lookup"><span data-stu-id="caa9c-123">Fianlly, you will have:</span></span>

- <span data-ttu-id="caa9c-124">Configurações de ER:</span><span class="sxs-lookup"><span data-stu-id="caa9c-124">ER configurations:</span></span>

    - <span data-ttu-id="caa9c-125">Configuração de modelo de ER, **Modelo de pagamento 1099**</span><span class="sxs-lookup"><span data-stu-id="caa9c-125">ER model configuration, **1099 Payments model**</span></span>
    - <span data-ttu-id="caa9c-126">Configuração de formato de ER, **Formatar para importar transações de fornecedores do Excel**</span><span class="sxs-lookup"><span data-stu-id="caa9c-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

<span data-ttu-id="caa9c-127">[![Configurações de ER para importar dados do SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-127">[![ER configurations for importing data from SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span></span>

- <span data-ttu-id="caa9c-128">Exemplo de arquivo de entrada para importação de dados:</span><span class="sxs-lookup"><span data-stu-id="caa9c-128">Sample of the incoming file for data import:</span></span>

    - <span data-ttu-id="caa9c-129">Arquivo Excel **1099import-data.xlsx**, com transações do fornecedor que devem ser importadas para Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="caa9c-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported into Finance and Operations</span></span>

<span data-ttu-id="caa9c-130">[![Arquivo do Microsoft Excel de amostra para importação do Sharepoint](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-130">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span></span>

> [!NOTE]
> <span data-ttu-id="caa9c-131">O formato para importar transações do fornecedor é selecionado como o mapeamento de modelo padrão.</span><span class="sxs-lookup"><span data-stu-id="caa9c-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="caa9c-132">Portanto, se você executar um mapeamento de modelo do **Modelo de pagamentos 1099** e esse mapeamento de modelo for do tipo **Para destino**, o mapeamento de modelo executa este formato para importar dados dos arquivos externos.</span><span class="sxs-lookup"><span data-stu-id="caa9c-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="caa9c-133">Em seguida, usa esses dados para atualizar tabelas do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="caa9c-133">It then uses that data to update application tables.</span></span>

## <a name="configure-document-management-parameters"></a><span data-ttu-id="caa9c-134">Configurar parâmetros de gerenciamento do documento</span><span class="sxs-lookup"><span data-stu-id="caa9c-134">Configure Document management parameters</span></span>
1. <span data-ttu-id="caa9c-135">Na página **Parâmetros de gerenciamento de documentos**, configure o acesso à instância do SharePoint Server que será usado pela empresa à qual você está conectado.</span><span class="sxs-lookup"><span data-stu-id="caa9c-135">On the **Document management parameters** page, configure access to the SharePoint Server instance that will be used by the company that you're currently signed in to.</span></span> <span data-ttu-id="caa9c-136">Neste exemplo, a empresa é USMF.</span><span class="sxs-lookup"><span data-stu-id="caa9c-136">In this example, the company is USMF.</span></span>
2. <span data-ttu-id="caa9c-137">Teste a conexão com a instância do SharePoint Server para certificar-se de que você tem acesso.</span><span class="sxs-lookup"><span data-stu-id="caa9c-137">Test the connection to the SharePoint Server instance to make sure that you've been granted access.</span></span>

<span data-ttu-id="caa9c-138">[![Configuração de gerenciamento de documentos - servidor SharePoint](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span><span class="sxs-lookup"><span data-stu-id="caa9c-138">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span></span>

3. <span data-ttu-id="caa9c-139">Abra o site do SharePoint configurado e crie as seguintes pastas onde os arquivos de entrada podem ser estocados:</span><span class="sxs-lookup"><span data-stu-id="caa9c-139">Open the configured SharePoint site, and create the following folders where the incoming files can be stored:</span></span>

    - <span data-ttu-id="caa9c-140">Origem da importação de arquivos (pai)</span><span class="sxs-lookup"><span data-stu-id="caa9c-140">Files import source (main)</span></span>
    - <span data-ttu-id="caa9c-141">Origem da importação de arquivos (alternativa)</span><span class="sxs-lookup"><span data-stu-id="caa9c-141">Files import source (alternative)</span></span>

<span data-ttu-id="caa9c-142">[![Configuração de gerenciamento de documentos - servidor SharePoint](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span><span class="sxs-lookup"><span data-stu-id="caa9c-142">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span></span>

<span data-ttu-id="caa9c-143">[![Configuração de gerenciamento de documentos - servidor SharePoint](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span><span class="sxs-lookup"><span data-stu-id="caa9c-143">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span></span>

4. <span data-ttu-id="caa9c-144">No Finance and Operations, na página **Tipos de documento**, crie os seguintes tipos de documentos que serão usados para acessar as pasta do SharePoint que você acabou de criar:</span><span class="sxs-lookup"><span data-stu-id="caa9c-144">In Finance and Operations, on the **Document types** page, create the following document types that will be used to access the SharePoint folders that you just created:</span></span>

    - <span data-ttu-id="caa9c-145">SP principal</span><span class="sxs-lookup"><span data-stu-id="caa9c-145">SP Main</span></span>
    - <span data-ttu-id="caa9c-146">SP alternativa</span><span class="sxs-lookup"><span data-stu-id="caa9c-146">SP Alternative</span></span>

5. <span data-ttu-id="caa9c-147">Para tipos de documento criados, no campo **Grupo**, insira **Arquivo** e no campo **Local**, insira **SharePoint**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-147">For created document types, in the **Group** field, enter **File** and in the **Location** field, enter **SharePoint**.</span></span> <span data-ttu-id="caa9c-148">Em seguida, insira o endereço da pasta do SharePoint:</span><span class="sxs-lookup"><span data-stu-id="caa9c-148">Then enter the address of the SharePoint folder:</span></span>

    - <span data-ttu-id="caa9c-149">Do tipo de documento **SP principal**: Origem de importação dos arquivos (principal)</span><span class="sxs-lookup"><span data-stu-id="caa9c-149">For the **SP Main** document type: Files import source (main)</span></span>
    - <span data-ttu-id="caa9c-150">Do tipo de documento **SP alternativa**: Origem de importação de arquivos (alternativa)</span><span class="sxs-lookup"><span data-stu-id="caa9c-150">For the **SP Alternative** document type: Files import source (alternative)</span></span>

<span data-ttu-id="caa9c-151">[![Definição de SharePoint – novo tipo de documento](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span><span class="sxs-lookup"><span data-stu-id="caa9c-151">[![SharePoint setting – new document type](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span></span>

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="caa9c-152">Configurar fontes de ER para o formato de ER</span><span class="sxs-lookup"><span data-stu-id="caa9c-152">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="caa9c-153">Clique em **Administração da organização** > **Relatório eletrônico** > **Origem do relatório eletrônico**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-153">Click **Organization administration** > **Electronic reporting** > **Electronic reporting source**.</span></span>
2. <span data-ttu-id="caa9c-154">Na página **Origem do relatório eletrônico** , configure os arquivos de origem para a importação de dados usando o formato do ER configurado.</span><span class="sxs-lookup"><span data-stu-id="caa9c-154">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="caa9c-155">Defina uma máscara de nome de arquivo, para que somente os arquivos com a extensão .xlsx sejam importados.</span><span class="sxs-lookup"><span data-stu-id="caa9c-155">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="caa9c-156">A máscara do nome de arquivo é opcional e é usada somente quando for definida.</span><span class="sxs-lookup"><span data-stu-id="caa9c-156">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="caa9c-157">Você pode definir somente uma máscara para cada formato de ER.</span><span class="sxs-lookup"><span data-stu-id="caa9c-157">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="caa9c-158">Selecione duas pastas do SharePoint que você criou anteriormente.</span><span class="sxs-lookup"><span data-stu-id="caa9c-158">Select both SharePoint folders that you created earlier.</span></span>

<span data-ttu-id="caa9c-159">[![Configuração de origem dos arquivos ER](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-159">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
><span data-ttu-id="caa9c-160">A *origem* do ER é definida para cada empresa do aplicativo individualmente.</span><span class="sxs-lookup"><span data-stu-id="caa9c-160">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="caa9c-161">Por outro lado, as *configurações* do ER são compartilhadas entre as empresas.</span><span class="sxs-lookup"><span data-stu-id="caa9c-161">By contrast, ER *configurations* are shared across companies.</span></span>

> [!NOTE]
> <span data-ttu-id="caa9c-162">Quando você exclui uma configuração de origem de ER para um formato de ER, todos os estados de arquivos conectados (veja abaixo) também são excluídos.</span><span class="sxs-lookup"><span data-stu-id="caa9c-162">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="caa9c-163">Examinar os estados dos arquivos para o formato de ER</span><span class="sxs-lookup"><span data-stu-id="caa9c-163">Review the files states for the ER format</span></span>
1. <span data-ttu-id="caa9c-164">Na página **Origem do relatório eletrônico** , selecione **Estados dos arquivos das origens** para examinar o conteúdo de origens do arquivo configurado para o formato de ER atual.</span><span class="sxs-lookup"><span data-stu-id="caa9c-164">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="caa9c-165">Na seção **Arquivos** , examine a lista de arquivos.</span><span class="sxs-lookup"><span data-stu-id="caa9c-165">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="caa9c-166">Esta lista apresentará o seguinte:</span><span class="sxs-lookup"><span data-stu-id="caa9c-166">This list presents the following:</span></span>

    - <span data-ttu-id="caa9c-167">Arquivos de origem que são aplicáveis, com base na máscara de nome de arquivo (se uma máscara de nome de arquivo for definida) e que estão prontas para a importação de dados.</span><span class="sxs-lookup"><span data-stu-id="caa9c-167">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="caa9c-168">Para esses arquivos, a seção **Logs de origem do formato de importação** estará vazia.</span><span class="sxs-lookup"><span data-stu-id="caa9c-168">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="caa9c-169">Arquivos importados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="caa9c-169">Previously imported files.</span></span> <span data-ttu-id="caa9c-170">Para cada um desses arquivos, na seção **Logs de origem do formato de importação** , você pode revisar o histórico de importação deste arquivo.</span><span class="sxs-lookup"><span data-stu-id="caa9c-170">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="caa9c-171">Você também pode abrir a página **Estados dos arquivos das origens** selecionando **Administração da organização** \> **Relatório eletrônico** \> **Estados dos arquivos das origens**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-171">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="caa9c-172">Nesse caso, a página fornece informações sobre fontes de arquivo para todos os formatos de ER nos quais as origens do arquivo foram configuradas na empresa na qual você está conectado.</span><span class="sxs-lookup"><span data-stu-id="caa9c-172">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="caa9c-173">Importar dados dos arquivos do Excel que estão na pasta do SharePoint</span><span class="sxs-lookup"><span data-stu-id="caa9c-173">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="caa9c-174">No SharePoint, carregue o arquivo do Microsoft Excel **1099import-data.xlsx** que contém transações do fornecedor para a pasta do Sharepoint **Origem de importação dos arquivos (principal)** que você criou anteriormente.</span><span class="sxs-lookup"><span data-stu-id="caa9c-174">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

<span data-ttu-id="caa9c-175">[![Conteúdo do SharePoint – arquivo do Microsoft Excel para importação](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="caa9c-175">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="caa9c-176">No Finance and Operations, na página **Estados dos arquivos das origens**, selecione **Atualizar** para atualizar a página.</span><span class="sxs-lookup"><span data-stu-id="caa9c-176">In Finance and Operations, on the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="caa9c-177">Observe que o arquivo Excel que foi carregado para o SharePoint apareceu neste formulário com o status **Pronto**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-177">Note that the Excel file that was uploaded to SharePoint appeared in this form with the status **Ready**.</span></span> <span data-ttu-id="caa9c-178">Os seguintes status são suportados atualmente:</span><span class="sxs-lookup"><span data-stu-id="caa9c-178">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="caa9c-179">**Pronto** - Atribuído automaticamente para cada novo arquivo em uma pasta do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="caa9c-179">**Ready** - Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="caa9c-180">Este status indica que o arquivo está pronto para a importação.</span><span class="sxs-lookup"><span data-stu-id="caa9c-180">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="caa9c-181">**Importando** - Atribuído automaticamente para um relatório de ER quando o arquivo for bloqueado pelo processo de importação para impedir seu uso por outros processos (se vários deles forem executados simultaneamente.)</span><span class="sxs-lookup"><span data-stu-id="caa9c-181">**Importing** - Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="caa9c-182">**Importado** - atribuído automaticamente por um relatório de ER quando a importação do arquivo for concluída com sucesso.</span><span class="sxs-lookup"><span data-stu-id="caa9c-182">**Imported** - Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="caa9c-183">Este status indica que o arquivo importado foi excluído da origem de arquivos configurados (pasta do SharePoint).</span><span class="sxs-lookup"><span data-stu-id="caa9c-183">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="caa9c-184">**Com falha** - atribuído automaticamente por um relatório de ER quando a importação do arquivo for concluída com sucesso com erros ou exceções.</span><span class="sxs-lookup"><span data-stu-id="caa9c-184">**Failed** - Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="caa9c-185">**Em espera** - Atribuído manualmente pelo usuário neste formulário.</span><span class="sxs-lookup"><span data-stu-id="caa9c-185">**On hold** - Assigned manually by user on this form.</span></span> <span data-ttu-id="caa9c-186">Este status indica que o arquivo não será importado por enquanto.</span><span class="sxs-lookup"><span data-stu-id="caa9c-186">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="caa9c-187">Este status pode ser usado para adiar a importação de alguns arquivos.</span><span class="sxs-lookup"><span data-stu-id="caa9c-187">This status can be used to postpone the import of some files.</span></span>

<span data-ttu-id="caa9c-188">[![Página dos estados do arquivo de ER para as origens selecionadas](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="caa9c-188">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="caa9c-189">Importar dados de arquivos do SharePoint</span><span class="sxs-lookup"><span data-stu-id="caa9c-189">Import data from SharePoint files</span></span>
1. <span data-ttu-id="caa9c-190">Abra a árvore das configurações de ER, selecione **Modelo de pagamento 1099** e expanda a lista de componentes do modelo de ER.</span><span class="sxs-lookup"><span data-stu-id="caa9c-190">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="caa9c-191">Selecione o nome do mapeamento do modelo para abrir a lista de mapeamentos do modelo da configuração do modelo de ER selecionada.</span><span class="sxs-lookup"><span data-stu-id="caa9c-191">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

<span data-ttu-id="caa9c-192">[![Página dos estados do arquivo de ER para as origens selecionadas](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-192">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="caa9c-193">Selecione **Executar** para executar o mapeamento de modelo selecionado.</span><span class="sxs-lookup"><span data-stu-id="caa9c-193">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="caa9c-194">Como você configurou as origens do arquivo configurado para o formato de ER, você poderá alterar a configuração da opção **Origem de Arquivo**, conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="caa9c-194">Because you configured file sources for the ER format, you can change the setting of the **File source** option as you require.</span></span> <span data-ttu-id="caa9c-195">Se você mantiver a configuração desta opção, os arquivos .xslx são importados das origens configuradas (as pastas do Sharepoint, neste exemplo).</span><span class="sxs-lookup"><span data-stu-id="caa9c-195">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="caa9c-196">Neste exemplo, você está importando somente um arquivo.</span><span class="sxs-lookup"><span data-stu-id="caa9c-196">In this example, you're importing only one file.</span></span> <span data-ttu-id="caa9c-197">Porém, se houver vários arquivos, eles serão selecionados para importação na ordem em que foram adicionados à pasta do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="caa9c-197">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="caa9c-198">Cada execução de um formato de ER importa um único arquivo selecionado.</span><span class="sxs-lookup"><span data-stu-id="caa9c-198">Every run of an ER format imports a single selected file.</span></span>

<span data-ttu-id="caa9c-199">[![Executar mapeamento de modelo de ER](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-199">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="caa9c-200">O mapeamento do modelo pode ser executado no modo automático no lote.</span><span class="sxs-lookup"><span data-stu-id="caa9c-200">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="caa9c-201">Nesse caso, sempre que um lote executar esse formato de ER, um arquivo único é importado de origens do arquivo configurado.</span><span class="sxs-lookup"><span data-stu-id="caa9c-201">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span> <span data-ttu-id="caa9c-202">Use o código a seguir para implementar esta execução de lote.</span><span class="sxs-lookup"><span data-stu-id="caa9c-202">Use the following code to implement this batch run.</span></span>

    ```
    ERObjectsFactory::createMappingDestinationRunByImportFormatMappingId().run()
    ```

    <span data-ttu-id="caa9c-203">Quando um arquivo é importado com êxito da pasta do SharePoint, ele é excluído dessa pasta.</span><span class="sxs-lookup"><span data-stu-id="caa9c-203">When a file is successfully imported from the SharePoint folder, it's deleted from that folder.</span></span>

5. <span data-ttu-id="caa9c-204">Insira a ID de comprovante, como **V-00001** e depois selecione **OK**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-204">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

<span data-ttu-id="caa9c-205">[![Executar mapeamento de modelo de ER](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-205">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="caa9c-206">Na página **Estados dos arquivos das origens**, selecione **Atualizar** para atualizar a página.</span><span class="sxs-lookup"><span data-stu-id="caa9c-206">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

<span data-ttu-id="caa9c-207">[![Página dos estados do arquivo de ER para as origens selecionadas](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-207">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="caa9c-208">Na seção **Arquivos** , examine a lista de arquivos.</span><span class="sxs-lookup"><span data-stu-id="caa9c-208">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="caa9c-209">A seção **Logs de origem do formato de importação** fornece o histórico de importação de arquivo Excel.</span><span class="sxs-lookup"><span data-stu-id="caa9c-209">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="caa9c-210">Como esse arquivo foi importado com êxito, ele é marcado como **Excluído** na pasta do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="caa9c-210">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="caa9c-211">Revise a pasta do SharePoint **Origem da importação de arquivos (pai)**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-211">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="caa9c-212">Os arquivos do Excel que foram importados com sucesso foram excluídos desta pasta.</span><span class="sxs-lookup"><span data-stu-id="caa9c-212">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="caa9c-213">No Finance and Operations, selecione **Contas a pagar** \> **Tarefas periódicas** \> **Imposto 1099** \> **Liquidação de fornecedor para impostos 1099**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-213">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="caa9c-214">Nos campos **De** e **Até**, informe os valores apropriados.</span><span class="sxs-lookup"><span data-stu-id="caa9c-214">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="caa9c-215">Em seguida, selecione **Transações 1099 manuais**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-215">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="caa9c-216">As transações do fornecedor que foram importadas dos arquivos do Excel no SharePoint para o comprovante **V-00001**, são apresentadas na página.</span><span class="sxs-lookup"><span data-stu-id="caa9c-216">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

<span data-ttu-id="caa9c-217">[![Página transações do fornecedor 1099](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-217">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="caa9c-218">Preparar um arquivo do Excel para importação</span><span class="sxs-lookup"><span data-stu-id="caa9c-218">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="caa9c-219">Abra o arquivo do Excel usado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="caa9c-219">Open the Excel file that you previously used.</span></span> <span data-ttu-id="caa9c-220">Na linha 3, coluna 1 adicione um código do fornecedor que não existe no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="caa9c-220">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="caa9c-221">Inclua informações adicionais falsas de fornecedor na linha.</span><span class="sxs-lookup"><span data-stu-id="caa9c-221">Add additional false vendor information to the row.</span></span>

<span data-ttu-id="caa9c-222">[![Arquivo do Microsoft Excel de amostra para importação do Sharepoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-222">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="caa9c-223">Carregue o arquivo do Excel atualizado que contém as transações dos fornecedores para a pasta do SharePoint **Origem da importação de arquivos (pai)**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-223">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="caa9c-224">No Finance and Operations, abra a árvore de configurações de ER, selecione o **Modelo de pagamento 1099** e expanda a lista de componentes do modelo de ER.</span><span class="sxs-lookup"><span data-stu-id="caa9c-224">In Finance and Operations, open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="caa9c-225">Selecione o nome do mapeamento de modelo para atualizar o mapeamento de modelo, de forma que o código incorreto do fornecedor seja considerado um erro durante o processo de importação de dados.</span><span class="sxs-lookup"><span data-stu-id="caa9c-225">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="caa9c-226">Selecione **Designer**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-226">Select **Designer**.</span></span>
6. <span data-ttu-id="caa9c-227">Na guia **Validações** , você deverá alterar a ação de pós-validação para a regra de validação que foi configurada para avaliar se a conta de fornecedor importada existe no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="caa9c-227">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="caa9c-228">Atualize o valor do campo **Ação pós-validação** para **Parar execução**, salve suas alterações e feche a página.</span><span class="sxs-lookup"><span data-stu-id="caa9c-228">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

<span data-ttu-id="caa9c-229">[![ER Página designer de mapeamento do modelo](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-229">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="caa9c-230">Salvar suas alterações e feche o designer de mapeamento de modelo do ER.</span><span class="sxs-lookup"><span data-stu-id="caa9c-230">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="caa9c-231">Selecione **Executar** para executar o mapeamento de modelo de ER modificado.</span><span class="sxs-lookup"><span data-stu-id="caa9c-231">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="caa9c-232">Insira a ID de comprovante, como **V-00002** e depois selecione **OK**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-232">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="caa9c-233">Observe que o log de informações contém a notificação informando que residindo no arquivo da pasta do Sharepoint contém conta de fornecedor incorreta e não pode ser importada.</span><span class="sxs-lookup"><span data-stu-id="caa9c-233">Note that the Infolog contains the notification informing that residing in SharePoint folder file contains incorrect vendor account and can’t be imported.</span></span>

<span data-ttu-id="caa9c-234">[![Executar mapeamento de modelo de ER](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-234">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="caa9c-235">Na página **Estados dos arquivos das origens**, selecione **Atualizar** e, em seguida, na seção **Arquivos**, revise a lista de arquivos.</span><span class="sxs-lookup"><span data-stu-id="caa9c-235">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

<span data-ttu-id="caa9c-236">[![Página dos estados do arquivo de ER para as origens selecionadas](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="caa9c-236">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

<span data-ttu-id="caa9c-237">A seção **Logs de origem do formato de importação** indica que o processo de importação falhou e que o arquivo ainda está na pasta do SharePoint (a caixa de seleção **Excluído** não foi selecionada).</span><span class="sxs-lookup"><span data-stu-id="caa9c-237">The **Sources log for the import format** section indicates that the import process failed and that the file is still in the SharePoint folder (the **Is deleted** checkbox is not selected).</span></span> <span data-ttu-id="caa9c-238">Se você corrigir este arquivo no SharePoint adicionando o código do fornecedor adequado e, em seguida, alterar o status do arquivo de **Com Falha** para **Pronto** na seção **Logs de origem do formato de importação**, você pode importar o arquivo novamente.</span><span class="sxs-lookup"><span data-stu-id="caa9c-238">If you fix this file on SharePoint by adding the proper vendor code and then change the status of the file from **Failed** to **Ready** in the **Sources log for the import format** section, you can import the file again.</span></span>

11. <span data-ttu-id="caa9c-239">Revise a pasta do SharePoint **Origem da importação de arquivos (pai)**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-239">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="caa9c-240">Observe que o arquivo do Excel que não foi importado ainda está nesta pasta.</span><span class="sxs-lookup"><span data-stu-id="caa9c-240">Notice that the Excel file that wasn't imported is still in this folder.</span></span>
12. <span data-ttu-id="caa9c-241">Em Finance and Operations, selecione **Contas a pagar** \> **Tarefas periódicas** \> **Imposto 1099** \> **Liquidação de fornecedor para impostos 1099**, insira os valores apropriados nos campos **De** e **Até** e selecione **Transações 1099 manuais**.</span><span class="sxs-lookup"><span data-stu-id="caa9c-241">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="caa9c-242">Somente as transações para o comprovante V-00001 estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="caa9c-242">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="caa9c-243">Nenhuma transação para o comprovante V-00002 estará disponível, mesmo que o erro da última transação importada seja encontrado no arquivo do Excel.</span><span class="sxs-lookup"><span data-stu-id="caa9c-243">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>

