---
title: Trabalho de limpeza de entradas disponíveis do gerenciamento de depósito
description: Este tópico descreve o trabalho de limpeza de entradas disponíveis, que ajuda a melhorar o desempenho do sistema identificando e excluindo registros relacionados, mas não necessários.
author: perlynne
manager: tfehr
ms.date: 04/23/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: SysOperationTemplateForm
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: perlynne
ms.search.validFrom: 2020-04-03
ms.dyn365.ops.version: Release 10.0.12
ms.openlocfilehash: 93c77434a912554dab486b42c0c9fffd68cf9435
ms.sourcegitcommit: eaf330dbee1db96c20d5ac479f007747bea079eb
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/15/2021
ms.locfileid: "5225994"
---
# <a name="warehouse-management-on-hand-entries-cleanup-job"></a><span data-ttu-id="65e43-103">Trabalho de limpeza de entradas disponíveis do gerenciamento de depósito</span><span class="sxs-lookup"><span data-stu-id="65e43-103">Warehouse management on-hand entries cleanup job</span></span>

<span data-ttu-id="65e43-104">O desempenho das consultas que são usadas para calcular o estoque disponível é afetado pelo número de registros nas tabelas envolvidas.</span><span class="sxs-lookup"><span data-stu-id="65e43-104">The performance of queries that are used to calculate on-hand inventory is affected by the number of records in the tables that are involved.</span></span> <span data-ttu-id="65e43-105">Uma forma de ajudar a melhorar o desempenho é reduzir o número de registros que o banco de dados deve considerar.</span><span class="sxs-lookup"><span data-stu-id="65e43-105">One way to help improve the performance is to reduce the number of records that the database must consider.</span></span>

<span data-ttu-id="65e43-106">Este tópico descreve o trabalho de limpeza de entradas disponíveis, que exclui registros desnecessários nas tabelas InventSum e WHSInventReserve.</span><span class="sxs-lookup"><span data-stu-id="65e43-106">This topic describes the on-hand entries cleanup job, which deletes unneeded records in the InventSum and WHSInventReserve tables.</span></span> <span data-ttu-id="65e43-107">Essas tabelas armazenam informações disponíveis para itens habilitados para processamento de gerenciamento de depósito.</span><span class="sxs-lookup"><span data-stu-id="65e43-107">These tables store on-hand information for items that are enabled for warehouse management processing.</span></span> <span data-ttu-id="65e43-108">(Esses itens são mencionados como itens de WHS). A exclusão desses registros pode melhorar significativamente o desempenho dos cálculos disponíveis.</span><span class="sxs-lookup"><span data-stu-id="65e43-108">(These items are referred to as WHS items.) Deletion of these records can significantly improve the performance of on-hand calculations.</span></span>

## <a name="what-the-cleanup-job-does"></a><span data-ttu-id="65e43-109">O que o trabalho de limpeza faz</span><span class="sxs-lookup"><span data-stu-id="65e43-109">What the cleanup job does</span></span>

<span data-ttu-id="65e43-110">O trabalho de limpeza de entradas disponíveis exclui quaisquer registros nas tabelas WHSInventReserve e InventSum em que todos os valores de campo sejam *0* (zero).</span><span class="sxs-lookup"><span data-stu-id="65e43-110">The on-hand entries cleanup job deletes any records in the WHSInventReserve and InventSum tables where all the field values are *0* (zero).</span></span> <span data-ttu-id="65e43-111">Esses registros podem ser excluídos porque não contribuem para as informações disponíveis.</span><span class="sxs-lookup"><span data-stu-id="65e43-111">These records can be deleted because they don't contribute to the on-hand information.</span></span> <span data-ttu-id="65e43-112">O trabalho exclui somente os registros que estão abaixo do nível de **Localização**.</span><span class="sxs-lookup"><span data-stu-id="65e43-112">The job deletes only records that are below the **Location** level.</span></span>

<span data-ttu-id="65e43-113">Se o estoque físico negativo for permitido, talvez o trabalho de limpeza não consiga excluir todas as entradas relevantes.</span><span class="sxs-lookup"><span data-stu-id="65e43-113">If negative physical inventory is allowed, the cleanup job might not be able to delete all the relevant entries.</span></span> <span data-ttu-id="65e43-114">O motivo dessa limitação é que o trabalho deve permitir um cenário especial no qual uma placa de licença tem vários números de série, e um desses números de série se tornou negativo.</span><span class="sxs-lookup"><span data-stu-id="65e43-114">The reason for this limitation is that the job must allow for a special scenario where a license plate has multiple serial numbers, and one of those serial numbers has become negative.</span></span> <span data-ttu-id="65e43-115">Por exemplo, o sistema tiver zero disponível no nível da placa de licença quando uma placa de licença tiver mais de 1 pcs de número de série 1 e -1 pcs de número de série 2.</span><span class="sxs-lookup"><span data-stu-id="65e43-115">For example, the system will have zero on hand at the license plate level when a license plate has +1 pcs of serial number 1 and –1 pcs of serial number 2.</span></span> <span data-ttu-id="65e43-116">Para esse cenário especial, o trabalho faz uma exclusão em primeiro nível, em que ele tenta excluir primeiro dos níveis inferiores.</span><span class="sxs-lookup"><span data-stu-id="65e43-116">For this special scenario, the job does a breadth-first deletion, where it tries to delete from lower levels first.</span></span>

## <a name="schedule-and-configure-the-cleanup-job"></a><span data-ttu-id="65e43-117">Agendar e configurar o trabalho de limpeza</span><span class="sxs-lookup"><span data-stu-id="65e43-117">Schedule and configure the cleanup job</span></span>

<span data-ttu-id="65e43-118">O trabalho de limpeza de entradas disponíveis está disponível em **Gerenciamento de estoque \> Tarefas periódicas \> Limpeza \> Limpeza de entradas disponíveis no gerenciamento de depósito**.</span><span class="sxs-lookup"><span data-stu-id="65e43-118">The on-hand entries cleanup job is available at **Inventory management \> Periodic tasks \> Clean up \> Warehouse management on-hand entries cleanup**.</span></span> <span data-ttu-id="65e43-119">Use as configurações de trabalho padrão para controlar o escopo e a agenda para a execução do trabalho.</span><span class="sxs-lookup"><span data-stu-id="65e43-119">Use the standard job settings to control the scope and schedule for running the job.</span></span> <span data-ttu-id="65e43-120">Adicionalmente, as configurações a seguir são fornecidas:</span><span class="sxs-lookup"><span data-stu-id="65e43-120">In addition, the following settings are provided:</span></span>

- <span data-ttu-id="65e43-121">**Excluir se não for atualizado para este número de dias** – insira o número mínimo de dias que o trabalho deve aguardar antes de excluir uma entrada disponível que tenha caído para quantidade zero.</span><span class="sxs-lookup"><span data-stu-id="65e43-121">**Delete if not updated for this many days** – Enter the minimum number of days that the job should wait before it deletes an on-hand entry that has dropped to zero quantity.</span></span> <span data-ttu-id="65e43-122">Use esta configuração para ajudar a reduzir o risco de excluir entradas disponíveis que ainda estão sendo usadas.</span><span class="sxs-lookup"><span data-stu-id="65e43-122">Use this setting to help reduce the risk of deleting on-hand entries that are still being used.</span></span> <span data-ttu-id="65e43-123">Se você deseja que a limpeza ocorra o mais rápido possível, digite *0* (zero) ou deixe o campo em branco.</span><span class="sxs-lookup"><span data-stu-id="65e43-123">If you want cleanup to occur as soon as possible, either enter *0* (zero) or leave the field blank.</span></span>
- <span data-ttu-id="65e43-124">**Tempo de execução máximo (horas)** – insira o tempo de execução máximo do trabalho de limpeza, em horas.</span><span class="sxs-lookup"><span data-stu-id="65e43-124">**Maximum execution time (hours)** – Enter the maximum execution time of the cleanup job, in hours.</span></span> <span data-ttu-id="65e43-125">Se o trabalho não for concluído antes desse tempo, ele salvará o trabalho concluído até o momento e, em seguida, será fechado.</span><span class="sxs-lookup"><span data-stu-id="65e43-125">If the job isn't completed before this time passes, it will save the work that it has completed so far and then close itself.</span></span> <span data-ttu-id="65e43-126">Esse recurso é especialmente relevante para implementações com alto uso de estoque.</span><span class="sxs-lookup"><span data-stu-id="65e43-126">This capability is especially relevant for implementations that have high inventory use.</span></span> <span data-ttu-id="65e43-127">Nesses casos, você deverá agendar o trabalho a ser executado às vezes quando a carga do sistema for a mais clara possível.</span><span class="sxs-lookup"><span data-stu-id="65e43-127">In these cases, you should schedule the job to run at times when the system load is as light as possible.</span></span> <span data-ttu-id="65e43-128">Se você deseja que o trabalho em lotes continue a ser executado até que seja concluído, insira *0* (zero) ou deixe o campo em branco.</span><span class="sxs-lookup"><span data-stu-id="65e43-128">If you want the batch job to continue to run until it's completed, either enter *0* (zero) or leave the field blank.</span></span> <span data-ttu-id="65e43-129">Essa configuração só estará disponível se o recurso relacionado tiver sido [ativado no sistema](#max-execution-time).</span><span class="sxs-lookup"><span data-stu-id="65e43-129">This setting is available only if the related feature has been [turned on in your system](#max-execution-time).</span></span>

<span data-ttu-id="65e43-130">Embora seja possível executar o trabalho durante o horário comercial normal, recomendamos que ele seja executado fora do horário de trabalho.</span><span class="sxs-lookup"><span data-stu-id="65e43-130">Although you can run the job during regular business hours, we recommend that you run it outside working hours.</span></span> <span data-ttu-id="65e43-131">Dessa forma, você ajudará a evitar conflitos que poderão ocorrer se um usuário estiver trabalhando com um registro que também está sendo limpo.</span><span class="sxs-lookup"><span data-stu-id="65e43-131">In this way, you help prevent conflicts that can occur if a user is working with a record that is also being cleaned up.</span></span>

<span data-ttu-id="65e43-132">Se o trabalho tentar excluir um registro de um item enquanto esse registro estiver sendo usado por outro usuário, ocorrerá um erro de deadlock para o trabalho de limpeza ou o usuário.</span><span class="sxs-lookup"><span data-stu-id="65e43-132">If the job tries to delete a record for an item while that record is being used by another user, a deadlock error occurs for either the cleanup job or the user.</span></span>

<span data-ttu-id="65e43-133">Quando o trabalho é executado, ele tem um tamanho de confirmação de 100.</span><span class="sxs-lookup"><span data-stu-id="65e43-133">When the job runs, it has a commit size of 100.</span></span> <span data-ttu-id="65e43-134">Em outras palavras, ele tentará confirmar uma vez para cada 100 exclusões.</span><span class="sxs-lookup"><span data-stu-id="65e43-134">In other words, it will try to commit one time for every 100 deletions.</span></span> <span data-ttu-id="65e43-135">No entanto, como algumas exclusões são baseadas em conjunto, pode haver situações em que mais de 100 registros possam ser excluídos na mesma transação.</span><span class="sxs-lookup"><span data-stu-id="65e43-135">However, because some deletions are set-based, there might be scenarios where more than 100 records can be deleted in the same transaction.</span></span> <span data-ttu-id="65e43-136">Portanto, as escalonamentos de bloqueio ainda podem ocorrer.</span><span class="sxs-lookup"><span data-stu-id="65e43-136">Therefore, lock escalations can still sometimes occur.</span></span>

## <a name="possible-user-impact"></a><span data-ttu-id="65e43-137">Possível impacto do usuário</span><span class="sxs-lookup"><span data-stu-id="65e43-137">Possible user impact</span></span>

<span data-ttu-id="65e43-138">Os usuários poderão ser afetados se o trabalho de limpeza de entradas disponíveis excluir todos os registros de um determinado nível (como o nível da placa de licença).</span><span class="sxs-lookup"><span data-stu-id="65e43-138">Users might be affected if the on-hand entries cleanup job deletes all the records for a given level (such as the license plate level).</span></span> <span data-ttu-id="65e43-139">Nesse caso, a funcionalidade para ver que o estoque estava disponível anteriormente em uma placa de licença talvez não funcione conforme o esperado, pois as entradas disponíveis relevantes não estão mais disponíveis.</span><span class="sxs-lookup"><span data-stu-id="65e43-139">In this case, the functionality for seeing that inventory was previously available on-hand at a license plate might not work as expected because the relevant on-hand entries are no longer available.</span></span> <span data-ttu-id="65e43-140">Isso pode, por exemplo, ser visto nas seguintes situações:</span><span class="sxs-lookup"><span data-stu-id="65e43-140">This can, for example, be experienced in the following situations:</span></span>

- <span data-ttu-id="65e43-141">Na **Lista disponível**, quando o usuário desmarca a condição **Quantidade \<\> 0** ou seleciona a condição **Transações fechadas** nas configurações de **Exibição de dimensões**.</span><span class="sxs-lookup"><span data-stu-id="65e43-141">On the **On-hand list**, when the user deselects the condition **Quantity \<\> 0** or selects the condition **Closed transactions** in the **Dimensions display** settings.</span></span>
- <span data-ttu-id="65e43-142">Em um relatório de **Estoque físico por dimensão do estoque** de períodos anteriores, quando o usuário define o parâmetro **A partir da data**.</span><span class="sxs-lookup"><span data-stu-id="65e43-142">In a **Physical inventory by inventory dimension** report for past periods, when the user sets the **As of date** parameter.</span></span>

<span data-ttu-id="65e43-143">No entanto, a melhoria de desempenho que o trabalho de limpeza fornece deve compensar essas pequenas perdas de funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="65e43-143">However, the performance improvement that the cleanup job provides should make up for these small losses in functionality.</span></span>

## <a name="make-the-maximum-execution-time-setting-available"></a><a name="max-execution-time"></a><span data-ttu-id="65e43-144">Disponibilizar a configuração de tempo de execução máximo</span><span class="sxs-lookup"><span data-stu-id="65e43-144">Make the Maximum execution time setting available</span></span>

<span data-ttu-id="65e43-145">Por padrão, a configuração **Tempo de execução máximo** não está disponível.</span><span class="sxs-lookup"><span data-stu-id="65e43-145">By default, the **Maximum execution time** setting isn't available.</span></span> <span data-ttu-id="65e43-146">Se quiser usá-la, você deverá usar o [gerenciamento de recursos](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) para ativar o recurso relacionado no sistema.</span><span class="sxs-lookup"><span data-stu-id="65e43-146">If you want to use it, you must use [feature management](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md) to turn on the related feature in your system.</span></span> <span data-ttu-id="65e43-147">No espaço de trabalho **Gerenciamento de recursos**, o recurso está listado da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="65e43-147">In the **Feature management** workspace, the feature is listed in the following way:</span></span>

- <span data-ttu-id="65e43-148">**Módulo:** *Gerenciamento de Depósito*</span><span class="sxs-lookup"><span data-stu-id="65e43-148">**Module:** *Warehouse management*</span></span>
- <span data-ttu-id="65e43-149">**Nome do recurso:** *tempo de execução máximo para o trabalho de limpeza de entradas disponíveis no gerenciamento de depósito*</span><span class="sxs-lookup"><span data-stu-id="65e43-149">**Feature name:** *Maximum execution time for the warehouse management on-hand entries cleanup job*</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]