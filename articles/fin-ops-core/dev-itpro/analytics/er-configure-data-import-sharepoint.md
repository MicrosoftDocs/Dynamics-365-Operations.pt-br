---
title: Configurar a importação de dados do SharePoint
description: Este tópico explica como importar dados do Microsoft SharePoint.
author: NickSelin
manager: AnnBe
ms.date: 11/19/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: 1f7754a3e69238ab1760b3f7eb8f5e2c792b451b
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/05/2020
ms.locfileid: "4680893"
---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="37543-103">Configurar a importação de dados do SharePoint</span><span class="sxs-lookup"><span data-stu-id="37543-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="37543-104">Para importar dados de um arquivo de entrada usando a estrutura de relatório eletrônico (ER), é necessário configurar um formato de ER que suporta a importação e, em seguida, executar um mapeamento de modelo para o tipo **Para destino** que usa esse formato como uma origem de dados.</span><span class="sxs-lookup"><span data-stu-id="37543-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="37543-105">Para importar dados, você deve navegar para o arquivo que deseja importar.</span><span class="sxs-lookup"><span data-stu-id="37543-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="37543-106">O arquivo de entrada pode ser selecionado manualmente pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="37543-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="37543-107">Com a nova capacidade de ER de dar suporte à importação de dados do Microsoft SharePoint, este processo pode ser configurado como autônomo.</span><span class="sxs-lookup"><span data-stu-id="37543-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as unattended.</span></span> <span data-ttu-id="37543-108">Você pode usar as configurações de ER para executar a importação de dados de arquivos armazenados em pastas do Microsoft SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37543-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="37543-109">Este tópico explica como executar a importação do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37543-109">This topic explains how to complete the import from SharePoint.</span></span> <span data-ttu-id="37543-110">Os exemplos usam transações de fornecedor como dados comerciais.</span><span class="sxs-lookup"><span data-stu-id="37543-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="37543-111">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="37543-111">Prerequisites</span></span>
<span data-ttu-id="37543-112">Para concluir os exemplos neste tópico, você deve ter o seguinte acesso:</span><span class="sxs-lookup"><span data-stu-id="37543-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="37543-113">Acesso a uma das seguintes funções:</span><span class="sxs-lookup"><span data-stu-id="37543-113">Access one of the following roles:</span></span>

    - <span data-ttu-id="37543-114">Desenvolvedor de relatório eletrônico</span><span class="sxs-lookup"><span data-stu-id="37543-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="37543-115">Consultor funcional de relatório eletrônico</span><span class="sxs-lookup"><span data-stu-id="37543-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="37543-116">Administrador do sistema</span><span class="sxs-lookup"><span data-stu-id="37543-116">System administrator</span></span>

- <span data-ttu-id="37543-117">Acesso à instância do Microsoft SharePoint Server configurado para uso com o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="37543-117">Access to the instance of Microsoft SharePoint Server that is configured for use with the application.</span></span>
- <span data-ttu-id="37543-118">Configurações de formato e modelo de ER para pagamentos de 1099.</span><span class="sxs-lookup"><span data-stu-id="37543-118">ER format and model configurations for 1099 payments.</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="37543-119">Criar configurações de ER necessárias</span><span class="sxs-lookup"><span data-stu-id="37543-119">Create required ER configurations</span></span>
<span data-ttu-id="37543-120">Executar os guias de tarefas **ER Importar dados de um arquivo do Microsoft Excel**, que fazem parte do processo de negócios **7.5.4.3 Adquirir/Desenvolver componentes de serviço/solução de TI (10677)**.</span><span class="sxs-lookup"><span data-stu-id="37543-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="37543-121">Esses guias de tarefas contêm orientações para o processo de criação e uso de configurações de ER para importar transações de fornecedores de maneira interativa a partir de arquivos do Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="37543-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from Microsoft Excel files.</span></span> <span data-ttu-id="37543-122">Para obter mais informações, consulte [Analisar documentos de entrada no formato do Excel](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="37543-122">For more information, see [Parse incoming documents in Excel format](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="37543-123">Depois de concluir as guias da tarefa, você terá a configuração a seguir.</span><span class="sxs-lookup"><span data-stu-id="37543-123">After you have completed the task guides, you will have the following setup.</span></span>

#### <a name="er-configurations"></a><span data-ttu-id="37543-124">Configurações de ER</span><span class="sxs-lookup"><span data-stu-id="37543-124">ER configurations</span></span>

- <span data-ttu-id="37543-125">Configuração de modelo de ER, **Modelo de pagamento 1099**</span><span class="sxs-lookup"><span data-stu-id="37543-125">ER model configuration, **1099 Payments model**</span></span>
- <span data-ttu-id="37543-126">Configuração de formato de ER, **Formatar para importar transações de fornecedores do Excel**</span><span class="sxs-lookup"><span data-stu-id="37543-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

![Configurações de ER para importar dados do SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)

#### <a name="sample-of-the-incoming-file-for-data-import"></a><span data-ttu-id="37543-128">Amostra do arquivo de entrada para importação de dados</span><span class="sxs-lookup"><span data-stu-id="37543-128">Sample of the incoming file for data import</span></span>

- <span data-ttu-id="37543-129">Arquivo do Excel **1099import-data.xlsx** com as transações do fornecedor que devem ser importadas.</span><span class="sxs-lookup"><span data-stu-id="37543-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported.</span></span>

![Arquivo do Excel de amostra para importar de SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)
    
> [!NOTE]
> <span data-ttu-id="37543-131">O formato para importar transações do fornecedor é selecionado como o mapeamento de modelo padrão.</span><span class="sxs-lookup"><span data-stu-id="37543-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="37543-132">Portanto, se você executar um mapeamento de modelo do **Modelo de pagamentos 1099** e esse mapeamento de modelo for do tipo **Para destino**, o mapeamento de modelo executa este formato para importar dados dos arquivos externos.</span><span class="sxs-lookup"><span data-stu-id="37543-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="37543-133">Em seguida, usa esses dados para atualizar tabelas do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="37543-133">It then uses that data to update application tables.</span></span>

## <a name="configure-access-to-sharepoint-for-file-storage"></a><span data-ttu-id="37543-134">Configurar o acesso ao SharePoint para armazenamento de arquivos</span><span class="sxs-lookup"><span data-stu-id="37543-134">Configure access to SharePoint for file storage</span></span>
<span data-ttu-id="37543-135">Para armazenar arquivos de relatórios eletrônicos em um local do SharePoint, você deve configurar o acesso à instância do SharePoint Server que será usada pela empresa atual.</span><span class="sxs-lookup"><span data-stu-id="37543-135">To store electronic report files in a SharePoint location, you must configure access to the SharePoint Server instance that will be used by the current company.</span></span> <span data-ttu-id="37543-136">Neste exemplo, a empresa é USMF.</span><span class="sxs-lookup"><span data-stu-id="37543-136">In this example, the company is USMF.</span></span> <span data-ttu-id="37543-137">Para obter instruções, consulte [Configurar armazenamento do SharePoint](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="37543-137">For instructions, see [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>

1. <span data-ttu-id="37543-138">Execute as etapas em [Configurar armazenamento do SharePoint](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="37543-138">Complete the steps in [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>
2. <span data-ttu-id="37543-139">Abra o site configurado do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37543-139">Open the configured SharePoint site.</span></span>
3. <span data-ttu-id="37543-140">Criar estas pastas onde os arquivos de relatórios eletrônicos de entrada possam ser armazenados:</span><span class="sxs-lookup"><span data-stu-id="37543-140">Create the following folders where incoming electronic reporting files can be stored:</span></span>

     - <span data-ttu-id="37543-141">Origem da importação de arquivos (principal) (exemplo mostrado na captura de tela a seguir)</span><span class="sxs-lookup"><span data-stu-id="37543-141">Files import source (main) (Example shown in screenshot below)</span></span>
     - <span data-ttu-id="37543-142">Origem da importação de arquivos (alternativa)</span><span class="sxs-lookup"><span data-stu-id="37543-142">Files import source (alternative)</span></span>

    ![Origem da importação de arquivos (pai)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)

4. <span data-ttu-id="37543-144">(Opcional) Criar estas pastas onde os arquivos possam ser armazenados após a importação:</span><span class="sxs-lookup"><span data-stu-id="37543-144">(Optional) Create the following folders where the files can be stored after import.</span></span> 

    - <span data-ttu-id="37543-145">Pasta do arquivo morto de arquivos - esta pasta seria para arquivos importados com êxito.</span><span class="sxs-lookup"><span data-stu-id="37543-145">Files archive folder - This folder would be for successfully imported files.</span></span>
    - <span data-ttu-id="37543-146">Pasta de avisos de arquivos - essa pasta seria para os arquivos que foram importados com um aviso.</span><span class="sxs-lookup"><span data-stu-id="37543-146">Files warning folder - This folder would be for files that were imported with a warning.</span></span>
    - <span data-ttu-id="37543-147">Pasta de arquivos com erros - esta pasta seria para os arquivos que não foram importados.</span><span class="sxs-lookup"><span data-stu-id="37543-147">Files error folder - This folder would be for files that failed to import.</span></span>

4. <span data-ttu-id="37543-148">Vá para **Administração da organização > Gerenciamento de documentos > Tipos de documento**.</span><span class="sxs-lookup"><span data-stu-id="37543-148">Go to **Organization administration > Document management > Document types**.</span></span>
5. <span data-ttu-id="37543-149">Crie os tipos de documento a seguir que serão usados para acessar as pastas do SharePoint recém-criadas.</span><span class="sxs-lookup"><span data-stu-id="37543-149">Create the following document types that will be used to access the SharePoint folders that you created.</span></span> <span data-ttu-id="37543-150">Para obter instruções, consulte [Configurar tipos de documento](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types).</span><span class="sxs-lookup"><span data-stu-id="37543-150">For instructions, see [Configure document types](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types).</span></span>

|<span data-ttu-id="37543-151">Tipo de documento</span><span class="sxs-lookup"><span data-stu-id="37543-151">Document type</span></span>       | <span data-ttu-id="37543-152">Agrupar</span><span class="sxs-lookup"><span data-stu-id="37543-152">Group</span></span>              | <span data-ttu-id="37543-153">Localização</span><span class="sxs-lookup"><span data-stu-id="37543-153">Location</span></span>      | <span data-ttu-id="37543-154">Pasta do SharePoint</span><span class="sxs-lookup"><span data-stu-id="37543-154">SharePoint folder</span></span>      |
|--------------------|--------------------|---------------|------------------------|
|<span data-ttu-id="37543-155">SP principal</span><span class="sxs-lookup"><span data-stu-id="37543-155">SP Main</span></span>             |<span data-ttu-id="37543-156">Arquivo</span><span class="sxs-lookup"><span data-stu-id="37543-156">File</span></span>                |<span data-ttu-id="37543-157">SharePoint</span><span class="sxs-lookup"><span data-stu-id="37543-157">SharePoint</span></span>     |<span data-ttu-id="37543-158">Origem da importação de arquivos (pai)</span><span class="sxs-lookup"><span data-stu-id="37543-158">Files import source (main)</span></span>|
|<span data-ttu-id="37543-159">SP alternativa</span><span class="sxs-lookup"><span data-stu-id="37543-159">SP Alternative</span></span>             |<span data-ttu-id="37543-160">Arquivo</span><span class="sxs-lookup"><span data-stu-id="37543-160">File</span></span>                |<span data-ttu-id="37543-161">SharePoint</span><span class="sxs-lookup"><span data-stu-id="37543-161">SharePoint</span></span>     |<span data-ttu-id="37543-162">Origem da importação de arquivos (alternativa)</span><span class="sxs-lookup"><span data-stu-id="37543-162">Files import source (alternative)</span></span>|
|<span data-ttu-id="37543-163">Arquivo morto de SP</span><span class="sxs-lookup"><span data-stu-id="37543-163">SP Archive</span></span>             |<span data-ttu-id="37543-164">Arquivo</span><span class="sxs-lookup"><span data-stu-id="37543-164">File</span></span>                |<span data-ttu-id="37543-165">SharePoint</span><span class="sxs-lookup"><span data-stu-id="37543-165">SharePoint</span></span>     |<span data-ttu-id="37543-166">Pasta do arquivo morto de arquivos</span><span class="sxs-lookup"><span data-stu-id="37543-166">Files archive folder</span></span>|
|<span data-ttu-id="37543-167">Aviso do SP</span><span class="sxs-lookup"><span data-stu-id="37543-167">SP Warning</span></span>             |<span data-ttu-id="37543-168">Arquivo</span><span class="sxs-lookup"><span data-stu-id="37543-168">File</span></span>                |<span data-ttu-id="37543-169">SharePoint</span><span class="sxs-lookup"><span data-stu-id="37543-169">SharePoint</span></span>     |<span data-ttu-id="37543-170">Pasta de avisos de arquivos</span><span class="sxs-lookup"><span data-stu-id="37543-170">Files warning folder</span></span>|
|<span data-ttu-id="37543-171">Erro do SP</span><span class="sxs-lookup"><span data-stu-id="37543-171">SP Error</span></span>             |<span data-ttu-id="37543-172">Arquivo</span><span class="sxs-lookup"><span data-stu-id="37543-172">File</span></span>                |<span data-ttu-id="37543-173">SharePoint</span><span class="sxs-lookup"><span data-stu-id="37543-173">SharePoint</span></span>     |<span data-ttu-id="37543-174">Pasta de arquivos com erros</span><span class="sxs-lookup"><span data-stu-id="37543-174">Files error folder</span></span>|

![Configuração do SharePoint – novo tipo de documento](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="37543-176">Configurar fontes de ER para o formato de ER</span><span class="sxs-lookup"><span data-stu-id="37543-176">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="37543-177">Clique em **Administração da organização** \> **Relatório eletrônico** \> **Origem do relatório eletrônico**.</span><span class="sxs-lookup"><span data-stu-id="37543-177">Click **Organization administration** \> **Electronic reporting** \> **Electronic reporting source**.</span></span>
2. <span data-ttu-id="37543-178">Na página **Origem do relatório eletrônico** , configure os arquivos de origem para a importação de dados usando o formato do ER configurado.</span><span class="sxs-lookup"><span data-stu-id="37543-178">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="37543-179">Defina uma máscara de nome de arquivo, para que somente os arquivos com a extensão .xlsx sejam importados.</span><span class="sxs-lookup"><span data-stu-id="37543-179">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="37543-180">A máscara do nome de arquivo é opcional e é usada somente quando for definida.</span><span class="sxs-lookup"><span data-stu-id="37543-180">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="37543-181">Você pode definir somente uma máscara para cada formato de ER.</span><span class="sxs-lookup"><span data-stu-id="37543-181">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="37543-182">Altere **Classificar arquivos antes de importar** para **Não classificar** se houver muitos arquivos para importação e a ordem de importação não for importante</span><span class="sxs-lookup"><span data-stu-id="37543-182">Change **Sort files before import** to **Do not sort**, if there are several files for import and the import order is not important</span></span>
5. <span data-ttu-id="37543-183">Selecione todas as pastas do SharePoint que você criou anteriormente.</span><span class="sxs-lookup"><span data-stu-id="37543-183">Select all SharePoint folders that you created earlier.</span></span>

    <span data-ttu-id="37543-184">[![Configuração de origem dos arquivos ER](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="37543-184">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
> - <span data-ttu-id="37543-185">A *origem* do ER é definida para cada empresa do aplicativo individualmente.</span><span class="sxs-lookup"><span data-stu-id="37543-185">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="37543-186">Por outro lado, as *configurações* do ER são compartilhadas entre as empresas.</span><span class="sxs-lookup"><span data-stu-id="37543-186">By contrast, ER *configurations* are shared across companies.</span></span>
> - <span data-ttu-id="37543-187">Quando você exclui uma configuração de origem de ER para um formato de ER, todos os estados de arquivos conectados (veja abaixo) também são excluídos por confirmação.</span><span class="sxs-lookup"><span data-stu-id="37543-187">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted by confirmation.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="37543-188">Examinar os estados dos arquivos para o formato de ER</span><span class="sxs-lookup"><span data-stu-id="37543-188">Review the files states for the ER format</span></span>
1. <span data-ttu-id="37543-189">Na página **Origem do relatório eletrônico** , selecione **Estados dos arquivos das origens** para examinar o conteúdo de origens do arquivo configurado para o formato de ER atual.</span><span class="sxs-lookup"><span data-stu-id="37543-189">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="37543-190">Na seção **Arquivos** , examine a lista de arquivos.</span><span class="sxs-lookup"><span data-stu-id="37543-190">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="37543-191">Esta lista apresentará o seguinte:</span><span class="sxs-lookup"><span data-stu-id="37543-191">This list presents the following:</span></span>

    - <span data-ttu-id="37543-192">Arquivos de origem que são aplicáveis, com base na máscara de nome de arquivo (se uma máscara de nome de arquivo for definida) e que estão prontas para a importação de dados.</span><span class="sxs-lookup"><span data-stu-id="37543-192">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="37543-193">Para esses arquivos, a seção **Logs de origem do formato de importação** estará vazia.</span><span class="sxs-lookup"><span data-stu-id="37543-193">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="37543-194">Arquivos importados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="37543-194">Previously imported files.</span></span> <span data-ttu-id="37543-195">Para cada um desses arquivos, na seção **Logs de origem do formato de importação** , você pode revisar o histórico de importação deste arquivo.</span><span class="sxs-lookup"><span data-stu-id="37543-195">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="37543-196">Você também pode abrir a página **Estados dos arquivos das origens** selecionando **Administração da organização** \> **Relatório eletrônico** \> **Estados dos arquivos das origens**.</span><span class="sxs-lookup"><span data-stu-id="37543-196">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="37543-197">Nesse caso, a página fornece informações sobre fontes de arquivo para todos os formatos de ER nos quais as origens do arquivo foram configuradas na empresa na qual você está conectado.</span><span class="sxs-lookup"><span data-stu-id="37543-197">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="37543-198">Importar dados de arquivos do Excel que estão em uma pasta do SharePoint</span><span class="sxs-lookup"><span data-stu-id="37543-198">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="37543-199">No SharePoint, carregue o arquivo do Microsoft Excel **1099import-data.xlsx** que contém transações do fornecedor para a pasta do SharePoint **Origem de importação dos arquivos (principal)** criada anteriormente.</span><span class="sxs-lookup"><span data-stu-id="37543-199">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

    <span data-ttu-id="37543-200">[![Conteúdo do SharePoint – arquivo do Microsoft Excel para importação](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="37543-200">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="37543-201">Na página **Estados dos arquivos das origens**, selecione **Atualizar** para atualizar a página.</span><span class="sxs-lookup"><span data-stu-id="37543-201">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="37543-202">O arquivo do Excel que foi carregado no SharePoint apareceu nesta página com o status **Pronto**.</span><span class="sxs-lookup"><span data-stu-id="37543-202">The Excel file that was uploaded to SharePoint appeared on this page with the status **Ready**.</span></span> <span data-ttu-id="37543-203">Os seguintes status são suportados atualmente:</span><span class="sxs-lookup"><span data-stu-id="37543-203">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="37543-204">**Pronto** – atribuído automaticamente para cada novo arquivo em uma pasta do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37543-204">**Ready** – Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="37543-205">Este status indica que o arquivo está pronto para a importação.</span><span class="sxs-lookup"><span data-stu-id="37543-205">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="37543-206">**Importando** – Atribuído automaticamente para um relatório de ER quando o arquivo for bloqueado pelo processo de importação para impedir seu uso por outros processos (se vários deles forem executados simultaneamente.)</span><span class="sxs-lookup"><span data-stu-id="37543-206">**Importing** – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="37543-207">**Importado** – atribuído automaticamente por um relatório de ER quando a importação do arquivo for concluída com sucesso.</span><span class="sxs-lookup"><span data-stu-id="37543-207">**Imported** – Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="37543-208">Este status indica que o arquivo importado foi excluído da origem de arquivos configurada (pasta do SharePoint).</span><span class="sxs-lookup"><span data-stu-id="37543-208">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="37543-209">**Com falha** – atribuído automaticamente por um relatório de ER quando a importação do arquivo for concluída com sucesso com erros ou exceções.</span><span class="sxs-lookup"><span data-stu-id="37543-209">**Failed** – Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="37543-210">**Em espera** – Atribuído manualmente pelo usuário nesta página.</span><span class="sxs-lookup"><span data-stu-id="37543-210">**On hold** – Assigned manually by user on this page.</span></span> <span data-ttu-id="37543-211">Este status indica que o arquivo não será importado por enquanto.</span><span class="sxs-lookup"><span data-stu-id="37543-211">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="37543-212">Este status pode ser usado para adiar a importação de alguns arquivos.</span><span class="sxs-lookup"><span data-stu-id="37543-212">This status can be used to postpone the import of some files.</span></span>

    <span data-ttu-id="37543-213">[![Página dos estados do arquivo de ER atualizados para as fontes selecionadas](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="37543-213">[![Refreshed ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="37543-214">Importar dados de arquivos do SharePoint</span><span class="sxs-lookup"><span data-stu-id="37543-214">Import data from SharePoint files</span></span>
1. <span data-ttu-id="37543-215">Abra a árvore das configurações de ER, selecione **Modelo de pagamento 1099** e expanda a lista de componentes do modelo de ER.</span><span class="sxs-lookup"><span data-stu-id="37543-215">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="37543-216">Selecione o nome do mapeamento do modelo para abrir a lista de mapeamentos do modelo da configuração do modelo de ER selecionada.</span><span class="sxs-lookup"><span data-stu-id="37543-216">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

    <span data-ttu-id="37543-217">[![Página Configuração](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="37543-217">[![Configuration page](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="37543-218">Selecione **Executar** para executar o mapeamento de modelo selecionado.</span><span class="sxs-lookup"><span data-stu-id="37543-218">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="37543-219">Como você configurou as origens no formato ER, poderá alterar a configuração da opção **Origem do arquivo** se necessário.</span><span class="sxs-lookup"><span data-stu-id="37543-219">Because you configured file sources for the ER format, you can change the setting of the **File source** option, if needed.</span></span> <span data-ttu-id="37543-220">Se você mantém a configuração desta opção, os arquivos .xslx são importados das origens configuradas (as pastas do SharePoint, neste exemplo).</span><span class="sxs-lookup"><span data-stu-id="37543-220">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="37543-221">Neste exemplo, você está importando somente um arquivo.</span><span class="sxs-lookup"><span data-stu-id="37543-221">In this example, you're importing only one file.</span></span> <span data-ttu-id="37543-222">Porém, se houver vários arquivos, eles serão selecionados para importação na ordem em que foram adicionados à pasta do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37543-222">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="37543-223">Cada execução de um formato de ER importa um único arquivo selecionado.</span><span class="sxs-lookup"><span data-stu-id="37543-223">Every run of an ER format imports a single selected file.</span></span>

    <span data-ttu-id="37543-224">[![Importar de SharePoint e executar o mapeamento de modelo de ER](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="37543-224">[![Import from SharePoint and run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="37543-225">O mapeamento do modelo pode ser executado [no modo autônomo](#limitations) em lote.</span><span class="sxs-lookup"><span data-stu-id="37543-225">The model mapping can run [unattended](#limitations) in batch mode.</span></span> <span data-ttu-id="37543-226">Nesse caso, sempre que um lote executar esse formato de ER, um arquivo único é importado de origens do arquivo configurado.</span><span class="sxs-lookup"><span data-stu-id="37543-226">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span>

    <span data-ttu-id="37543-227">Quando um arquivo é importado com êxito da pasta do SharePoint, ele é excluído dessa pasta e movido para uma pasta de arquivos importados com êxito ou para a pasta de arquivos importados com avisos.</span><span class="sxs-lookup"><span data-stu-id="37543-227">When a file is successfully imported from the SharePoint folder, it's deleted from that folder and moved to folder for successful imported files or to the folder to imported files with warnings.</span></span> <span data-ttu-id="37543-228">Caso contrário, ele será movido para a pasta de arquivos com falhas ou ficará nessa pasta se a pasta de arquivos com falhas não estiver configurada.</span><span class="sxs-lookup"><span data-stu-id="37543-228">Otherwise it's moved to folder for failed files or stays in this folder if the folder for failed files isn't set up.</span></span> 

5. <span data-ttu-id="37543-229">Insira a ID de comprovante, como **V-00001** e depois selecione **OK**.</span><span class="sxs-lookup"><span data-stu-id="37543-229">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

    <span data-ttu-id="37543-230">[![Executar mapeamento de modelo de ER](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="37543-230">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="37543-231">Na página **Estados dos arquivos das origens**, selecione **Atualizar** para atualizar a página.</span><span class="sxs-lookup"><span data-stu-id="37543-231">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

    <span data-ttu-id="37543-232">[![Página dos estados do arquivo de ER para as fontes](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="37543-232">[![ER file states for the sources page](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="37543-233">Na seção **Arquivos** , examine a lista de arquivos.</span><span class="sxs-lookup"><span data-stu-id="37543-233">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="37543-234">A seção **Logs de origem do formato de importação** fornece o histórico de importação de arquivo Excel.</span><span class="sxs-lookup"><span data-stu-id="37543-234">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="37543-235">Como esse arquivo foi importado com êxito, ele é marcado como **Excluído** na pasta do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="37543-235">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="37543-236">Revise a pasta do SharePoint **Origem de importação dos arquivos (principal)**.</span><span class="sxs-lookup"><span data-stu-id="37543-236">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="37543-237">Os arquivos do Excel que foram importados com sucesso foram excluídos desta pasta.</span><span class="sxs-lookup"><span data-stu-id="37543-237">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="37543-238">Selecione **Contas a pagar** \> **Tarefas periódicas** \> **Imposto 1099** \> **Liquidação de fornecedor para impostos 1099**.</span><span class="sxs-lookup"><span data-stu-id="37543-238">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="37543-239">Nos campos **De** e **Até**, informe os valores apropriados.</span><span class="sxs-lookup"><span data-stu-id="37543-239">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="37543-240">Em seguida, selecione **Transações 1099 manuais**.</span><span class="sxs-lookup"><span data-stu-id="37543-240">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="37543-241">As transações do fornecedor importadas dos arquivos do Excel no SharePoint para o comprovante **V-00001** são apresentadas na página.</span><span class="sxs-lookup"><span data-stu-id="37543-241">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

    <span data-ttu-id="37543-242">[![Página transações do fornecedor 1099](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="37543-242">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="37543-243">Preparar um arquivo do Excel para importação</span><span class="sxs-lookup"><span data-stu-id="37543-243">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="37543-244">Abra o arquivo do Excel usado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="37543-244">Open the Excel file that you previously used.</span></span> <span data-ttu-id="37543-245">Na linha 3, coluna 1 adicione um código do fornecedor que não existe no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="37543-245">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="37543-246">Inclua informações adicionais falsas de fornecedor na linha.</span><span class="sxs-lookup"><span data-stu-id="37543-246">Add additional false vendor information to the row.</span></span>

    <span data-ttu-id="37543-247">[![Arquivo de exemplo do Microsoft Excel para importar do SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="37543-247">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="37543-248">Carregue o arquivo do Excel atualizado que contém as transações dos fornecedores para a pasta do SharePoint **Origem de importação dos arquivos (principal)**.</span><span class="sxs-lookup"><span data-stu-id="37543-248">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="37543-249">Abra a árvore das configurações de ER, selecione **Modelo de pagamento 1099** e expanda a lista de componentes do modelo de ER.</span><span class="sxs-lookup"><span data-stu-id="37543-249">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="37543-250">Selecione o nome do mapeamento de modelo para atualizar o mapeamento de modelo, de forma que o código incorreto do fornecedor seja considerado um erro durante o processo de importação de dados.</span><span class="sxs-lookup"><span data-stu-id="37543-250">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="37543-251">Selecione **Designer**.</span><span class="sxs-lookup"><span data-stu-id="37543-251">Select **Designer**.</span></span>
6. <span data-ttu-id="37543-252">Na guia **Validações** , você deverá alterar a ação de pós-validação para a regra de validação que foi configurada para avaliar se a conta de fornecedor importada existe no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="37543-252">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="37543-253">Atualize o valor do campo **Ação pós-validação** para **Parar execução**, salve suas alterações e feche a página.</span><span class="sxs-lookup"><span data-stu-id="37543-253">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

    <span data-ttu-id="37543-254">[![ER Página designer de mapeamento do modelo](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="37543-254">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="37543-255">Salvar suas alterações e feche o designer de mapeamento de modelo do ER.</span><span class="sxs-lookup"><span data-stu-id="37543-255">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="37543-256">Selecione **Executar** para executar o mapeamento de modelo de ER modificado.</span><span class="sxs-lookup"><span data-stu-id="37543-256">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="37543-257">Insira a ID de comprovante, como **V-00002** e depois selecione **OK**.</span><span class="sxs-lookup"><span data-stu-id="37543-257">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="37543-258">O log de informações contém um aviso de que há um arquivo na pasta do SharePoint com uma conta de fornecedor incorreta e que, portanto, ele não pode ser importado.</span><span class="sxs-lookup"><span data-stu-id="37543-258">The Infolog contains a notification that there's a file in the SharePoint folder that contains incorrect vendor account and can’t be imported.</span></span>

    <span data-ttu-id="37543-259">[![Execução concluída do mapeamento de modelo de ER](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="37543-259">[![Finished Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="37543-260">Na página **Estados dos arquivos das origens**, selecione **Atualizar** e, em seguida, na seção **Arquivos**, revise a lista de arquivos.</span><span class="sxs-lookup"><span data-stu-id="37543-260">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

    <span data-ttu-id="37543-261">[![Página dos estados do arquivo de ER para as origens selecionadas](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="37543-261">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

   <span data-ttu-id="37543-262">A seção **Logs de origem do formato de importação** indica que o processo de importação falhou e que o arquivo está na pasta de arquivos com erros do SharePoint (a caixa de seleção **Excluído** não está marcada).</span><span class="sxs-lookup"><span data-stu-id="37543-262">The **Sources log for the import format** section indicates that the import process failed and that the file is in the Files error SharePoint folder (the **Is deleted** check box is not selected).</span></span> <span data-ttu-id="37543-263">Se você corrigir esse arquivo no SharePoint adicionando o código de fornecedor apropriado e movendo-o para a pasta Origem de importação dos arquivos (principal) do SharePoint, poderá importá-lo novamente.</span><span class="sxs-lookup"><span data-stu-id="37543-263">If you fix this file on SharePoint by adding the proper vendor code and then move it to the Files import source (main) SharePoint folder, you can import the file again.</span></span>

11. <span data-ttu-id="37543-264">Selecione **Contas a pagar** \> **Tarefas periódicas** \> **Imposto 1099** \> **Liquidação de fornecedor para impostos 1099**, insira os valores apropriados nos campos **De** e **Até** e selecione **Transações 1099 manuais**.</span><span class="sxs-lookup"><span data-stu-id="37543-264">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="37543-265">Somente as transações para o comprovante V-00001 estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="37543-265">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="37543-266">Nenhuma transação para o comprovante V-00002 estará disponível, mesmo que o erro da última transação importada seja encontrado no arquivo do Excel.</span><span class="sxs-lookup"><span data-stu-id="37543-266">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>

## <a name=""></a><span data-ttu-id="37543-267"><a name="limitations">Limitações</a></span><span class="sxs-lookup"><span data-stu-id="37543-267"><a name="limitations">Limitations</a></span></span>

<span data-ttu-id="37543-268">A estrutura de ER não permite iniciar um novo trabalho em lote de execução de mapeamento de modelo no modo autônomo para a importação de dados.</span><span class="sxs-lookup"><span data-stu-id="37543-268">The ER framework doesn't offer the capability to initiate a new batch job that will execute a model mapping in unattended mode for data import.</span></span> <span data-ttu-id="37543-269">Para isso, você deve desenvolver uma nova lógica de forma que o mapeamento de modelo de ER configurado possa ser chamado na interface do usuário (IU) do aplicativo para importar dados de arquivos de entrada.</span><span class="sxs-lookup"><span data-stu-id="37543-269">To do this, you must develop new logic so that the configured ER model mapping can be called from the application user interface (UI) to import data from inbound files.</span></span> <span data-ttu-id="37543-270">Portanto, é necessário algum trabalho de engenharia.</span><span class="sxs-lookup"><span data-stu-id="37543-270">Therefore, some engineering work is required.</span></span> 

<span data-ttu-id="37543-271">Se você quiser saber mais sobre a API de ER relevante, consulte a seção [Código para executar mapeamento de formato para importação de dados](er-apis-app73.md#code-to-run-a-format-mapping-for-data-import) no tópico [Alterações na API da estrutura de ER para Application update 7.3](er-apis-app73.md).</span><span class="sxs-lookup"><span data-stu-id="37543-271">To learn more about the relevant ER API, see the [Code to run a format mapping for data import](er-apis-app73.md#code-to-run-a-format-mapping-for-data-import) section in the [ER framework API changes for Application update 7.3](er-apis-app73.md) topic.</span></span>

<span data-ttu-id="37543-272">Analise o código na classe `BankImport_RU` do modelo `Application Suite` para ver como a lógica personalizada pode ser implementada.</span><span class="sxs-lookup"><span data-stu-id="37543-272">Review the code in the `BankImport_RU` class of the `Application Suite` model to see how your custom logic can be implemented.</span></span> <span data-ttu-id="37543-273">Essa classe estende a `RunBaseBatch`.</span><span class="sxs-lookup"><span data-stu-id="37543-273">This class extends the `RunBaseBatch` class.</span></span> <span data-ttu-id="37543-274">Em particular, analise o método `runER()` em que o objeto `ERIModelMappingDestinationRun` é criado como o executor de um mapeamento de modelo de ER.</span><span class="sxs-lookup"><span data-stu-id="37543-274">In particular, review the `runER()` method where the `ERIModelMappingDestinationRun` object is created as the runner of an ER model mapping.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="37543-275">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="37543-275">Additional resources</span></span>

[<span data-ttu-id="37543-276">Visão geral do Relatório Eletrônico</span><span class="sxs-lookup"><span data-stu-id="37543-276">Electronic Reporting overview</span></span>](general-electronic-reporting.md)

[<span data-ttu-id="37543-277">Alterações na API da estrutura de ER para Application update 7.3</span><span class="sxs-lookup"><span data-stu-id="37543-277">ER framework API changes for Application update 7.3</span></span>](er-apis-app73.md)

