---
title: Configurar fontes de dados de pesquisa para usar parâmetros específicos do aplicativo ER
description: Este tópico explica como configurar fontes de dados de pesquisa em formatos de relatório eletrônico (ER) para usar parâmetros especificados específicos de aplicativo ER.
author: NickSelin
manager: AnnBe
ms.date: 04/02/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERSolutionTable, EROperationDesigner, ERLookupDesigner, ERComponentLookupStructureEditing
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2019-01-01
ms.dyn365.ops.version: Release 8.1.3
ms.openlocfilehash: 542580c859759c25da84589ec82495eb72bbcbe5
ms.sourcegitcommit: 74f5b04b482b2ae023c728e0df0eb78305493c6a
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/02/2021
ms.locfileid: "5853512"
---
# <a name="configure-lookup-data-sources-to-use-er-application-specific-parameters"></a><span data-ttu-id="0588b-103">Configurar fontes de dados de pesquisa para usar parâmetros específicos do aplicativo ER</span><span class="sxs-lookup"><span data-stu-id="0588b-103">Configure Lookup data sources to use ER application-specific parameters</span></span> 

[!include[banner](../includes/banner.md)]

<span data-ttu-id="0588b-104">O recurso de parâmetros específicos do aplicativo de [Relatório Eletrônico (ER)](general-electronic-reporting.md) permite que você configure a filtragem de dados em um formato de ER de forma que se baseie em um conjunto de regras abstratas.</span><span class="sxs-lookup"><span data-stu-id="0588b-104">The [Electronic reporting (ER)](general-electronic-reporting.md) application-specific parameters feature lets you configure data filtering in an ER format so that it's based on a set of abstract rules.</span></span> <span data-ttu-id="0588b-105">Esse conjunto de regras pode ser configurado para usar a fonte de dados do tipo **Pesquisa** que está disponível em um formato de ER.</span><span class="sxs-lookup"><span data-stu-id="0588b-105">This set of rules can be configured to use the data source of the **Lookup** type that is available in an ER format.</span></span> <span data-ttu-id="0588b-106">Você pode especificar regras reais além de designers de componentes de ER usando a interface de usuário (IU) que é gerada automaticamente com base nas configurações da fonte de dados de **Pesquisa** do formato de ER correspondente e nos dados da entidade legal atual.</span><span class="sxs-lookup"><span data-stu-id="0588b-106">You can then specify real rules beyond the ER components designers by using the user interface (UI) that is automatically generated based on the settings of the **Lookup** data source of the corresponding ER format and the current legal entity data.</span></span> <span data-ttu-id="0588b-107">Por fim, as regras especificadas serão acessadas pela fonte de dados de **Pesquisa** do formato de ER quando esse formato for executado.</span><span class="sxs-lookup"><span data-stu-id="0588b-107">Eventually, the specified rules will be accessed by the ER format's **Lookup** data source when this ER format is executed.</span></span>

> [!NOTE]
> <span data-ttu-id="0588b-108">Use as fontes de dados configuradas do formato de ER editável para especificar quais dados de aplicativo são usados para configurar regras reais.</span><span class="sxs-lookup"><span data-stu-id="0588b-108">Use the configured data sources of the editable ER format to specify what application data is used to configure real rules.</span></span>

<span data-ttu-id="0588b-109">Use o [Designer de operações ER](general-electronic-reporting.md#building-a-format-that-uses-a-data-model-as-a-base) para colocar uma fonte de dados do tipo de **Pesquisa** no formato de ER.</span><span class="sxs-lookup"><span data-stu-id="0588b-109">Use the [ER Operations designer](general-electronic-reporting.md#building-a-format-that-uses-a-data-model-as-a-base) to bring a data source of the **Lookup** type in to your ER format.</span></span> <span data-ttu-id="0588b-110">A fonte de dados deve ser configurada para descrever a aparência de regras abstratas, incluindo o seguinte:</span><span class="sxs-lookup"><span data-stu-id="0588b-110">The data source must be configured to describe how your abstract rules look, including the following:</span></span>

   - <span data-ttu-id="0588b-111">O conjunto de parâmetros de certos tipos de dados cujo valor é fornecido para especificar uma única regra.</span><span class="sxs-lookup"><span data-stu-id="0588b-111">The parameter set of certain data type whose value is provided to specify a single rule.</span></span>
   - <span data-ttu-id="0588b-112">O tipo de valor de certo tipo de dados que é retornado por uma única regra quando essa regra é considerada a mais apropriada entre outras.</span><span class="sxs-lookup"><span data-stu-id="0588b-112">The value type of certain data type that is returned by a single rule when this rule is considered the most appropriate among others.</span></span>

<span data-ttu-id="0588b-113">Você pode configurar os seguintes tipos de fonte de dados de **Pesquisa**, dependendo do tipo de valor retornado por qualquer regra configurada:</span><span class="sxs-lookup"><span data-stu-id="0588b-113">You can configure the following types of **Lookup** data sources depending on the type of value that is returned by any configured rule:</span></span>

   - <span data-ttu-id="0588b-114">Use o tipo **Modelo de dados\Pesquisa** quando for necessário retornar um valor de enumeração de modelo.</span><span class="sxs-lookup"><span data-stu-id="0588b-114">Use the **Data model\Lookup** type when a model enumeration value must be returned.</span></span>
   - <span data-ttu-id="0588b-115">Use o tipo **Dynamics 365 Operations\Pesquisa** quando for necessário retornar um valor de enumeração de aplicativo ou um valor de [tipo de dados estendido](../extensibility/extensible-edts.md)  do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0588b-115">Use the **Dynamics 365 Operations\Lookup** type when an application enumeration value or an application [extended data type](../extensibility/extensible-edts.md) value must be returned.</span></span>
   - <span data-ttu-id="0588b-116">Use o tipo **Enumeração de formato\Pesquisa** quando for necessário retornar um valor de enumeração de formato.</span><span class="sxs-lookup"><span data-stu-id="0588b-116">Use the **Format enumeration\Lookup** type when a format enumeration value must be returned.</span></span>

<span data-ttu-id="0588b-117">A ilustração a seguir mostra como uma enumeração de formato pode ser configurada no formato de ER de exemplo.</span><span class="sxs-lookup"><span data-stu-id="0588b-117">The following illustration shows how a format enumeration can be configured in the sample ER format.</span></span>

   ![Mostrando uma enumeração de formato como base da fonte de dados de pesquisa configurada](./media/er-lookup-data-sources-img1.gif)

<span data-ttu-id="0588b-119">A ilustração a seguir mostra os componentes de formato que foram configurados para relatar diferentes tipos de impostos em uma seção diferente de um relatório gerado.</span><span class="sxs-lookup"><span data-stu-id="0588b-119">The following illustration shows the format components that were configured to report different type of taxes in a different section of a generated report.</span></span>

   ![Mostrando as seções de formato para relatar diferentes tipos de impostos](./media/er-lookup-data-sources-img2.png)

<span data-ttu-id="0588b-121">A ilustração a seguir mostra como o designer de Operações ER permite a adição de uma fonte de dados do tipo **Enumeração de formato\Pesquisa**.</span><span class="sxs-lookup"><span data-stu-id="0588b-121">The following illustration shows how the ER Operations designer allows the addition of a data source of the **Format enumeration\Lookup** type.</span></span>  <span data-ttu-id="0588b-122">A fonte de dados adicionada é configurada como retorno de um valor da enumeração de formato `List of taxation levels`.</span><span class="sxs-lookup"><span data-stu-id="0588b-122">The added data source is configured as returning a value of the `List of taxation levels` format enumeration.</span></span>

   ![Adicionando uma fonte de dados ER do tipo Enumeração de formato\Pesquisa](./media/er-lookup-data-sources-img3.gif)

<span data-ttu-id="0588b-124">A ilustração a seguir mostra como a fonte de dados adicionada está configurada para usar o campo **Código** da lista de registro **Model.Data.Tax** da fonte de dados **Modelo** como um parâmetro que deve ser especificado para cada regra configurada.</span><span class="sxs-lookup"><span data-stu-id="0588b-124">The following illustration shows how the added data source is configured to use the **Code** field of the **Model.Data.Tax** record list of the **Model** data source as a parameter that must be specified for every configured rule.</span></span>

![Configurando parâmetros da fonte de dados adicionada do tipo Enumeração de formato\Pesquisa](./media/er-lookup-data-sources-img4.gif)

<span data-ttu-id="0588b-126">A fonte de dados `Model.Data.Tax` adicionada é configurada para especificar um código de imposto para cada regra configurada, acessando registros da tabela de aplicativos **TaxTable**.</span><span class="sxs-lookup"><span data-stu-id="0588b-126">The added `Model.Data.Tax` data source is configured to specify a tax code for every configured rule by accessing records of the **TaxTable** application table.</span></span>

   ![Análise da fonte de dados de pesquisa de única empresa do tipo Enumeração de formato\Pesquisa](./media/er-lookup-data-sources-img5.gif)

<span data-ttu-id="0588b-128">Você pode configurar as regras de pesquisa para o formato ER selecionado, usando a interface do usuário que é alinhada automaticamente com a estrutura da fonte de dados configurada.</span><span class="sxs-lookup"><span data-stu-id="0588b-128">You can set up the lookup rules for the selected ER format by using the UI that is automatically aligned with the structure of the configured data source.</span></span> <span data-ttu-id="0588b-129">No momento, essa interface do usuário exige que, para cada regra, você especifique o valor retornado como o valor de enumeração de formato `List of taxation levels`, bem como o código de imposto como um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="0588b-129">Currently, this UI requires that for each rule, you specify the returned value as the `List of taxation levels` format enumeration value as well as the tax code as a parameter.</span></span>

   ![Configurar as regras para a fonte de dados configurada](./media/er-lookup-data-sources-img6.gif)

<span data-ttu-id="0588b-131">A ilustração a seguir mostra como a fonte de dados `Model.Data.Summary.LevelByLookup` do tipo **Campo calculado** pode ser configurada para chamar a fonte de dados de **Pesquisa** configurada fornecendo os parâmetros necessários.</span><span class="sxs-lookup"><span data-stu-id="0588b-131">The following illustration shows how the `Model.Data.Summary.LevelByLookup` data source of the **Calculated field** type can be configured to call the configured **Lookup** data source providing the required parameters.</span></span> <span data-ttu-id="0588b-132">Para processar essa chamada em tempo de execução, o ER passa pela lista de regras configuradas na sequência definida para localizar a primeira regra que satisfaça as condições fornecidas.</span><span class="sxs-lookup"><span data-stu-id="0588b-132">To process this call at runtime, ER goes through the list of configured rules in the defined sequence to locate the first rule that satisfies the provided conditions.</span></span> <span data-ttu-id="0588b-133">Neste exemplo, esta é a regra que contém o código de imposto correspondente ao fornecido.</span><span class="sxs-lookup"><span data-stu-id="0588b-133">In this example, it's the rule that contains the tax code that matches the provided one.</span></span> <span data-ttu-id="0588b-134">Como resultado, a regra mais apropriada é encontrada e o valor de enumeração configurado para a regra encontrada é retornado por essa fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="0588b-134">As the result, the most appropriate rule is found and the enumeration value that is configured for the found rule is returned by this data source.</span></span>

> [!NOTE]
> <span data-ttu-id="0588b-135">Uma exceção é lançada quando nenhuma regra aplicável é encontrada.</span><span class="sxs-lookup"><span data-stu-id="0588b-135">An exception is thrown when no applicable rule is found.</span></span> <span data-ttu-id="0588b-136">Para evitar essas exceções, configure regras adicionais no final da lista de regras para manipular casos quando um valor não configurado ou nenhum valor for fornecido.</span><span class="sxs-lookup"><span data-stu-id="0588b-136">To prevent these exceptions, configure additional rules at the end of the rules list to handle cases when a non-configured value or no value is provided.</span></span> <span data-ttu-id="0588b-137">Use as opções **\*Não vazio\*** e **\*Em branco\*** adequadamente.</span><span class="sxs-lookup"><span data-stu-id="0588b-137">Use the **\*Not blank**\* and **\*Blank**\* options accordingly.</span></span>  
>
> ![Adicionar uma fonte de dados para chamar a fonte de dados de pesquisa configurada](./media/er-lookup-data-sources-img7.png)

<span data-ttu-id="0588b-139">Ao definir a opção **Interempresarial** como **Sim** para a fonte de dados de pesquisa editável, você adiciona um novo parâmetro **Empresa** obrigatório ao conjunto de parâmetros dessa fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="0588b-139">When you set the **Cross-company** option to **Yes** for the editable lookup data source, you add a new required **Company** parameter to the set of parameters of this data source.</span></span> <span data-ttu-id="0588b-140">O valor do parâmetro **Empresa** deve ser especificado em tempo de execução quando a fonte de dados de pesquisa é chamada.</span><span class="sxs-lookup"><span data-stu-id="0588b-140">The value of the **Company** parameter must be specified at runtime when the lookup data source is called.</span></span> <span data-ttu-id="0588b-141">Quando o código da empresa é especificado em tempo de execução, as regras configuradas para essa empresa são usadas para encontrar a regra mais apropriada e o valor correspondente é retornado.</span><span class="sxs-lookup"><span data-stu-id="0588b-141">When the company code is specified at runtime, the rules configured for this company are used to find the most appropriate rule, and the corresponding value is returned.</span></span> <span data-ttu-id="0588b-142">A ilustração a seguir mostra como você pode fazer isso e como o conjunto de parâmetros da fonte de dados editável é alterado.</span><span class="sxs-lookup"><span data-stu-id="0588b-142">The following illustration shows how you can do this and how the set of parameters of the editable data source is changed.</span></span>

   ![Análise da fonte de dados de pesquisa interempresarial do tipo Enumeração de formato\Pesquisa](./media/er-lookup-data-sources-img8.gif)

> [!NOTE]
> <span data-ttu-id="0588b-144">Selecione cada empresa separadamente para configurar o conjunto de regras para essa fonte de dados de pesquisa do formato ER editável.</span><span class="sxs-lookup"><span data-stu-id="0588b-144">Select every company seperately to configure the set of rules for this lookup data source of the editable ER format.</span></span> <span data-ttu-id="0588b-145">Uma exceção é lançada em tempo de execução quando a pesquisa interempresarial é chamada com o código da empresa para a qual a configuração de pesquisa não foi concluída.</span><span class="sxs-lookup"><span data-stu-id="0588b-145">An exception is thrown at runtime when the cross-company lookup is called with the code of the company for which the lookup setting was not completed.</span></span>
>
> <span data-ttu-id="0588b-146">Certifique-se de conceder permissões para um usuário que executa o formato ER com a fonte de dados de **Pesquisa** interempresarial para acessar os dados de todas as empresas que estão no escopo dessa fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="0588b-146">Make sure that you grant permissions for a user who runs the ER format with the cross-company **Lookup** data source to access the data of every company that is in scope of this data source.</span></span> <span data-ttu-id="0588b-147">Caso contrário, uma exceção é lançada em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="0588b-147">Otherwise, an exception is thrown at runtime.</span></span>

<span data-ttu-id="0588b-148">A partir da versão 10.0.19, os recursos estendidos das fontes de dados de **Pesquisa** estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="0588b-148">Starting in version 10.0.19, the extended capabilities of the **Lookup** data sources are available.</span></span> <span data-ttu-id="0588b-149">Ao definir a opção **Estendida** como **Sim** para a fonte de dados de pesquisa editável, a fonte de dados de pesquisa configurada será transformada na fonte de dados estruturada que oferece os recursos adicionais para analisar o conjunto de regras configurado.</span><span class="sxs-lookup"><span data-stu-id="0588b-149">When you set the **Extended** option to **Yes** for the editable lookup data source, the configured lookup data source is transformed to the structured data source that offers the additional capabilities to analyze the configured set of rules.</span></span> <span data-ttu-id="0588b-150">A ilustração a seguir mostra essa transformação.</span><span class="sxs-lookup"><span data-stu-id="0588b-150">The following illustration shows this transformation.</span></span>

   ![Análise da fonte de dados de pesquisa estruturada do tipo Enumeração de formato\Pesquisa](./media/er-lookup-data-sources-img9.gif)

- <span data-ttu-id="0588b-152">O subitem de **Pesquisa** é criado como uma função para encontrar a regra mais apropriada do conjunto de regras configuráveis com base no conjunto de parâmetros fornecido.</span><span class="sxs-lookup"><span data-stu-id="0588b-152">The **Lookup** sub-item is designed as a function to find the most appropriate rule from the set of configurable rules based on the provided set of parameters.</span></span>
- <span data-ttu-id="0588b-153">O subitem **IsLookupResultSet** é criado como uma função para aceitar o valor fornecido da fonte de dados de enumeração base e retornar o valor *Booliano* como **Verdadeiro** quando o conjunto de regras contém pelo menos uma regra para a qual o valor de enumeração fornecido foi configurado como um valor devolvido.</span><span class="sxs-lookup"><span data-stu-id="0588b-153">The **IsLookupResultSet** sub-item is designed as a function to accept the provided value of the base enumeration data source and return the *Boolean* value of **True** when the set of rules contain at least one rule for which the provided enumeration value was configured as a returned value.</span></span> <span data-ttu-id="0588b-154">Esta função retorna o valor *Booliano* como **Falso** quando não há regras configuradas para retornar o valor de enumeração fornecido.</span><span class="sxs-lookup"><span data-stu-id="0588b-154">This function returns the *Boolean* value of **False** when there are no rules configured to return the provided enumeration value.</span></span>
- <span data-ttu-id="0588b-155">O subitem de **Configuração** é criado como uma função que retorna o conjunto de regras configuradas como registros de uma lista de registros.</span><span class="sxs-lookup"><span data-stu-id="0588b-155">The **Setting** sub-item is designed as a function that returns the set of configured rules as records of a record list.</span></span> <span data-ttu-id="0588b-156">Os valores retornados e o conjunto de parâmetros das regras configuradas são apresentados em todos os registros devolvidos como campos dos tipos de dados relevantes:</span><span class="sxs-lookup"><span data-stu-id="0588b-156">The returned values and the set of parameters of the configured rules are presented in every returned record as fields of the relevant data types:</span></span>

    - <span data-ttu-id="0588b-157">O valor retornado é apresentado como o campo **Resultado da pesquisa**.</span><span class="sxs-lookup"><span data-stu-id="0588b-157">The returned value is presented as the **Lookup result** field.</span></span>
    - <span data-ttu-id="0588b-158">Os parâmetros configurados são apresentados como campos com nomes de parâmetros (campo **Código** neste exemplo).</span><span class="sxs-lookup"><span data-stu-id="0588b-158">The configured parameters are presented as fields having names of parameters (**Code** field in this example).</span></span>

<span data-ttu-id="0588b-159">Para obter mais informações sobre como configurar a fonte de dados de **Pesquisa**, consulte [Configurar formatos de ER para usar parâmetros especificados por entidade legal](er-app-specific-parameters-configure-format.md).</span><span class="sxs-lookup"><span data-stu-id="0588b-159">For more information about to how configure the **Lookup** data source, see [Configure ER formats to use parameters that are specified per legal entity](er-app-specific-parameters-configure-format.md).</span></span> <span data-ttu-id="0588b-160">Para saber como definir as regras de pesquisa, consulte [Configurar os parâmetros de um formato de ER por entidade legal](er-app-specific-parameters-set-up.md).</span><span class="sxs-lookup"><span data-stu-id="0588b-160">To learn how to set the Lookup rules, see [Set up the parameters of an ER format per legal entity](er-app-specific-parameters-set-up.md).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="0588b-161">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="0588b-161">Additional resources</span></span>

[<span data-ttu-id="0588b-162">Configurar formatos ER para usar parâmetros especificados de acordo com a entidade legal</span><span class="sxs-lookup"><span data-stu-id="0588b-162">Configure ER formats to use parameters that are specified per legal entity</span></span>](er-app-specific-parameters-configure-format.md)

[<span data-ttu-id="0588b-163">Configurar os parâmetros de um formato ER de acordo com a entidade legal</span><span class="sxs-lookup"><span data-stu-id="0588b-163">Set up the parameters of an ER format per legal entity</span></span>](er-app-specific-parameters-set-up.md)
