---
title: Designer de fórmulas no relatório eletrônico (ER)
description: Este tópico fornece informações sobre como usar o designer de fórmulas no relatório eletrônico (ER).
author: NickSelin
manager: kfend
ms.date: 12/05/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: ERDataModelDesigner, ERExpressionDesignerFormula, ERMappedFormatDesigner, ERModelMappingDesigner
audience: Application User, IT Pro
ms.reviewer: kfend
ms.custom: 58771
ms.assetid: 24223e13-727a-4be6-a22d-4d427f504ac9
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: d96fe041fd0ffb292909c1e724068efebe0184b9
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/05/2020
ms.locfileid: "4682640"
---
# <a name="formula-designer-in-electronic-reporting-er"></a><span data-ttu-id="2544e-103">Designer de fórmulas no relatório eletrônico (ER)</span><span class="sxs-lookup"><span data-stu-id="2544e-103">Formula designer in Electronic reporting (ER)</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="2544e-104">Este tópico explica como usar o designer de fórmulas no ER (Relatório Eletrônico).</span><span class="sxs-lookup"><span data-stu-id="2544e-104">This topic explains how to use the formula designer in Electronic reporting (ER).</span></span> <span data-ttu-id="2544e-105">Ao criar um formato para um documento eletrônico específico em ER, você pode usar fórmulas para transformar dados, de forma que ele atenda aos requisitos da realização e formatação desse documento.</span><span class="sxs-lookup"><span data-stu-id="2544e-105">When you design a format for a specific electronic document in ER, you can use formulas to transform data so that it meets the requirements for the document's fulfillment and formatting.</span></span> <span data-ttu-id="2544e-106">Essas fórmulas assemelham-se às fórmulas do Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="2544e-106">These formulas resemble formulas in Microsoft Excel.</span></span> <span data-ttu-id="2544e-107">Vários tipos de funções têm suporte nas fórmulas: texto, data e hora, matemática, lógica, informações, além de funções de conversão de tipo de dados, entre outras, como funções específicas de domínio comercial.</span><span class="sxs-lookup"><span data-stu-id="2544e-107">Various types of functions are supported in the formulas: text, date and time, mathematical, logical, information, and data type conversion functions, and also other, business domain–specific functions.</span></span>

## <a name="formula-designer-overview"></a><span data-ttu-id="2544e-108">Visão geral do designer de fórmulas</span><span class="sxs-lookup"><span data-stu-id="2544e-108">Formula designer overview</span></span>

<span data-ttu-id="2544e-109">O relatório eletrônico (RE) suporta o designer de fórmulas.</span><span class="sxs-lookup"><span data-stu-id="2544e-109">ER supports the formula designer.</span></span> <span data-ttu-id="2544e-110">Consequentemente, no tempo de design, você pode configurar as expressões que podem ser usadas para as seguintes tarefas no momento da execução:</span><span class="sxs-lookup"><span data-stu-id="2544e-110">Therefore, at design time, you can configure expressions that can be used for the following tasks at runtime:</span></span>

- <span data-ttu-id="2544e-111">Transformar os dados que são recebidos de um banco de dados de aplicativo e que devem ser inseridos em um modelo de dados de ER criado para ser uma fonte de dados para formatos de ER.</span><span class="sxs-lookup"><span data-stu-id="2544e-111">Transform data that is received from an application database and that should be entered in an ER data model that is designed to be a data source for ER formats.</span></span> <span data-ttu-id="2544e-112">(Por exemplo, essas transformações podem incluir a filtragem, o agrupamento e a conversão de tipo de dados).</span><span class="sxs-lookup"><span data-stu-id="2544e-112">(For example, these transformations might include filtering, grouping, and data type conversion.)</span></span>
- <span data-ttu-id="2544e-113">Formatar os dados que devem ser enviados para gerar um documento eletrônico, de acordo com o layout e as condições de um formato de ER específico.</span><span class="sxs-lookup"><span data-stu-id="2544e-113">Format data that must be sent to a generating electronic document in accordance with the layout and conditions of a specific ER format.</span></span> <span data-ttu-id="2544e-114">(Por exemplo, a formatação pode ser feita de acordo com o idioma ou cultura solicitados, ou a codificação).</span><span class="sxs-lookup"><span data-stu-id="2544e-114">(For example, the formatting might be done in accordance with the requested language or culture, or the encoding).</span></span>
- <span data-ttu-id="2544e-115">Controlar o processo de criar documentos eletrônicos.</span><span class="sxs-lookup"><span data-stu-id="2544e-115">Control the process of creating electronic documents.</span></span> <span data-ttu-id="2544e-116">(Por exemplo, as expressões pode habilitar ou desabilitar a saída de elementos específicos do formato de dados, dependendo dos dados de processamento.</span><span class="sxs-lookup"><span data-stu-id="2544e-116">(For example, the expressions can enable or disable the output of specific elements of the format, depending on processing data.</span></span> <span data-ttu-id="2544e-117">Também pode interromper o processo de criação do documento ou enviar mensagens para os usuários.)</span><span class="sxs-lookup"><span data-stu-id="2544e-117">They can also interrupt the document creation process or throw messages to users.)</span></span>

<span data-ttu-id="2544e-118">Você pode abrir a página **Designer de fórmulas** quando executar qualquer uma das seguintes ações:</span><span class="sxs-lookup"><span data-stu-id="2544e-118">You can open the **Formula designer** page when you perform any of the following actions:</span></span>

- <span data-ttu-id="2544e-119">Associar itens da fonte de dados a componentes do modelo de dados.</span><span class="sxs-lookup"><span data-stu-id="2544e-119">Bind data source items to data model components.</span></span>
- <span data-ttu-id="2544e-120">Associar itens da fonte de dados a componentes do formato.</span><span class="sxs-lookup"><span data-stu-id="2544e-120">Bind data source items to format components.</span></span>
- <span data-ttu-id="2544e-121">Concluir a manutenção dos campos calculados que fazem parte das fontes de dados.</span><span class="sxs-lookup"><span data-stu-id="2544e-121">Complete maintenance of calculated fields that are part of data sources.</span></span>
- <span data-ttu-id="2544e-122">Definir as condições de visibilidade dos parâmetros de entrada de usuário.</span><span class="sxs-lookup"><span data-stu-id="2544e-122">Define the visibility conditions for user input parameters.</span></span>
- <span data-ttu-id="2544e-123">Criar as transformações de um formato.</span><span class="sxs-lookup"><span data-stu-id="2544e-123">Design a format's transformations.</span></span>
- <span data-ttu-id="2544e-124">Definir as condições de habilitação dos componentes do formato.</span><span class="sxs-lookup"><span data-stu-id="2544e-124">Define the enabling conditions for the format's components.</span></span>
- <span data-ttu-id="2544e-125">Definir os nomes de arquivo para os componentes do ARQUIVO do formato.</span><span class="sxs-lookup"><span data-stu-id="2544e-125">Define the file names for the format's FILE components.</span></span>
- <span data-ttu-id="2544e-126">Definir as condições para as validações do controle de processo.</span><span class="sxs-lookup"><span data-stu-id="2544e-126">Define the conditions for process control validations.</span></span>
- <span data-ttu-id="2544e-127">Definir o texto da mensagem para as validações do controle de processo.</span><span class="sxs-lookup"><span data-stu-id="2544e-127">Define the message text for process control validations.</span></span>

## <a name="data-binding"></a><a name="Binding"></a><span data-ttu-id="2544e-128">Associação de dados</span><span class="sxs-lookup"><span data-stu-id="2544e-128">Data binding</span></span>

<span data-ttu-id="2544e-129">O designer de fórmulas de ER pode ser usado para definir uma expressão que transforme os dados recebidos das fontes de dados, de modo que eles possam ser inseridos no consumidor de dados das seguintes maneiras no tempo de execução:</span><span class="sxs-lookup"><span data-stu-id="2544e-129">The ER formula designer can be used to define an expression that transforms data that is received from data sources, so that the data can be entered in the data consumer in the following ways at runtime:</span></span>

- <span data-ttu-id="2544e-130">Das fontes de dados do aplicativo e parâmetros em tempo de execução para um modelo de dados de ER</span><span class="sxs-lookup"><span data-stu-id="2544e-130">From application data sources and runtime parameters to an ER data model</span></span>
- <span data-ttu-id="2544e-131">De um modelo de dados de ER a um formato de ER</span><span class="sxs-lookup"><span data-stu-id="2544e-131">From an ER data model to an ER format</span></span>
- <span data-ttu-id="2544e-132">Das fontes de dados do aplicativo e parâmetros em tempo de execução para um formato de ER</span><span class="sxs-lookup"><span data-stu-id="2544e-132">From application data sources and runtime parameters to an ER format</span></span>

<span data-ttu-id="2544e-133">A ilustração a seguir mostra o design de uma expressão desse tipo.</span><span class="sxs-lookup"><span data-stu-id="2544e-133">The following illustration shows the design of an expression of this type.</span></span> <span data-ttu-id="2544e-134">Neste exemplo, a expressão arredonda o valor do campo **Intrastat.AmountMST** na tabela Intrastat para duas casas decimais e, em seguida, retorna o valor arredondado.</span><span class="sxs-lookup"><span data-stu-id="2544e-134">In this example, the expression rounds the value of the **Intrastat.AmountMST** field in the Intrastat table to two decimal places and then returns the rounded value.</span></span>

<span data-ttu-id="2544e-135">[![Expressão de associação de dados](./media/picture-expression-binding.jpg)](./media/picture-expression-binding.jpg)</span><span class="sxs-lookup"><span data-stu-id="2544e-135">[![Data binding expression](./media/picture-expression-binding.jpg)](./media/picture-expression-binding.jpg)</span></span>

<span data-ttu-id="2544e-136">A ilustração a seguir mostra como uma expressão desse tipo pode ser usada.</span><span class="sxs-lookup"><span data-stu-id="2544e-136">The following illustration shows how an expression of this type can be used.</span></span> <span data-ttu-id="2544e-137">Neste exemplo, o resultado da expressão criada é inserido no componente **Transaction.InvoicedAmount** do modelo de dados **Modelo de relatório de impostos**.</span><span class="sxs-lookup"><span data-stu-id="2544e-137">In this example, the result of the designed expression is entered in the **Transaction.InvoicedAmount** component of the **Tax reporting model** data model.</span></span>

<span data-ttu-id="2544e-138">[![Expressão de associação de dados que está sendo usada](./media/picture-expression-binding2.jpg)](./media/picture-expression-binding2.jpg)</span><span class="sxs-lookup"><span data-stu-id="2544e-138">[![Data binding expression being used](./media/picture-expression-binding2.jpg)](./media/picture-expression-binding2.jpg)</span></span>

<span data-ttu-id="2544e-139">No tempo de execução, a fórmula criada, `ROUND (Intrastat.AmountMST, 2)`, arredonda o valor do campo **AmountMST** de cada registro na tabela Intrastat para duas casas decimais.</span><span class="sxs-lookup"><span data-stu-id="2544e-139">At runtime, the designed formula, `ROUND (Intrastat.AmountMST, 2)`, rounds the value of the **AmountMST** field for each record in the Intrastat table to two decimal places.</span></span> <span data-ttu-id="2544e-140">Depois, insere o valor arredondado no componente **Transaction.InvoicedAmount** do modelo de dados **Relatório de imposto**.</span><span class="sxs-lookup"><span data-stu-id="2544e-140">It then enters the rounded value in the **Transaction.InvoicedAmount** component of the **Tax reporting** data model.</span></span>

## <a name="data-formatting"></a><a name="Transformation"></a><span data-ttu-id="2544e-141">Formatação de dados</span><span class="sxs-lookup"><span data-stu-id="2544e-141">Data formatting</span></span>

<span data-ttu-id="2544e-142">O designer de fórmulas de ER pode ser usado para definir uma expressão que formata os dados que são recebidos das fontes de dados, de modo que os dados podem ser enviados como parte da criação de um documento eletrônico.</span><span class="sxs-lookup"><span data-stu-id="2544e-142">The ER formula designer can be used to define an expression that formats data that is received from data sources, so that the data can be sent as part of the generating electronic document.</span></span> <span data-ttu-id="2544e-143">Você pode ter uma formatação que deve ser aplicada como uma regra comum que deve ser reutilizada para um formato.</span><span class="sxs-lookup"><span data-stu-id="2544e-143">You might have formatting that must be applied as a typical rule that should be reused for a format.</span></span> <span data-ttu-id="2544e-144">Neste caso, você pode apresentar essa formatação uma vez na configuração do formato, como uma transformação nomeada que tem uma expressão de formatação.</span><span class="sxs-lookup"><span data-stu-id="2544e-144">In this case, you can introduce that formatting one time in the format configuration, as a named transformation that has a formatting expression.</span></span> <span data-ttu-id="2544e-145">Essa transformação nomeada poderá, em seguida, ser vinculada a vários componentes de formato cuja saída deve ser formatada de acordo com a expressão formatada criada.</span><span class="sxs-lookup"><span data-stu-id="2544e-145">This named transformation can then be linked to many format components where the output must be formatted according to the formatting expression that you created.</span></span>

<span data-ttu-id="2544e-146">A ilustração a seguir mostra o design de uma transformação desse tipo.</span><span class="sxs-lookup"><span data-stu-id="2544e-146">The following illustration shows the design of a transformation of this type.</span></span> <span data-ttu-id="2544e-147">Neste exemplo, a transformação de **TrimmedString** trunca os dados de entrada do tipo de dados *Sequência de caracteres* removendo espaços à direita e à esquerda.</span><span class="sxs-lookup"><span data-stu-id="2544e-147">In this example, the **TrimmedString** transformation truncates incoming data of the *String* data type by removing leading and trailing spaces.</span></span> <span data-ttu-id="2544e-148">Em seguida, ela retorna o valor truncado da sequência de caracteres.</span><span class="sxs-lookup"><span data-stu-id="2544e-148">It then returns the truncated string value.</span></span>

<span data-ttu-id="2544e-149">[![Transformação](./media/picture-transformation-design.jpg)](./media/picture-transformation-design.jpg)</span><span class="sxs-lookup"><span data-stu-id="2544e-149">[![Transformation](./media/picture-transformation-design.jpg)](./media/picture-transformation-design.jpg)</span></span>

<span data-ttu-id="2544e-150">A ilustração a seguir mostra como uma transformação desse tipo pode ser usada.</span><span class="sxs-lookup"><span data-stu-id="2544e-150">The following illustration shows how a transformation of this type can be used.</span></span> <span data-ttu-id="2544e-151">Neste exemplo, vários componentes de formato enviam o texto como saída para o documento eletrônico gerado no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="2544e-151">In this example, several format components send text as output to the generating electronic document at runtime.</span></span> <span data-ttu-id="2544e-152">Todos os componentes do formato referem-se à transformação **TrimmedString** por nome.</span><span class="sxs-lookup"><span data-stu-id="2544e-152">All these format components refer to the **TrimmedString** transformation by name.</span></span>

<span data-ttu-id="2544e-153">[![Transformação que está sendo usada](./media/picture-transformation-usage.jpg)](./media/picture-transformation-usage.jpg)</span><span class="sxs-lookup"><span data-stu-id="2544e-153">[![Transformation being used](./media/picture-transformation-usage.jpg)](./media/picture-transformation-usage.jpg)</span></span>

<span data-ttu-id="2544e-154">Quando os componentes de formato, como o componente **partyName** na ilustração precedente, referem-se à transformação **TrimmedString**, a transformação envia o texto como saída para o documento eletrônico gerado.</span><span class="sxs-lookup"><span data-stu-id="2544e-154">When format components, such as the **partyName** component in the preceding illustration, refer to the **TrimmedString** transformation, the transformation sends text as output to the generating electronic document.</span></span> <span data-ttu-id="2544e-155">Este texto não inclui espaços à esquerda e à direita.</span><span class="sxs-lookup"><span data-stu-id="2544e-155">This text doesn't include leading and trailing spaces.</span></span>

<span data-ttu-id="2544e-156">Se você tiver uma formatação que precise ser aplicada individualmente, ela poderá ser apresentada como a expressão individual da associação do componente de formato específico.</span><span class="sxs-lookup"><span data-stu-id="2544e-156">If you have formatting that must be applied individually, you can introduce that formatting as an individual expression of a binding of a specific format component.</span></span> <span data-ttu-id="2544e-157">A ilustração a seguir mostra uma expressão desse tipo.</span><span class="sxs-lookup"><span data-stu-id="2544e-157">The following illustration shows an expression of this type.</span></span> <span data-ttu-id="2544e-158">Neste exemplo, o componente do formato **partyType** é associado à fonte de dados por meio de uma expressão que converte os dados de entrada do campo **Model.Company.RegistrationType** na fonte de dados para texto com letras maiúsculas.</span><span class="sxs-lookup"><span data-stu-id="2544e-158">In this example, the **partyType** format component is bound to the data source via an expression that converts incoming data from the **Model.Company.RegistrationType** field in the data source to uppercase text.</span></span> <span data-ttu-id="2544e-159">Em seguida, a expressão envia esse texto como saída para o documento eletrônico.</span><span class="sxs-lookup"><span data-stu-id="2544e-159">The expression then sends that text as output to the electronic document.</span></span>

<span data-ttu-id="2544e-160">[![Aplicar formatação a um componente individual](./media/picture-binding-with-formula.jpg)](./media/picture-binding-with-formula.jpg)</span><span class="sxs-lookup"><span data-stu-id="2544e-160">[![Applying formatting to an individual component](./media/picture-binding-with-formula.jpg)](./media/picture-binding-with-formula.jpg)</span></span>

## <a name="process-flow-control"></a><a name="Validation"></a><span data-ttu-id="2544e-161">Controle do fluxo de processo</span><span class="sxs-lookup"><span data-stu-id="2544e-161">Process flow control</span></span>

<span data-ttu-id="2544e-162">O designer de fórmulas de ER pode ser usado para definir expressões que controlam o fluxo do processo de geração de documentos eletrônicos.</span><span class="sxs-lookup"><span data-stu-id="2544e-162">The ER formula designer can be used to define expressions that control the process flow of generating electronic documents.</span></span> <span data-ttu-id="2544e-163">Você pode executar estas tarefas:</span><span class="sxs-lookup"><span data-stu-id="2544e-163">You can perform the following tasks:</span></span>

- <span data-ttu-id="2544e-164">Define condições que determinam quando um processo de criação do documento deve ser interrompido</span><span class="sxs-lookup"><span data-stu-id="2544e-164">Define conditions that determine when a document creation process must be stopped.</span></span>
- <span data-ttu-id="2544e-165">Especificar expressões que criam mensagens para o usuário sobre processos interrompidos ou enviam mensagens do log de execução sobre a continuidade do processo de geração de relatórios.</span><span class="sxs-lookup"><span data-stu-id="2544e-165">Specify expressions that either create messages for the user about stopped processes or throw execution log messages about the continuing process of report generation.</span></span>
- <span data-ttu-id="2544e-166">Especificar os nomes dos documentos eletrônicos gerados e controlar as condições de sua criação.</span><span class="sxs-lookup"><span data-stu-id="2544e-166">Specify the file names of generating electronic documents, and control the conditions of their creation.</span></span>

<span data-ttu-id="2544e-167">Cada regra de controle de fluxo de processo é criada como uma validação individual.</span><span class="sxs-lookup"><span data-stu-id="2544e-167">Each rule of the process flow control is designed as an individual validation.</span></span> <span data-ttu-id="2544e-168">A ilustração a seguir mostra uma validação desse tipo.</span><span class="sxs-lookup"><span data-stu-id="2544e-168">The following illustration shows a validation of this type.</span></span> <span data-ttu-id="2544e-169">Aqui está uma explicação da configuração neste exemplo:</span><span class="sxs-lookup"><span data-stu-id="2544e-169">Here is an explanation of the configuration in this example:</span></span>

- <span data-ttu-id="2544e-170">A validação é avaliada quando o nó **INSTAT** é criado durante a geração do arquivo XML.</span><span class="sxs-lookup"><span data-stu-id="2544e-170">The validation is evaluated when the **INSTAT** node is created during generation of the XML file.</span></span>
- <span data-ttu-id="2544e-171">Se a lista de transações está vazia, a validação interrompe o processo de execução e retorna **FALSE**.</span><span class="sxs-lookup"><span data-stu-id="2544e-171">If the list of transactions is empty, the validation stops the execution process and returns **FALSE**.</span></span>
- <span data-ttu-id="2544e-172">A validação retorna uma mensagem de erro que inclui o texto de rótulo SYS70894 no idioma preferido do usuário.</span><span class="sxs-lookup"><span data-stu-id="2544e-172">The validation returns an error message that includes the text of label SYS70894 in the user's preferred language.</span></span>

<span data-ttu-id="2544e-173">[![Validação](./media/picture-validation.jpg)](./media/picture-validation.jpg)</span><span class="sxs-lookup"><span data-stu-id="2544e-173">[![Validation](./media/picture-validation.jpg)](./media/picture-validation.jpg)</span></span>

<span data-ttu-id="2544e-174">O designer de fórmulas de ER também pode ser usado para gerar um nome de arquivo para um documento eletrônico gerado e controlar o processo de criação de arquivos.</span><span class="sxs-lookup"><span data-stu-id="2544e-174">The ER formula designer can also be used to generate a file name for a generating electronic document and to control the file creation process.</span></span> <span data-ttu-id="2544e-175">A ilustração a seguir mostra o design de um controle de fluxo de processo desse tipo.</span><span class="sxs-lookup"><span data-stu-id="2544e-175">The following illustration shows the design of a process flow control of this type.</span></span> <span data-ttu-id="2544e-176">Aqui está uma explicação da configuração neste exemplo:</span><span class="sxs-lookup"><span data-stu-id="2544e-176">Here is an explanation of the configuration in this example:</span></span>

- <span data-ttu-id="2544e-177">A lista de registros da fonte de dados **model.Intrastat** é dividida em lotes.</span><span class="sxs-lookup"><span data-stu-id="2544e-177">The list of records from the **model.Intrastat** data source is divided into batches.</span></span> <span data-ttu-id="2544e-178">Cada lote contém até 1.000 registros.</span><span class="sxs-lookup"><span data-stu-id="2544e-178">Each batch contains up to 1,000 records.</span></span>
- <span data-ttu-id="2544e-179">As saídas criam um arquivo relevante que contém um arquivo no formato XML para cada lote que foi criado.</span><span class="sxs-lookup"><span data-stu-id="2544e-179">The output creates a zip file that contains one file in XML format for every batch that was created.</span></span>
- <span data-ttu-id="2544e-180">Uma expressão retorna um nome de arquivo para gerar documentos eletrônicos, concatenando o nome do arquivo e a extensão de nome do arquivo.</span><span class="sxs-lookup"><span data-stu-id="2544e-180">An expression returns a file name for generating electronic documents by concatenating the file name and the file name extension.</span></span> <span data-ttu-id="2544e-181">Dependendo do lote e de todos os lotes subsequentes, o nome do arquivo contém a ID de lote como sufixo.</span><span class="sxs-lookup"><span data-stu-id="2544e-181">For the second batch and all subsequent batches, the file name contains the batch ID as a suffix.</span></span>
- <span data-ttu-id="2544e-182">Uma expressão habilita (retornando um **TRUE**) o processo de criação de arquivo para lotes que contêm pelo menos um registro.</span><span class="sxs-lookup"><span data-stu-id="2544e-182">An expression enables (by returning **TRUE**) the file creation process for batches that contain at least one record.</span></span>

<span data-ttu-id="2544e-183">[![Controle do fluxo de processo](./media/picture-file-control.jpg)](./media/picture-file-control.jpg)</span><span class="sxs-lookup"><span data-stu-id="2544e-183">[![Process flow control](./media/picture-file-control.jpg)](./media/picture-file-control.jpg)</span></span>

## <a name="document-content-control"></a><a name="Enabled"></a><span data-ttu-id="2544e-184">Controle de conteúdo de documentos</span><span class="sxs-lookup"><span data-stu-id="2544e-184">Document content control</span></span>

<span data-ttu-id="2544e-185">O designer de fórmulas de ER pode ser usado para configurar expressões que controlam quais dados serão inseridos nos documentos eletrônicos gerados no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="2544e-185">The ER formula designer can be used to configure expressions that control what data will be put into generated electronic documents at runtime.</span></span> <span data-ttu-id="2544e-186">As expressões podem habilitar ou desabilitar a saída de elementos específicos do formato de dados, dependendo dos dados de processamento e da lógica configurada.</span><span class="sxs-lookup"><span data-stu-id="2544e-186">The expressions can enable or disable the output of specific elements of the format, depending on processing data and configured logic.</span></span> <span data-ttu-id="2544e-187">Essas expressões podem ser inseridas para um único elemento de formato no campo **Habilitado** na guia **Mapeamento** da página **Designer de operações**.</span><span class="sxs-lookup"><span data-stu-id="2544e-187">These expressions can be entered for a single format element in the **Enabled** field on the **Mapping** tab of the **Operations designer** page.</span></span> <span data-ttu-id="2544e-188">Você pode inserir as expressões como uma condição lógica que retorna um valor *Booliano*:</span><span class="sxs-lookup"><span data-stu-id="2544e-188">You can enter the expressions as a logic condition that returns a *Boolean* value:</span></span>

- <span data-ttu-id="2544e-189">Se a condição retornar **Verdadeiro**, o elemento de formato atual será executado.</span><span class="sxs-lookup"><span data-stu-id="2544e-189">If the condition returns **True**, the current format element is run.</span></span>
- <span data-ttu-id="2544e-190">Se a condição retornar **Falso**, o elemento de formato atual será ignorado.</span><span class="sxs-lookup"><span data-stu-id="2544e-190">If the condition returns **False**, the current format element is skipped.</span></span>

<span data-ttu-id="2544e-191">A ilustração a seguir mostra expressões desse tipo.</span><span class="sxs-lookup"><span data-stu-id="2544e-191">The following illustration shows expressions of this type.</span></span> <span data-ttu-id="2544e-192">(A versão 11.12.11 da configuração de formato **Transferência de crédito ISO20022 (NO)** que é fornecida pela Microsoft é usada como exemplo.) O componente de formato **XMLHeader** foi configurado para descrever a estrutura da mensagem de transferência de crédito de acordo com os padrões de mensagens XML ISO 20022.</span><span class="sxs-lookup"><span data-stu-id="2544e-192">(Version 11.12.11 of the **ISO20022 Credit transfer (NO)** format configuration that is provided by Microsoft is used as an example.) The **XMLHeader** format component is configured to describe the structure of the credit transfer message according to the ISO 20022 XML message standards.</span></span> <span data-ttu-id="2544e-193">O componente de formato **XMLHeader/Document/CstmrCdtTrfInitn/PmtInf/CdtTrfTxInf/RmtInf/Ustrd** foi configurado para adicionar o elemento XML **Ustrd** à mensagem gerada e colocar as informações de remessa em um formato não estruturado como texto dos seguintes elementos XML:</span><span class="sxs-lookup"><span data-stu-id="2544e-193">The **XMLHeader/Document/CstmrCdtTrfInitn/PmtInf/CdtTrfTxInf/RmtInf/Ustrd** format component is configured to add the **Ustrd** XML element to the generated message and to put the remittance information in an unstructured format as text of the following XML elements:</span></span>

- <span data-ttu-id="2544e-194">O componente **PaymentNotes** é usado para gerar o texto das notas de pagamento.</span><span class="sxs-lookup"><span data-stu-id="2544e-194">The **PaymentNotes** component is used to generate the text of payment notes.</span></span>
- <span data-ttu-id="2544e-195">O componente **DelimitedSequence** gera números de fatura separados por vírgula que são usados para liquidar a transferência de crédito atual.</span><span class="sxs-lookup"><span data-stu-id="2544e-195">The **DelimitedSequence** component generates comma-separated invoice numbers that are used to settle the current credit transfer.</span></span>

<span data-ttu-id="2544e-196">[![Componentes PaymentNotes e DelimitedSequence](./media/GER-FormulaEditor-ControlContent-1.png)](./media/GER-FormulaEditor-ControlContent-1.png)</span><span class="sxs-lookup"><span data-stu-id="2544e-196">[![PaymentNotes and DelimitedSequence components](./media/GER-FormulaEditor-ControlContent-1.png)](./media/GER-FormulaEditor-ControlContent-1.png)</span></span>

> [!NOTE]
> <span data-ttu-id="2544e-197">Os componentes **PaymentNotes** e **DelimitedSequence** são rotulados com um ponto de interrogação.</span><span class="sxs-lookup"><span data-stu-id="2544e-197">The **PaymentNotes** and **DelimitedSequence** components are labeled by using a question mark.</span></span> <span data-ttu-id="2544e-198">Um ponto de interrogação indica que o uso de um componente é condicional.</span><span class="sxs-lookup"><span data-stu-id="2544e-198">A question mark indicates that the use of a component is conditional.</span></span> <span data-ttu-id="2544e-199">Nesse caso, o uso dos componentes se baseia nos seguintes critérios:</span><span class="sxs-lookup"><span data-stu-id="2544e-199">In this case, use of the components is based on the following criteria:</span></span>
>
> - <span data-ttu-id="2544e-200">A expressão `@.PaymentsNotes <> ""` definida para o componente **PaymentNotes** permite (retornando **TRUE**) que o elemento XML **Ustrd** seja preenchido com o texto das notas de pagamento, se esse texto não estiver em branco para a transferência de crédito atual.</span><span class="sxs-lookup"><span data-stu-id="2544e-200">The `@.PaymentsNotes <> ""` expression that is defined for the **PaymentNotes** component enables (by returning **TRUE**) the **Ustrd** XML element to be filled with the text of payment notes, if that text isn't blank for the current credit transfer.</span></span>
>
>    <span data-ttu-id="2544e-201">[![Expressão para o componente PaymentNotes](./media/GER-FormulaEditor-ControlContent-2.png)](./media/GER-FormulaEditor-ControlContent-2.png)</span><span class="sxs-lookup"><span data-stu-id="2544e-201">[![Expression for the PaymentNotes component](./media/GER-FormulaEditor-ControlContent-2.png)](./media/GER-FormulaEditor-ControlContent-2.png)</span></span>
>
> - <span data-ttu-id="2544e-202">A expressão `@.PaymentsNotes = ""` definida para o componente **DelimitedSequence** permite (retornando **TRUE**) que o elemento XML **Ustrd** seja preenchido com uma lista separada por vírgula dos números de fatura usados para liquidar a transferência de crédito atual, se o texto das notas de pagamento dessa transferência de crédito estiver em branco.</span><span class="sxs-lookup"><span data-stu-id="2544e-202">The `@.PaymentsNotes = ""` expression that is defined for the **DelimitedSequence** component enables (by returning **TRUE**) the **Ustrd** XML element to be filled with a comma-separated list of the invoice numbers that are used to settle the current credit transfer, if the text of payment notes for that credit transfer is blank.</span></span>
>
>    <span data-ttu-id="2544e-203">[![Expressão para o componente DelimitedSequence](./media/GER-FormulaEditor-ControlContent-3.png)](./media/GER-FormulaEditor-ControlContent-3.png)</span><span class="sxs-lookup"><span data-stu-id="2544e-203">[![Expression for the DelimitedSequence component](./media/GER-FormulaEditor-ControlContent-3.png)](./media/GER-FormulaEditor-ControlContent-3.png)</span></span>
> 
> <span data-ttu-id="2544e-204">Com base nessa configuração, a mensagem gerada para cada pagamento de devedor, o elemento XML **Ustrd**, conterá o texto das notas de pagamento ou, quando esse texto estiver em branco, uma lista separada por vírgula dos números de fatura que são usados para liquidar o pagamento.</span><span class="sxs-lookup"><span data-stu-id="2544e-204">Based on this setup, the message that is generated for each debtor payment, the **Ustrd** XML element, will contain either the text of payment notes or, when that text is blank, a comma-separated list of the invoice numbers that are used to settle the payment.</span></span>

## <a name="validation-of-configured-formulas"></a><a name="TestFormula"></a><span data-ttu-id="2544e-205">Validação de fórmulas configuradas</span><span class="sxs-lookup"><span data-stu-id="2544e-205">Validation of configured formulas</span></span>

<span data-ttu-id="2544e-206">Na página **Designer de fórmulas**, selecione **Testar** para validar como a fórmula configurada funciona.</span><span class="sxs-lookup"><span data-stu-id="2544e-206">On the **Formula designer** page, select **Test** to validate how the configured formula works.</span></span>

<span data-ttu-id="2544e-207">[![Selecionar Testar para validar uma fórmula](./media/ER-FormulaTest-Start.png)](./media/ER-FormulaTest-Start.png)</span><span class="sxs-lookup"><span data-stu-id="2544e-207">[![Selecting Test to validate a forumula](./media/ER-FormulaTest-Start.png)](./media/ER-FormulaTest-Start.png)</span></span>

<span data-ttu-id="2544e-208">Quando os valores dos argumentos da fórmula forem necessários, você poderá abrir a caixa de diálogo **Testar expressão** na página **Designer de fórmulas**.</span><span class="sxs-lookup"><span data-stu-id="2544e-208">When the values of formula arguments are required, you can open the **Test expression** dialog box from the **Formula designer** page.</span></span> <span data-ttu-id="2544e-209">Na maioria dos casos, esses argumentos devem ser definidos manualmente, porque as associações configuradas não são executadas no momento do design.</span><span class="sxs-lookup"><span data-stu-id="2544e-209">In most cases, these arguments must be manually defined, because the configured bindings aren't run at design time.</span></span> <span data-ttu-id="2544e-210">A guia **Resultado do teste** na página **Designer de fórmulas** mostra o resultado da execução da fórmula configurada.</span><span class="sxs-lookup"><span data-stu-id="2544e-210">The **Test result** tab on the **Formula designer** page shows the result from execution of the configured formula.</span></span>

<span data-ttu-id="2544e-211">O exemplo a seguir mostra como você pode testar a fórmula configurada para o domínio de comércio exterior a fim de garantir que o código de mercadoria Intrastat contenha apenas dígitos.</span><span class="sxs-lookup"><span data-stu-id="2544e-211">The following example shows how you can test the formula that is configured for the foreign trade domain to make sure that the Intrastat commodity code contains only digits.</span></span>

<span data-ttu-id="2544e-212">Ao testar essa fórmula, você pode usar a caixa de diálogo **Testar expressão** para especificar o valor do código de mercadoria Intrastat para teste.</span><span class="sxs-lookup"><span data-stu-id="2544e-212">When you test this formula, you can use the **Test expression** dialog box to specify the value of the Intrastat commodity code for testing.</span></span>

<span data-ttu-id="2544e-213">[![Especificar o código de mercadoria Intrastat para teste](./media/ER-FormulaTest-Start-EnterArguments.png)](./media/ER-FormulaTest-Start-EnterArguments.png)</span><span class="sxs-lookup"><span data-stu-id="2544e-213">[![Specifying the Intrastat commodity code for testing](./media/ER-FormulaTest-Start-EnterArguments.png)](./media/ER-FormulaTest-Start-EnterArguments.png)</span></span>

<span data-ttu-id="2544e-214">Depois que você especificar o código de mercadoria Intrastat e selecionar **OK**, a guia **Resultado do teste** na página **Designer de fórmulas** mostrará o resultado da execução da fórmula configurada.</span><span class="sxs-lookup"><span data-stu-id="2544e-214">After you specify the Intrastat commodity code and select **OK**, the **Test result** tab on the **Formula designer** page shows the result of execution of the configured formula.</span></span> <span data-ttu-id="2544e-215">Em seguida, você poderá avaliar se o resultado é aceitável.</span><span class="sxs-lookup"><span data-stu-id="2544e-215">You can then evaluate whether the result is acceptable.</span></span> <span data-ttu-id="2544e-216">Se o resultado não for aceitável, você poderá atualizar a fórmula e testá-la novamente.</span><span class="sxs-lookup"><span data-stu-id="2544e-216">If the result isn't acceptable, you can update the formula and test it again.</span></span>

<span data-ttu-id="2544e-217">[![Resultado do teste](./media/ER-FormulaTest-Result.png)](./media/ER-FormulaTest-Result.png)</span><span class="sxs-lookup"><span data-stu-id="2544e-217">[![Test result](./media/ER-FormulaTest-Result.png)](./media/ER-FormulaTest-Result.png)</span></span>

<span data-ttu-id="2544e-218">Algumas fórmulas não podem ser testadas no momento do design.</span><span class="sxs-lookup"><span data-stu-id="2544e-218">Some formulas can't be tested at design time.</span></span> <span data-ttu-id="2544e-219">Por exemplo, uma fórmula pode retornar um resultado de um tipo de dados que não pode ser exibido na guia **Resultado do teste**. Neste caso, você receberá uma mensagem de erro informando que a fórmula não pode ser testada.</span><span class="sxs-lookup"><span data-stu-id="2544e-219">For example, a formula might return a result of a data type that can't be shown on the **Test result** tab. In this case, you receive an error message that states that the formula can't be tested.</span></span>

<span data-ttu-id="2544e-220">[![Mensagem de erro](./media/ER-FormulaTest-Error.png)](./media/ER-FormulaTest-Error.png)</span><span class="sxs-lookup"><span data-stu-id="2544e-220">[![Error message](./media/ER-FormulaTest-Error.png)](./media/ER-FormulaTest-Error.png)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="2544e-221">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="2544e-221">Additional resources</span></span>

- [<span data-ttu-id="2544e-222">Visão geral do Relatório Eletrônico</span><span class="sxs-lookup"><span data-stu-id="2544e-222">Electronic Reporting overview</span></span>](general-electronic-reporting.md)
- [<span data-ttu-id="2544e-223">Linguagem da fórmula de relatório eletrônico</span><span class="sxs-lookup"><span data-stu-id="2544e-223">Electronic reporting formula language</span></span>](er-formula-language.md)
