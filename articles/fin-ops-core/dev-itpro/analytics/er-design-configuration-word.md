---
title: Criar uma nova configuração de (ER) para gerar relatórios no formato Word
description: Este tópico explica como os usuários podem configurar um novo formato de relatório eletrônico (ER) para gerar relatórios como documentos do Microsoft Word.
author: NickSelin
ms.date: 12/17/2020
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner,  LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: Version 10.0.6
ms.openlocfilehash: 4885caf017fa0f9d36d293fa32aad53c21d3f162
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/31/2021
ms.locfileid: "5753567"
---
# <a name="design-a-new-er-configuration-to-generate-reports-in-word-format"></a><span data-ttu-id="f1270-103">Criar uma nova configuração de (ER) para gerar relatórios no formato Word</span><span class="sxs-lookup"><span data-stu-id="f1270-103">Design a new ER configuration to generate reports in Word format</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="f1270-104">Para gerar relatórios como documentos do Microsoft Word, você deve criar um modelo para os relatórios usando, por exemplo, o aplicativo da área de trabalho Word.</span><span class="sxs-lookup"><span data-stu-id="f1270-104">To generate reports as Microsoft Word documents, you must design a template for the reports by using, for example, the Word desktop application.</span></span> <span data-ttu-id="f1270-105">A ilustração a seguir mostra o modelo de exemplo para o relatório de controle que pode ser gerado para mostrar detalhes de pagamentos de fornecedor processados.</span><span class="sxs-lookup"><span data-stu-id="f1270-105">The following illustration shows the sample template for the control report that can be generated to show details of processed vendor payments.</span></span>

![Modelo de exemplo para o relatório de controle no aplicativo da área de trabalho Word](./media/er-design-configuration-word-image1.png)

<span data-ttu-id="f1270-107">Para usar um documento do Word como modelo para relatórios no formato Word, você pode configurar uma nova [solução](general-electronic-reporting.md) de [relatório eletrônico (ER)](er-quick-start1-new-solution.md).</span><span class="sxs-lookup"><span data-stu-id="f1270-107">To use a Word document as a template for reports in Word format, you can configure a new [Electronic reporting (ER)](general-electronic-reporting.md) [solution](er-quick-start1-new-solution.md).</span></span> <span data-ttu-id="f1270-108">Esta solução deve incluir uma [configuração de ER](general-electronic-reporting.md#Configuration) que contenha um componente de [formato](general-electronic-reporting.md#FormatComponentOutbound) de ER.</span><span class="sxs-lookup"><span data-stu-id="f1270-108">This solution must include an ER [configuration](general-electronic-reporting.md#Configuration) that contains an ER [format](general-electronic-reporting.md#FormatComponentOutbound) component.</span></span>

> [!NOTE]
> <span data-ttu-id="f1270-109">Ao criar uma nova configuração de formato de ER para gerar relatórios no formato Word, você deve selecionar **Word** como o tipo formato na caixa de diálogo de **Criar configuração** ou deixar o campo **Tipo de formato** em branco.</span><span class="sxs-lookup"><span data-stu-id="f1270-109">When you create a new ER format configuration to generate reports in Word format, you must either select **Word** as the format type in the **Create configuration** drop-down dialog box or leave the **Format type** field blank.</span></span>

![Criar uma configuração de formato na página Configurações](./media/er-design-configuration-word-image2.gif)

<span data-ttu-id="f1270-111">O componente de formato de ER da solução deve conter o elemento de formato **Excel\\File**, e esse elemento de formato deve estar vinculado ao documento do Word que será usado como modelo para relatórios gerados no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="f1270-111">The ER format component of the solution must contain the **Excel\\File** format element, and that format element must be linked to the Word document that will be used as the template for generated reports at runtime.</span></span> <span data-ttu-id="f1270-112">Para configurar o componente de formato de ER, é necessário abrir a versão de [rascunho](general-electronic-reporting.md#component-versioning) da configuração de ER criada no designer de formato de ER.</span><span class="sxs-lookup"><span data-stu-id="f1270-112">To configure the ER format component, you must open the [draft](general-electronic-reporting.md#component-versioning) version of the created ER configuration in the ER format designer.</span></span> <span data-ttu-id="f1270-113">Em seguida, adicione o elemento **Excel\\File**, anexe seu modelo do Word ao formato de ER editável e vincule esse modelo ao elemento **Excel\\File** que você adicionou.</span><span class="sxs-lookup"><span data-stu-id="f1270-113">Then add the **Excel\\File** element, attach your Word template to the editable ER format, and link that template to the **Excel\\File** element that you added.</span></span>

> [!NOTE]
> <span data-ttu-id="f1270-114">Ao anexar um modelo, você deve usar um [tipo de documento](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) que tenha sido [configurado](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) nos parâmetros de ER para armazenar modelos de formatos de ER.</span><span class="sxs-lookup"><span data-stu-id="f1270-114">When you attach a template, you must use a [document type](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) that has previously been [configured](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents) in the ER parameters to store templates of ER formats.</span></span>

![Anexar um modelo na página Designer de formato](./media/er-design-configuration-word-image3.gif)

<span data-ttu-id="f1270-116">Você pode adicionar os elementos aninhados **Excel\\Range** e **Excel\\Cell** para o elemento **Excel\\File** para especificar a estrutura dos dados que serão inseridos nos relatórios gerados no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="f1270-116">You can add **Excel\\Range** and **Excel\\Cell** nested elements for the **Excel\\File** element to specify the structure of data that will be entered in generated reports at runtime.</span></span> <span data-ttu-id="f1270-117">Em seguida, você deve vincular esses elementos a fontes de dados do formato de ER editável para especificar os dados reais que serão inseridos nos relatórios gerados no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="f1270-117">You must then bind those elements to data sources of the editable ER format to specify the actual data that will be entered in generated reports at runtime.</span></span>

![Adicionar elemento aninhados na página Designer de formato](./media/er-design-configuration-word-image4.gif)

<span data-ttu-id="f1270-119">Quando você salva as alterações no formato de ER no momento da criação, a estrutura de formato hierárquico é armazenada no modelo do Word anexado como uma [parte XML personalizada](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) que é denominada **Relatório**.</span><span class="sxs-lookup"><span data-stu-id="f1270-119">When you save your changes to the ER format at design time, the hierarchical format structure is stored in the attached Word template as a [custom XML part](https://docs.microsoft.com/visualstudio/vsto/custom-xml-parts-overview?view=vs-2019) that is named **Report**.</span></span> <span data-ttu-id="f1270-120">Você deve acessar o modelo modificado, baixá-lo no Finance, armazená-lo localmente e abri-lo no aplicativo da área de trabalho Word.</span><span class="sxs-lookup"><span data-stu-id="f1270-120">You must access the modified template, download it from Finance, store it locally, and open it in the Word desktop application.</span></span> <span data-ttu-id="f1270-121">A ilustração a seguir mostra o modelo de exemplo armazenado localmente para o relatório de controle que contém a parte XML personalizada **Relatório**.</span><span class="sxs-lookup"><span data-stu-id="f1270-121">The following illustration shows the locally stored sample template for the control report that contains the **Report** custom XML part.</span></span>

![Pré-visualizar o modelo de exemplo de relatório no aplicativo da área de trabalho Word](./media/er-design-configuration-word-image5.gif)

<span data-ttu-id="f1270-123">Quando as associações dos elementos de formato **Excel\\Range** e **Excel\\Cell** são executadas no tempo de execução, todas as associações fornecem dados no documento gerado do Word como um campo individual da parte XML personalizada do **Relatório**.</span><span class="sxs-lookup"><span data-stu-id="f1270-123">When bindings of **Excel\\Range** and **Excel\\Cell** format elements are run at runtime, the data that every binding delivers comes into the generated Word document as an individual field of the **Report** custom XML part.</span></span> <span data-ttu-id="f1270-124">Para inserir os valores dos campos da parte XML personalizada em um documento gerado, você deve adicionar os [controles de conteúdo](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) adequados do Word ao modelo do Word para servir como espaços reservados para dados que serão preenchidos no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="f1270-124">To enter the values from the fields of the custom XML part in a generated document, you must add the appropriate Word [content controls](https://docs.microsoft.com/office/client-developer/word/content-controls-in-word) to your Word template to serve as placeholders for data that will be filled in at runtime.</span></span> <span data-ttu-id="f1270-125">Para especificar como os controles de conteúdo são preenchidos, mapeie cada controle de conteúdo para o campo apropriado da parte XML personalizada **Relatório**.</span><span class="sxs-lookup"><span data-stu-id="f1270-125">To specify how content controls are filled in, map every content control to the appropriate field of the **Report** custom XML part.</span></span>

![Adicionar e mapear controles de conteúdo no aplicativo da área de trabalho Word](./media/er-design-configuration-word-image6.gif)

<span data-ttu-id="f1270-127">Em seguida, você deve substituir o modelo original do Word do formato de ER editável pelo modelo modificado que agora contém os controles de conteúdo do Word que foram mapeados para os campos da parte XML personalizada **Relatório**.</span><span class="sxs-lookup"><span data-stu-id="f1270-127">You must then replace the original Word template of the editable ER format with the modified template that now contains Word content controls that were mapped to the fields of the **Report** custom XML part.</span></span>

![Substituir o modelo na página Designer de formato](./media/er-design-configuration-word-image7.gif)

<span data-ttu-id="f1270-129">Quando você executa o formato de ER configurado, o modelo anexado do Word é usado para gerar um novo relatório.</span><span class="sxs-lookup"><span data-stu-id="f1270-129">When you run the configured ER format, the attached Word template is used to generate a new report.</span></span> <span data-ttu-id="f1270-130">Os dados reais são armazenados no relatório do Word como uma parte XML personalizada que é denominada **Relatório**.</span><span class="sxs-lookup"><span data-stu-id="f1270-130">The actual data is stored in the Word report as a custom XML part that is named **Report**.</span></span> <span data-ttu-id="f1270-131">Quando o relatório gerado é aberto, os controles de conteúdo do Word são preenchidos com dados da parte XML personalizada **Relatório**.</span><span class="sxs-lookup"><span data-stu-id="f1270-131">When the generated report is opened, the Word content controls are filled in with data from the **Report** custom XML part.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="f1270-132">Perguntas frequentes</span><span class="sxs-lookup"><span data-stu-id="f1270-132">Frequently asked questions</span></span>

<span data-ttu-id="f1270-133">**Pergunta:** configurei um formato de ER para imprimir um documento do Word que contém um endereço da empresa.</span><span class="sxs-lookup"><span data-stu-id="f1270-133">**Question:** I configured an ER format to print a Word document that contains a company address.</span></span> <span data-ttu-id="f1270-134">No modelo do Word para esse formato de ER, inseri um controle de conteúdo de rich text para apresentar um endereço da empresa.</span><span class="sxs-lookup"><span data-stu-id="f1270-134">In the Word template for this ER format, I inserted a rich text content control to present a company address.</span></span> <span data-ttu-id="f1270-135">No Finance, inseri o endereço da empresa como texto de várias linhas e selecionei **Enter** para adicionar um retorno de carro a cada linha inserida.</span><span class="sxs-lookup"><span data-stu-id="f1270-135">In Finance, I entered the company address as multiline text and selected **Enter** to add a carriage return for every line that I entered.</span></span> <span data-ttu-id="f1270-136">Portanto, quero que o endereço da empresa apareça como texto de várias linhas nos documentos gerados.</span><span class="sxs-lookup"><span data-stu-id="f1270-136">Therefore, I expect the company address to appear as multiline text in generated documents.</span></span> <span data-ttu-id="f1270-137">No entanto, o endereço aparece como uma única linha de texto que contém símbolos especiais, em vez de retornos de carro.</span><span class="sxs-lookup"><span data-stu-id="f1270-137">However, the address appears as a single line of text that contains special symbols instead of carriage returns.</span></span> <span data-ttu-id="f1270-138">O que há de errado nas minhas configurações?</span><span class="sxs-lookup"><span data-stu-id="f1270-138">What is wrong with my settings?</span></span>

<span data-ttu-id="f1270-139">**Resposta:** em vez de usar um controle de conteúdo de rich text, você deve usar um controle de conteúdo de texto simples e marcar a caixa de seleção **Permitir retornos de carro (vários parágrafos)** nas propriedades do controle.</span><span class="sxs-lookup"><span data-stu-id="f1270-139">**Answer:** Instead of using a rich text content control, you must use a plain text content control and select the **Allow carriage returns (multiple paragraphs)** check box in the control's properties.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="f1270-140">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="f1270-140">Additional resources</span></span>

- [<span data-ttu-id="f1270-141">Reutilizar configurações de ER com modelos do Excel para gerar relatórios no formatos Word</span><span class="sxs-lookup"><span data-stu-id="f1270-141">Reuse ER configurations with Excel templates to generate reports in Word format</span></span>](./tasks/er-design-configuration-word-2016-11.md)
- [<span data-ttu-id="f1270-142">Inserir imagens e formas em documentos que você gerar usando ER</span><span class="sxs-lookup"><span data-stu-id="f1270-142">Embed images and shapes in documents that you generate by using ER</span></span>](electronic-reporting-embed-images-shapes.md#embed-an-image-in-a-word-document)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]