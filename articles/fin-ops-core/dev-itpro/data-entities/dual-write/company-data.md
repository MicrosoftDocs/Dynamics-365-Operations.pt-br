---
title: Conceito de empresa no Dataverse
description: Este tópico descreve a integração de dados de empresa entre o Finance and Operations e o Dataverse.
author: RamaKrishnamoorthy
manager: AnnBe
ms.date: 08/04/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ''
audience: Application User, IT Pro
ms.reviewer: rhaertle
ms.custom: ''
ms.assetid: ''
ms.search.region: global
ms.search.industry: ''
ms.author: ramasri
ms.dyn365.ops.version: ''
ms.search.validFrom: 2019-07-15
ms.openlocfilehash: bbe634b87b3cb30ed993f9b3afeb4321d70f07e6
ms.sourcegitcommit: 7e1be696894731e1c58074d9b5e9c5b3acf7e52a
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/17/2020
ms.locfileid: "4744870"
---
# <a name="company-concept-in-dataverse"></a><span data-ttu-id="bfb88-103">Conceito de empresa no Dataverse</span><span class="sxs-lookup"><span data-stu-id="bfb88-103">Company concept in Dataverse</span></span>

[!include [banner](../../includes/banner.md)]

[!include [rename-banner](~/includes/cc-data-platform-banner.md)]


<span data-ttu-id="bfb88-104">No Finance and Operations, o conceito de *empresa* é uma construção legal e uma construção comercial.</span><span class="sxs-lookup"><span data-stu-id="bfb88-104">In Finance and Operations, the concept of a *company* is both a legal construct and a business construct.</span></span> <span data-ttu-id="bfb88-105">Ele também é um limite de segurança e de visibilidade de dados.</span><span class="sxs-lookup"><span data-stu-id="bfb88-105">It's also a security and visibility boundary for data.</span></span> <span data-ttu-id="bfb88-106">Os usuários trabalham sempre no contexto de uma única empresa e a maioria dos dados são distribuídos por empresa.</span><span class="sxs-lookup"><span data-stu-id="bfb88-106">Users always work in the context of a single company, and most of the data is striped by company.</span></span>

<span data-ttu-id="bfb88-107">O Dataverse não tem um conceito equivalente.</span><span class="sxs-lookup"><span data-stu-id="bfb88-107">Dataverse doesn't have an equivalent concept.</span></span> <span data-ttu-id="bfb88-108">O conceito mais próximo é *unidade de negócios*, que é basicamente um limite de segurança e de visibilidade para dados de usuário.</span><span class="sxs-lookup"><span data-stu-id="bfb88-108">The closest concept is *business unit*, which is primarily a security and visibility boundary for user data.</span></span> <span data-ttu-id="bfb88-109">Esse conceito não tem as mesmas implicações legais ou comerciais que o conceito de empresa.</span><span class="sxs-lookup"><span data-stu-id="bfb88-109">This concept doesn't have the same legal or business implications as the company concept.</span></span>

<span data-ttu-id="bfb88-110">Como a unidade de negócios e a empresa não são conceitos equivalentes, não é possível forçar um mapeamento linear (1:1) entre elas com a finalidade de integração do Dataverse.</span><span class="sxs-lookup"><span data-stu-id="bfb88-110">Because business unit and company aren't equivalent concepts, it isn't possible to force a one-to-one (1:1) mapping between them for the purpose of Dataverse integration.</span></span> <span data-ttu-id="bfb88-111">Porém, como os usuários devem, por padrão, ser capazes de ver as mesmas linhas no aplicativo e no Dataverse, a Microsoft apresentou uma nova tabela no Dataverse, chamada cdm\_Company.</span><span class="sxs-lookup"><span data-stu-id="bfb88-111">However, because users must, by default, be able to see the same rows in the application and Dataverse, Microsoft has introduced a new table in Dataverse that is named cdm\_Company.</span></span> <span data-ttu-id="bfb88-112">Essa tabela é equivalente à tabela Empresa no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bfb88-112">This table is equivalent to the Company table in the application.</span></span> <span data-ttu-id="bfb88-113">Para ajudar a garantir que a visibilidade das linhas seja imediatamente equivalente entre o aplicativo e o Dataverse, recomendamos a seguinte configuração para dados no Dataverse:</span><span class="sxs-lookup"><span data-stu-id="bfb88-113">To help guarantee that visibility of rows is equivalent between the application and Dataverse out of the box, we recommend the following setup for data in Dataverse:</span></span>

+ <span data-ttu-id="bfb88-114">Para cada linha de empresa do Finance and Operations habilitado para gravação dupla, é criada uma linha cdm\_Company associada.</span><span class="sxs-lookup"><span data-stu-id="bfb88-114">For each Finance and Operations Company row that is enabled for dual-write, an associated cdm\_Company row is created.</span></span>
+ <span data-ttu-id="bfb88-115">Quando uma linha cdm\_Company é criada e habilitada para gravação dupla, uma unidade de negócios padrão é criada com o mesmo nome.</span><span class="sxs-lookup"><span data-stu-id="bfb88-115">When a cdm\_Company row is created and enabled for dual-write, a default business unit is created that has the same name.</span></span> <span data-ttu-id="bfb88-116">Embora uma equipe padrão seja criada automaticamente para essa unidade de negócios, a unidade de negócios não é usada.</span><span class="sxs-lookup"><span data-stu-id="bfb88-116">Although a default team is automatically created for that business unit, the business unit isn't used.</span></span>
+ <span data-ttu-id="bfb88-117">Uma equipe de proprietário separada é criada com o mesmo nome.</span><span class="sxs-lookup"><span data-stu-id="bfb88-117">A separate owner team is created that has the same name.</span></span> <span data-ttu-id="bfb88-118">Ela também é associada à unidade de negócios.</span><span class="sxs-lookup"><span data-stu-id="bfb88-118">It's also associated with the business unit.</span></span>
+ <span data-ttu-id="bfb88-119">Por padrão, o proprietário de qualquer linha criada e com gravação dupla no Dataverse é definido para a equipe "Proprietário DW" vinculada à unidade de negócios associada.</span><span class="sxs-lookup"><span data-stu-id="bfb88-119">By default, the owner of any row that is created and dual-written to Dataverse is set to the "DW Owner" team that is linked to the associated business unit.</span></span>

<span data-ttu-id="bfb88-120">A ilustração a seguir mostra um exemplo dessa configuração de dados no Dataverse.</span><span class="sxs-lookup"><span data-stu-id="bfb88-120">The following illustration shows an example of this data setup in Dataverse.</span></span>

![Configuração de dados no Dataverse](media/dual-write-company-1.png)

<span data-ttu-id="bfb88-122">Devido a essa configuração, qualquer linha relacionada à empresa USMF será propriedade de uma equipe que é vinculada à unidade de negócios USMF no Dataverse.</span><span class="sxs-lookup"><span data-stu-id="bfb88-122">Because of this configuration, any row that is related to the USMF company will be owned by a team that is linked to the USMF business unit in Dataverse.</span></span> <span data-ttu-id="bfb88-123">Portanto, qualquer usuário que tenha acesso a essa unidade de negócios com uma função de segurança que é definida para visibilidade em nível de unidade de negócios agora pode consultar essas linhas.</span><span class="sxs-lookup"><span data-stu-id="bfb88-123">Therefore, any user who has access to that business unit through a security role that is set to business unit–level visibility can now see those rows.</span></span> <span data-ttu-id="bfb88-124">O exemplo a seguir mostra como as equipes podem ser usadas para oferecer o acesso correto a essas linhas.</span><span class="sxs-lookup"><span data-stu-id="bfb88-124">The following example shows how teams can be used to provide the correct access to those rows.</span></span>

+ <span data-ttu-id="bfb88-125">A função "gerente de vendas" é atribuída aos membros da equipe de "Vendas USMF".</span><span class="sxs-lookup"><span data-stu-id="bfb88-125">The "Sales Manager" role is assigned to members of the "USMF Sales" team.</span></span>
+ <span data-ttu-id="bfb88-126">Os usuários com a função "Gerente de vendas" podem acessar quaisquer linhas da conta que seja membro da mesma unidade de negócios de que são membros.</span><span class="sxs-lookup"><span data-stu-id="bfb88-126">Users who have the "Sales Manager" role can access any account rows that are members of the same business unit that they are members of.</span></span>
+ <span data-ttu-id="bfb88-127">A equipe "Vendas USMF" está vinculada à unidade de negócios de USMF citada anteriormente.</span><span class="sxs-lookup"><span data-stu-id="bfb88-127">The "USMF Sales" team is linked to the USMF business unit that was mentioned earlier.</span></span>
+ <span data-ttu-id="bfb88-128">Assim, os membros da equipe "Vendas USMF" podem ver qualquer conta de propriedade do usuário "USMF DW", que viria da tabela Empresa USMF no Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="bfb88-128">Therefore, members of the "USMF Sales" team can see any account that is owned by the "USMF DW" user, which would have come from the USMF Company table in Finance and Operations.</span></span>

![Como as equipes podem ser usadas](media/dual-write-company-2.png)

<span data-ttu-id="bfb88-130">Conforme mostrado na ilustração anterior, este mapeamento 1:1 entre unidade de negócios, empresa e equipe é apenas um ponto de partida.</span><span class="sxs-lookup"><span data-stu-id="bfb88-130">As the preceding illustration shows, this 1:1 mapping between business unit, company, and team is just a starting point.</span></span> <span data-ttu-id="bfb88-131">Neste exemplo, uma nova unidade de negócios “Europa” é criada manualmente no Dataverse como o pai de DEMF e ESMF.</span><span class="sxs-lookup"><span data-stu-id="bfb88-131">In this example, a new "Europe" business unit is manually created in Dataverse as the parent for both DEMF and ESMF.</span></span> <span data-ttu-id="bfb88-132">Essa nova unidade de negócios raiz não está relacionada à gravação dupla.</span><span class="sxs-lookup"><span data-stu-id="bfb88-132">This new root business unit is unrelated to dual-write.</span></span> <span data-ttu-id="bfb88-133">No entanto, ela pode ser usada para dar aos membros da equipe de "Vendas BRL" acesso à dados de conta em DEMF e ESMF, definindo a visibilidade de dados como **BU pai/filho** na função de segurança associada.</span><span class="sxs-lookup"><span data-stu-id="bfb88-133">However, it can be used to give members of the "EUR Sales" team access to account data in both DEMF and ESMF by setting the data visibility to **Parent/Child BU** in the associated security role.</span></span>

<span data-ttu-id="bfb88-134">Um tópico final para discutir é como a gravação dupla determina à qual equipe proprietária deve-se atribuir linhas.</span><span class="sxs-lookup"><span data-stu-id="bfb88-134">A final topic to discuss is how dual-write determines which owner team it should assign rows to.</span></span> <span data-ttu-id="bfb88-135">Esse comportamento é controlado pela coluna **Equipe proprietária padrão** da linha cdm\_Company.</span><span class="sxs-lookup"><span data-stu-id="bfb88-135">This behavior is controlled by the **Default owning team** column on the cdm\_Company row.</span></span> <span data-ttu-id="bfb88-136">Quando uma linha cdm\_Company estiver habilitada para gravação dupla, um plug-in criará automaticamente a unidade de negócios associada e a equipe proprietária (se ainda não existir) e definirá a coluna **Equipe proprietária padrão**.</span><span class="sxs-lookup"><span data-stu-id="bfb88-136">When a cdm\_Company row is enabled for dual-write, a plug-in automatically creates the associated business unit and owner team (if it doesn't already exist), and sets the **Default owning team** column.</span></span> <span data-ttu-id="bfb88-137">O administrador pode alterar esta coluna para um valor diferente.</span><span class="sxs-lookup"><span data-stu-id="bfb88-137">The admin can change this column to a different value.</span></span> <span data-ttu-id="bfb88-138">No entanto, o administrador não pode desmarcar a coluna desde se a tabela estiver habilitada para gravação dupla.</span><span class="sxs-lookup"><span data-stu-id="bfb88-138">However, the admin can't clear the column as long as the table is enabled for dual-write.</span></span>

> [!div class="mx-imgBorder"]
<span data-ttu-id="bfb88-139">![Coluna da equipe proprietária padrão](media/dual-write-default-owning-team.jpg)</span><span class="sxs-lookup"><span data-stu-id="bfb88-139">![Default owning team column](media/dual-write-default-owning-team.jpg)</span></span>

## <a name="company-striping-and-bootstrapping"></a><span data-ttu-id="bfb88-140">Divisão e inicialização de empresa</span><span class="sxs-lookup"><span data-stu-id="bfb88-140">Company striping and bootstrapping</span></span>

<span data-ttu-id="bfb88-141">A integração do Dataverse faz a paridade empresarial usando um identificador empresarial aos dados de tarja.</span><span class="sxs-lookup"><span data-stu-id="bfb88-141">Dataverse integration brings company parity by using a company identifier to stripe data.</span></span> <span data-ttu-id="bfb88-142">Como a ilustração a seguir mostra, todas as tabelas específicas estão estendidas de forma que têm uma relação vários para um (N:1) com a tabela cdm\_Company.</span><span class="sxs-lookup"><span data-stu-id="bfb88-142">As the following illustration shows, all company-specific tables are extended so that they have a many-to-one (N:1) relationship with the cdm\_Company table.</span></span>

> [!div class="mx-imgBorder"]
<span data-ttu-id="bfb88-143">![A relação N:1 entre uma tabela específica de empresa e a tabela cdm_Company](media/dual-write-bootstrapping.png)</span><span class="sxs-lookup"><span data-stu-id="bfb88-143">![N:1 relationship between a company-specific table and the cdm_Company table](media/dual-write-bootstrapping.png)</span></span>

+ <span data-ttu-id="bfb88-144">Para linhas, depois que uma empresa é adicionada e salva, torna-se o valor somente leitura.</span><span class="sxs-lookup"><span data-stu-id="bfb88-144">For rows, after a company is added and saved, the value becomes read-only.</span></span> <span data-ttu-id="bfb88-145">Portanto, os usuários devem garantir selecionam a empresa correta.</span><span class="sxs-lookup"><span data-stu-id="bfb88-145">Therefore, users should make sure that they select the correct company.</span></span>
+ <span data-ttu-id="bfb88-146">Somente linhas com dados da empresa estão qualificados para gravação dupla entre o aplicativo e o Dataverse.</span><span class="sxs-lookup"><span data-stu-id="bfb88-146">Only rows that have company data are eligible for dual-write between the application and Dataverse.</span></span>
+ <span data-ttu-id="bfb88-147">Para dados existentes do Dataverse, uma experiência de inicialização conduzida pelo administrador logo estará disponível.</span><span class="sxs-lookup"><span data-stu-id="bfb88-147">For existing Dataverse data, an admin-led bootstrapping experience will soon be available.</span></span>


## <a name="autopopulate-company-name-in-customer-engagement-apps"></a><span data-ttu-id="bfb88-148">Preencher automaticamente o nome da empresa nos aplicativos de participação do cliente</span><span class="sxs-lookup"><span data-stu-id="bfb88-148">Autopopulate company name in customer engagement apps</span></span>

<span data-ttu-id="bfb88-149">Há várias maneiras de preencher automaticamente o nome da empresa nos aplicativos de participação do cliente.</span><span class="sxs-lookup"><span data-stu-id="bfb88-149">There are several ways to auto-populate the company name in customer engagement apps.</span></span>

+ <span data-ttu-id="bfb88-150">Se você for um administrador de sistema, poderá definir a empresa padrão navegando até **Configurações Avançadas > Sistema > Segurança > Usuários**.</span><span class="sxs-lookup"><span data-stu-id="bfb88-150">If you are a system administrator, you can set the default company by navigating to **Advanced Settings > System > Security > Users**.</span></span> <span data-ttu-id="bfb88-151">Abra o formulário **Usuário** e na seção **Informações sobre a Organização**, defina o valor **Empresa como padrão nos Formulários**.</span><span class="sxs-lookup"><span data-stu-id="bfb88-151">Open the **User** form, and in the **Organization Information** section, set the **Company to default on Forms** value.</span></span>

    :::image type="content" source="media/autopopulate-company-name-1.png" alt-text="Definir a empresa padrão na seção Informações da Organização.":::

+ <span data-ttu-id="bfb88-153">Se tiver acesso de **Gravação** para a tabela **SystemUser** para o nível **Unidade de Negócio**, você poderá alterar a empresa padrão em qualquer formulário, selecionando a empresa do menu suspenso **Empresa**.</span><span class="sxs-lookup"><span data-stu-id="bfb88-153">If you have **Write** access to the **SystemUser** table for the **Business Unit** level, then you can change the default company on any form by selecting a company from the **Company** drop-down menu.</span></span>

    :::image type="content" source="media/autopopulate-company-name-2.png" alt-text="Alterar o nome da empresa em uma nova conta.":::

+ <span data-ttu-id="bfb88-155">Se tiver o acesso de **Gravação** para dados em mais de uma empresa, então você pode alterar a empresa padrão, escolhendo uma linhas que pertence a outra empresa.</span><span class="sxs-lookup"><span data-stu-id="bfb88-155">If you have **Write** access to data in more than one company, then you can change the default company by choosing a row that belongs to different company.</span></span>

    :::image type="content" source="media/autopopulate-company-name-3.png" alt-text="A escolha de uma linha altera a empresa padrão.":::

+ <span data-ttu-id="bfb88-157">Se você for um configurador de sistema ou administrador e quiser preencher automaticamente os dados da empresa em um formulário personalizado, poderá usar os [eventos do formulário](https://docs.microsoft.com/powerapps/developer/model-driven-apps/clientapi/events-forms-grids).</span><span class="sxs-lookup"><span data-stu-id="bfb88-157">If you are a system configurator or administrator, and you want to auto-populate company data on a custom form, then you can use [form events](https://docs.microsoft.com/powerapps/developer/model-driven-apps/clientapi/events-forms-grids).</span></span> <span data-ttu-id="bfb88-158">Adicione uma referência JavaScript ao **msdyn_/DefaultCompany.js** e use os eventos a seguir.</span><span class="sxs-lookup"><span data-stu-id="bfb88-158">Add a JavaScript reference to **msdyn_/DefaultCompany.js** and use the following events.</span></span> <span data-ttu-id="bfb88-159">Você pode usar qualquer formulário predefinido, por exemplo, o formulário **Conta**.</span><span class="sxs-lookup"><span data-stu-id="bfb88-159">You can use any out-of-the-box form, for example, the **Account** form.</span></span>

    + <span data-ttu-id="bfb88-160">Evento **OnLoad** do formulário: Defina a coluna **defaultCompany**.</span><span class="sxs-lookup"><span data-stu-id="bfb88-160">**OnLoad** event for the form: Set the **defaultCompany** column.</span></span>
    + <span data-ttu-id="bfb88-161">Evento **OnChange** para a coluna **Empresa**: defina a coluna **updateDefaultCompany**.</span><span class="sxs-lookup"><span data-stu-id="bfb88-161">**OnChange** event for the **Company** column: Set the **updateDefaultCompany** column.</span></span>

## <a name="apply-filtering-based-on-the-company-context"></a><span data-ttu-id="bfb88-162">Aplicar filtrar com base no contexto da empresa</span><span class="sxs-lookup"><span data-stu-id="bfb88-162">Apply filtering based on the company context</span></span>

<span data-ttu-id="bfb88-163">Para aplicar filtragem com base no contexto da empresa nos formulários personalizados ou em colunas de pesquisa personalizados adicionados aos formulários padrão, abra o formulário e use a seção **Filtragem de Registros Relacionados** para aplicar o filtro da empresa.</span><span class="sxs-lookup"><span data-stu-id="bfb88-163">To apply filtering based on the company context on your custom forms or on custom lookup columns added to the standard forms, open the form and use the **Related Records Filtering** section to apply the company filter.</span></span> <span data-ttu-id="bfb88-164">Você deve definir isso para cada coluna de pesquisa que exija filtragem com base na empresa subjacente em uma determinada linha.</span><span class="sxs-lookup"><span data-stu-id="bfb88-164">You must set this for each lookup column that requires filtering based on the underlying company on a given row.</span></span> <span data-ttu-id="bfb88-165">A configuração é mostrada para a **Conta** na ilustração a seguir.</span><span class="sxs-lookup"><span data-stu-id="bfb88-165">The setting is shown for **Account** in the following illustration.</span></span>

:::image type="content" source="media/apply-company-context.png" alt-text="Aplicar contexto da empresa":::

