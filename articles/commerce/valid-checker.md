---
title: Verificador de consistência das transações de varejo
description: Este tópico descreve a funcionalidade do verificador de consistência das transações no Dynamics 365 Commerce.
author: josaw1
manager: AnnBe
ms.date: 10/14/2019
ms.topic: index-page
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2019-01-15
ms.dyn365.ops.version: 10
ms.openlocfilehash: 3da8bdf6feb932e074680b6cb80e1b7b71f9a82b
ms.sourcegitcommit: 81a647904dd305c4be2e4b683689f128548a872d
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/01/2020
ms.locfileid: "3004242"
---
# <a name="retail-transaction-consistency-checker"></a><span data-ttu-id="b742b-103">Verificador de consistência das transações de varejo</span><span class="sxs-lookup"><span data-stu-id="b742b-103">Retail transaction consistency checker</span></span>


[!include [banner](includes/banner.md)]
[!include [preview banner](includes/preview-banner.md)]

<span data-ttu-id="b742b-104">Este tópico descreve a funcionalidade do verificador de consistência das transações no Microsoft Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="b742b-104">This topic describes the transaction consistency checker functionality in Microsoft Dynamics 365 Commerce.</span></span> <span data-ttu-id="b742b-105">O verificador de consistência identifica e isola as transações inconsistentes antes que elas sejam coletadas pelo processo de lançamento de demonstrativo.</span><span class="sxs-lookup"><span data-stu-id="b742b-105">The consistency checker identifies and isolates inconsistent transactions before they are picked up by the statement posting process.</span></span>

<span data-ttu-id="b742b-106">Quando um demonstrativo é lançado, pode haver falha no lançamento devido a dados inconsistentes nas tabelas de transações de comércio.</span><span class="sxs-lookup"><span data-stu-id="b742b-106">When a statement is posted, posting can fail due to inconsistent data in the commerce transaction tables.</span></span> <span data-ttu-id="b742b-107">O problema nos dados pode ser causado por imprevistos no aplicativo de ponto de venda (PDV) ou pela importação incorreta das transações de sistemas POS de terceiros.</span><span class="sxs-lookup"><span data-stu-id="b742b-107">The data issue may be caused by unforeseen issues in the point of sale (POS) application, or if transactions were incorrectly imported from third-party POS systems.</span></span> <span data-ttu-id="b742b-108">Exemplos de como essas inconsistências podem ser exibidas:</span><span class="sxs-lookup"><span data-stu-id="b742b-108">Examples of how these inconsistencies may appear include:</span></span> 

- <span data-ttu-id="b742b-109">O total da transação na tabela do cabeçalho não corresponde ao total da transação nas linhas.</span><span class="sxs-lookup"><span data-stu-id="b742b-109">The transaction total on the header table does not match the transaction total on the lines.</span></span>
- <span data-ttu-id="b742b-110">A contagem de linhas na tabela do cabeçalho não corresponde ao número de linhas na tabela de transações.</span><span class="sxs-lookup"><span data-stu-id="b742b-110">The line count on the header table does not match with the number of lines in the transaction table.</span></span>
- <span data-ttu-id="b742b-111">Os impostos na tabela do cabeçalho não correspondem ao valor do imposto nas linhas.</span><span class="sxs-lookup"><span data-stu-id="b742b-111">Taxes on the header table do not match the tax amount on the lines.</span></span> 

<span data-ttu-id="b742b-112">Quando transações inconsistentes são coletadas pelo processo de lançamento de demonstrativo, diários de pagamentos e faturas de vendas inconsistentes são criados e, consequentemente, o processo inteiro falha.</span><span class="sxs-lookup"><span data-stu-id="b742b-112">When inconsistent transactions are picked up by the statement posting process, inconsistent sales invoices and payment journals are created, and the entire statement posting process fails as a result.</span></span> <span data-ttu-id="b742b-113">Recuperar os demonstrativos desse estado envolve correções complexas de dados em várias tabelas de transações.</span><span class="sxs-lookup"><span data-stu-id="b742b-113">Recovering the statements from such a state involves complex data fixes across multiple transaction tables.</span></span> <span data-ttu-id="b742b-114">O verificador de consistência das transações evita esses problemas.</span><span class="sxs-lookup"><span data-stu-id="b742b-114">The transaction consistency checker prevents such issues.</span></span>

<span data-ttu-id="b742b-115">O gráfico a seguir ilustra o processo de lançamento com o verificador de consistência das transações.</span><span class="sxs-lookup"><span data-stu-id="b742b-115">The following chart illustrates the posting process with the transaction consistency checker.</span></span>

<span data-ttu-id="b742b-116">![Processo de lançamento do demonstrativo com verificador de consistência de transação](./media/validchecker.png "Processo de lançamento do demonstrativo com verificador de consistência de transação de varejo")</span><span class="sxs-lookup"><span data-stu-id="b742b-116">![Statement posting process with transaction consistency checker](./media/validchecker.png "Statement posting process with retail transaction consistency checker")</span></span>

<span data-ttu-id="b742b-117">O processo em lote **Validar transações de loja** verifica a consistência das tabelas de transações de comércio para os cenários a seguir.</span><span class="sxs-lookup"><span data-stu-id="b742b-117">The **Validate store transactions** batch process checks the consistency of the commerce transaction tables for the following scenarios.</span></span>

- <span data-ttu-id="b742b-118">**Conta de cliente** - valida se a conta de cliente nas tabelas de transações de varejo existe no cliente mestre da matriz.</span><span class="sxs-lookup"><span data-stu-id="b742b-118">**Customer account** – Validates that the customer account in the transaction tables exists in the HQ customer master.</span></span>
- <span data-ttu-id="b742b-119">**Contagem de linhas** - valida se o número de linhas, como capturado na tabela de cabeçalho de transações, corresponde ao número de linhas nas tabelas de transações de vendas.</span><span class="sxs-lookup"><span data-stu-id="b742b-119">**Line count** – Validates that the number of lines, as captured on the transaction header table, matches the number of lines in the sales transaction tables.</span></span>
- <span data-ttu-id="b742b-120">**Preço incluindo imposto** — valida se o parâmetro **Preço incluindo imposto** é consistente nas linhas de transação.</span><span class="sxs-lookup"><span data-stu-id="b742b-120">**Price includes tax** – Validates that the **Price includes tax** parameter is consistent across transaction lines.</span></span>
- <span data-ttu-id="b742b-121">**Valor do pagamento** — valida se os registros de pagamento corresponderem ao valor do pagamento no cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="b742b-121">**Payment amount** - Validates that the payment records match the payment amount on header.</span></span>
- <span data-ttu-id="b742b-122">**Valor bruto** — valida se o valor bruto no cabeçalho é a soma dos valores líquidos nas linhas mais o valor do imposto.</span><span class="sxs-lookup"><span data-stu-id="b742b-122">**Gross amount** – Validates that the gross amount on the header is the sum of the net amounts on the lines plus the tax amount.</span></span>
- <span data-ttu-id="b742b-123">**Valor líquido** — valida se o valor líquido no cabeçalho é a soma dos valores líquidos nas linhas mais o valor do imposto.</span><span class="sxs-lookup"><span data-stu-id="b742b-123">**Net amount** – Validates that the net amount on the header is the sum of the net amounts on the lines.</span></span>
- <span data-ttu-id="b742b-124">**Pagamento a maior/a menor** — valida se a diferença entre o valor bruto no cabeçalho e o valor do pagamento não excede a configuração de pagamento maior/a menor máximo.</span><span class="sxs-lookup"><span data-stu-id="b742b-124">**Under / Over payment** – Validates that the difference between the gross amount on the header and the payment amount doesn't exceed the maximum underpayment/overpayment configuration.</span></span>
- <span data-ttu-id="b742b-125">**Valor de desconto** - valida se o valor de desconto nas tabelas do desconto e o valor de desconto na linha das tabelas de transações são consistentes, e se o valor de desconto no cabeçalho é a soma dos valores dos descontos nas linhas.</span><span class="sxs-lookup"><span data-stu-id="b742b-125">**Discount amount** – Validates that the discount amount on the discount tables and the discount amount on the transaction line tables are consistent, and that the discount amount on the header is the sum of the discount amounts on the lines.</span></span>
- <span data-ttu-id="b742b-126">**Desconto de linha** - valida se o desconto de linha na linha de transação é a soma de todas as linhas na tabela de desconto que corresponde à linha de transação.</span><span class="sxs-lookup"><span data-stu-id="b742b-126">**Line discount** – Validates that the line discount on the transaction line is the sum of all the lines in the discount table that corresponds to the transaction line.</span></span>
- <span data-ttu-id="b742b-127">**Item do cartão-presente** - o Commerce não oferece suporte à devolução de itens do cartão-presente.</span><span class="sxs-lookup"><span data-stu-id="b742b-127">**Gift card item** – Commerce doesn't support the return of gift card items.</span></span> <span data-ttu-id="b742b-128">No entanto, o saldo em um cartão-presente pode ser resgatado. Haverá falha no processo de lançamento de demonstrativo em qualquer item de cartão-presente que seja processado como uma linha de devolução em vez de uma linha de resgate.</span><span class="sxs-lookup"><span data-stu-id="b742b-128">However, the balance on a gift card can be cashed out. Any gift card item that is processed as a return line instead of a cash-out line fails the statement posting process.</span></span> <span data-ttu-id="b742b-129">O processo de validação de itens de cartão-presente ajuda a garantir que somente os itens de cartão-presente devolvidos nas tabelas de transação sejam linhas de resgate de cartão-presente.</span><span class="sxs-lookup"><span data-stu-id="b742b-129">The validation process for gift card items helps guarantee that the only return gift card line items on the transaction tables are gift card cash-out lines.</span></span>
- <span data-ttu-id="b742b-130">**Preço negativo** - valida se não há nenhum preço negativo nas linhas de transação.</span><span class="sxs-lookup"><span data-stu-id="b742b-130">**Negative price** – Validates that there are no negative price transaction lines.</span></span>
- <span data-ttu-id="b742b-131">**Item e grade** — valida se os itens e as grades nas linhas de transação existem no item e no arquivo mestre da grade.</span><span class="sxs-lookup"><span data-stu-id="b742b-131">**Item & Variant** – Validates that items and variants on the transaction lines exist in the item and variant master file.</span></span>
- <span data-ttu-id="b742b-132">**Valor do imposto** — valida se os registros de impostos correspondem aos valores de imposto nas linhas.</span><span class="sxs-lookup"><span data-stu-id="b742b-132">**Tax amount** - Validates that tax records match the tax amounts on the lines.</span></span>
- <span data-ttu-id="b742b-133">**Número de série** — valida se o número de série. está presente nas linhas de transação dos itens que são controlados por número de série.</span><span class="sxs-lookup"><span data-stu-id="b742b-133">**Serial number** - Validates that the serial number is present in the transaction lines for items that are controlled by serial number.</span></span>
- <span data-ttu-id="b742b-134">**Sinal** — valida se o sinal na quantidade e no valor líquido são iguais em todas as linhas de transação.</span><span class="sxs-lookup"><span data-stu-id="b742b-134">**Sign** - Validates that the sign on the quantity and the net amount are the same in all the transaction lines.</span></span>
- <span data-ttu-id="b742b-135">**Data comercial** - valida se os períodos financeiros para todas as datas comerciais para as transações estão abertos.</span><span class="sxs-lookup"><span data-stu-id="b742b-135">**Business date** - Validates that the financial periods for all the business dates for the transactions are open.</span></span>

## <a name="set-up-the-consistency-checker"></a><span data-ttu-id="b742b-136">Configurar o verificador de consistência</span><span class="sxs-lookup"><span data-stu-id="b742b-136">Set up the consistency checker</span></span>

<span data-ttu-id="b742b-137">Configure o processo em lote "Validar transações de loja" em **Varejo e Comércio \> TI de Varejo e Comércio \> Lançamento do PDV** para execuções periódicas.</span><span class="sxs-lookup"><span data-stu-id="b742b-137">Configure the "Validate store transactions" batch process, at **Retail and Commerce \> Retail and Commerce IT \> POS posting**, for periodic runs.</span></span> <span data-ttu-id="b742b-138">O trabalho em lotes pode ser agendado com base na hierarquia da organização da loja, semelhante a como os processos "Calcular demonstrativos em lote" e "Lançar demonstrativos em lote" são configurados.</span><span class="sxs-lookup"><span data-stu-id="b742b-138">The batch job can be scheduled based on store organization hierarchy, similar to how the "Calculate statement in batch" and "Post statement in batch" processes are set up.</span></span> <span data-ttu-id="b742b-139">É recomendável configurar esse processo em lote para ser executado várias vezes em um dia e agendá-lo de forma que isso ocorra ao final de cada execução de trabalho P.</span><span class="sxs-lookup"><span data-stu-id="b742b-139">We recommend that you configure this batch process to run multiple times in a day and schedule it so that it runs at the end of every P-job execution.</span></span>

## <a name="results-of-validation-process"></a><span data-ttu-id="b742b-140">Resultados do processo de validação</span><span class="sxs-lookup"><span data-stu-id="b742b-140">Results of validation process</span></span>

<span data-ttu-id="b742b-141">Os resultados da verificação de validação pelo processo em lote são marcados na transação apropriada.</span><span class="sxs-lookup"><span data-stu-id="b742b-141">The results of the validation check by the batch process are tagged on the appropriate transaction.</span></span> <span data-ttu-id="b742b-142">O campo **Status de validação** do registro de transação é definido como **Êxito** ou **Erro** e a data da última execução de validação aparece no campo **Hora da última validação**.</span><span class="sxs-lookup"><span data-stu-id="b742b-142">The **Validation status** field on the transaction record is either set to **Successful** or **Error**, and the date of the last validation run appears on the **Last validation time** field.</span></span>

<span data-ttu-id="b742b-143">Para exibir um texto de erro mais descritivo referente a uma falha de validação, selecione o registro de transação da loja relevante e clique no botão **Erros de validação**.</span><span class="sxs-lookup"><span data-stu-id="b742b-143">To view more descriptive error text relating to a validation failure, select the relevant store transaction record and click the **Validation errors** button.</span></span>

<span data-ttu-id="b742b-144">As transações que forem reprovadas na verificação de validação e as que ainda não tiverem sido validadas não serão incluídas nos demonstrativos.</span><span class="sxs-lookup"><span data-stu-id="b742b-144">Transactions that fail the validation check and transactions that have not yet been validated will not be pulled into statements.</span></span> <span data-ttu-id="b742b-145">Durante o processo "Calcular demonstrativo", os usuários serão notificados se houver transações que poderiam ter sido incluídas no demonstrativo, mas não foram.</span><span class="sxs-lookup"><span data-stu-id="b742b-145">During the "Calculate statement" process, users will be notified if there are transactions that could have been included in the statement but weren't.</span></span>

<span data-ttu-id="b742b-146">Se um erro de validação for encontrado, a única maneira de corrigi-lo é entrar em contato com o Suporte da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b742b-146">If a validation error is found, the only way to fix the error is to contact Microsoft Support.</span></span> <span data-ttu-id="b742b-147">Em uma versão futura, será adicionado um recurso para que os usuários possam corrigir os registros com falha por meio da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="b742b-147">In a future release, capability will be added so that users can fix the records that failed through the user interface.</span></span> <span data-ttu-id="b742b-148">Recursos de registro e auditoria também serão disponibilizados para rastrear o histórico de modificações.</span><span class="sxs-lookup"><span data-stu-id="b742b-148">Logging and auditing capabilities will also be made available to trace the history of the modifications.</span></span>

> [!NOTE]
> <span data-ttu-id="b742b-149">Regras de validação adicionais para oferecer suporte a mais cenários serão adicionadas em uma versão futura.</span><span class="sxs-lookup"><span data-stu-id="b742b-149">Additional validation rules to support more scenarios will be added in a future release.</span></span>
