---
title: Visão geral de pagamentos de omni-channel
description: Este tópico fornece uma visão geral de pagamentos de omni-channel no Dynamics 365 Commerce.
author: rubendel
manager: AnnBe
ms.date: 09/17/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application user
ms.reviewer: josaw
ms.search.scope: Operations, Retail
ms.custom: 141393
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Retail
ms.author: rubendel
ms.search.validFrom: 2019-01-01
ms.dyn365.ops.version: AX 8.1.3
ms.openlocfilehash: 80eaf36fb382e0ebe0a66383ea17ab76faa07dfa
ms.sourcegitcommit: 199848e78df5cb7c439b001bdbe1ece963593cdb
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/13/2020
ms.locfileid: "4410310"
---
# <a name="omni-channel-payments-overview"></a><span data-ttu-id="c326a-103">Visão geral de pagamentos de omni-channel</span><span class="sxs-lookup"><span data-stu-id="c326a-103">Omni-channel payments overview</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="c326a-104">Este tópico fornece uma visão geral de pagamentos de omni-channel no Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="c326a-104">This topic provides an overview of omni-channel payments in Dynamics 365 Commerce.</span></span> <span data-ttu-id="c326a-105">Ele inclui uma lista abrangente de cenários com suporte, informações sobre funcionalidade, configuração e solução de problemas e descrições de alguns problemas típicos.</span><span class="sxs-lookup"><span data-stu-id="c326a-105">It includes a comprehensive list of supported scenarios, information about functionality, setup, and troubleshooting, and descriptions of some typical issues.</span></span>

## <a name="key-terms"></a><span data-ttu-id="c326a-106">Condições principais</span><span class="sxs-lookup"><span data-stu-id="c326a-106">Key terms</span></span>

| <span data-ttu-id="c326a-107">Termo</span><span class="sxs-lookup"><span data-stu-id="c326a-107">Term</span></span> | <span data-ttu-id="c326a-108">Descrição</span><span class="sxs-lookup"><span data-stu-id="c326a-108">Description</span></span> |
|---|---|
| <span data-ttu-id="c326a-109">Token </span><span class="sxs-lookup"><span data-stu-id="c326a-109">Token</span></span> | <span data-ttu-id="c326a-110">Uma sequência de dados que um processador de pagamento fornece como referência.</span><span class="sxs-lookup"><span data-stu-id="c326a-110">A string of data that a payment processor provides as a reference.</span></span> <span data-ttu-id="c326a-111">Os tokens podem representar números de cartão de pagamento, autorizações de pagamento e capturas de pagamento anteriores.</span><span class="sxs-lookup"><span data-stu-id="c326a-111">Tokens can represent payment card numbers, payment authorizations, and previous payment captures.</span></span> <span data-ttu-id="c326a-112">Os tokens são importantes porque ajudam a manter dados confidenciais fora do sistema de ponto de venda (PDV).</span><span class="sxs-lookup"><span data-stu-id="c326a-112">Tokens are important because they help keep sensitive data out of the point of sale (POS) system.</span></span> <span data-ttu-id="c326a-113">Às vezes também são chamados de *referências*.</span><span class="sxs-lookup"><span data-stu-id="c326a-113">They are sometimes also referred to as *references*.</span></span> |
| <span data-ttu-id="c326a-114">Token de cartão</span><span class="sxs-lookup"><span data-stu-id="c326a-114">Card token</span></span> | <span data-ttu-id="c326a-115">Um token que um processador de pagamento fornece para armazenamento no sistema de PDV.</span><span class="sxs-lookup"><span data-stu-id="c326a-115">A token that a payment processor provides for storage in the POS system.</span></span> <span data-ttu-id="c326a-116">Um token de cartão só pode ser usado pelo comerciante que o recebe.</span><span class="sxs-lookup"><span data-stu-id="c326a-116">A card token can be used only by the merchant who receives it.</span></span> <span data-ttu-id="c326a-117">Os tokens de cartão às vezes também são chamados de *referências de cartões*.</span><span class="sxs-lookup"><span data-stu-id="c326a-117">Card tokens are sometimes also referred to as *card references*.</span></span> |
| <span data-ttu-id="c326a-118">Token de autorização (auth)</span><span class="sxs-lookup"><span data-stu-id="c326a-118">Authorization (auth) token</span></span> | <span data-ttu-id="c326a-119">Uma ID exclusiva que um processo de pagamento fornece como parte da resposta que envia a um sistema de PDV depois que o sistema de PDV faz uma solicitação de autorização.</span><span class="sxs-lookup"><span data-stu-id="c326a-119">A unique ID that a payment process provides as part of the response that it sends to a POS system after the POS system makes an authorization request.</span></span> <span data-ttu-id="c326a-120">Um token de autorização pode ser usado posteriormente se o processador for chamado para executar ações, como reverter ou anular a autorização.</span><span class="sxs-lookup"><span data-stu-id="c326a-120">An authorization token can be used later if the processor is called to perform actions such as reversing or voiding the authorization.</span></span> <span data-ttu-id="c326a-121">Entretanto, é mais usado para capturar fundos quando uma ordem é atendida ou uma transação é finalizada.</span><span class="sxs-lookup"><span data-stu-id="c326a-121">However, it's most often used to capture funds when an order is fulfilled or a transaction is finalized.</span></span> <span data-ttu-id="c326a-122">Os tokens de autorização às vezes também são chamados de *referências de autorização*.</span><span class="sxs-lookup"><span data-stu-id="c326a-122">Authorization tokens are sometimes also referred to as *authorization references*.</span></span> |
| <span data-ttu-id="c326a-123">Token de captura</span><span class="sxs-lookup"><span data-stu-id="c326a-123">Capture token</span></span> | <span data-ttu-id="c326a-124">Uma referência que um processador de pagamento fornece a um sistema de PDV quando um pagamento é finalizado ou capturado.</span><span class="sxs-lookup"><span data-stu-id="c326a-124">A reference that a payment processor provides to a POS system when a payment is finalized or captured.</span></span> <span data-ttu-id="c326a-125">O token de captura pode ser usado para referenciar a captura de pagamento em operações subsequentes, como solicitações de reembolso.</span><span class="sxs-lookup"><span data-stu-id="c326a-125">The capture token can then be used to reference the payment capture in subsequent operations, such as refund requests.</span></span> | 
| <span data-ttu-id="c326a-126">O cartão não está presente</span><span class="sxs-lookup"><span data-stu-id="c326a-126">Card not present</span></span> | <span data-ttu-id="c326a-127">Um termo que se refere a transações de pagamento em que um cartão físico não é apresentado.</span><span class="sxs-lookup"><span data-stu-id="c326a-127">A term that refers to payment transactions where a physical card isn't presented.</span></span> <span data-ttu-id="c326a-128">Por exemplo, essas transações podem ocorrer em cenários de comércio eletrônico ou call center.</span><span class="sxs-lookup"><span data-stu-id="c326a-128">For example, these transactions can occur in e-commerce or call center scenarios.</span></span> <span data-ttu-id="c326a-129">Para essas transações, as informações relacionadas ao pagamento são inseridas manualmente em um site de comércio eletrônico, em um fluxo do call center ou no terminal de PDV ou de pagamento.</span><span class="sxs-lookup"><span data-stu-id="c326a-129">For these transactions, the payment-related information is manually entered on an e-commerce website, in a call center flow, or on the POS or payment terminal.</span></span> |
| <span data-ttu-id="c326a-130">O cartão está presente</span><span class="sxs-lookup"><span data-stu-id="c326a-130">Card present</span></span> | <span data-ttu-id="c326a-131">Um termo que se refere a transações de pagamento em que um cartão físico é apresentado e usado em um terminal de pagamento conectado ao sistema de PDV do Microsoft Dynamics 365.</span><span class="sxs-lookup"><span data-stu-id="c326a-131">A term that refers to payment transactions where a physical card is presented and used on a payment terminal that is connected to the Microsoft Dynamics 365 POS system.</span></span> |

## <a name="overview"></a><span data-ttu-id="c326a-132">Visão Geral</span><span class="sxs-lookup"><span data-stu-id="c326a-132">Overview</span></span>

<span data-ttu-id="c326a-133">Em geral, o termo *pagamentos de omni-channel* descreve a capacidade de criar uma ordem em um canal e atendê-la em outro canal.</span><span class="sxs-lookup"><span data-stu-id="c326a-133">In general, the term *omni-channel payments* describes the ability to create an order in one channel and fulfill it in another channel.</span></span> <span data-ttu-id="c326a-134">O segredo para o suporte a pagamento de omni-channel é preservar os detalhes de pagamento juntamente com os demais detalhes da ordem e, em seguida, usar esses detalhes de pagamento quando a ordem é recuperada ou processada em outro canal.</span><span class="sxs-lookup"><span data-stu-id="c326a-134">The key to omni-channel payment support is preserving payment details together with the rest of the order details, and then using those payment details when the order is recalled or processed in another channel.</span></span> <span data-ttu-id="c326a-135">Um exemplo clássico é o cenário "Comprar online, separar na loja".</span><span class="sxs-lookup"><span data-stu-id="c326a-135">A classic example is the "Buy online, pick up in store" scenario.</span></span> <span data-ttu-id="c326a-136">Nesse cenário, os detalhes de pagamento são adicionados quando a ordem é criada online.</span><span class="sxs-lookup"><span data-stu-id="c326a-136">In this scenario, the payment details are added when the order is created online.</span></span> <span data-ttu-id="c326a-137">Eles são então cancelados no PDV para cobrar o cartão de pagamento do cliente no momento da retirada.</span><span class="sxs-lookup"><span data-stu-id="c326a-137">They are then recalled at the POS to charge the customer's payment card at the time of pickup.</span></span> 

<span data-ttu-id="c326a-138">Todos os cenários descritos neste tópico podem ser implementados usando o kit de desenvolvimento de software (SDK) de pagamentos padrão fornecido com o Commerce.</span><span class="sxs-lookup"><span data-stu-id="c326a-138">All the scenarios that are described in this topic can be implemented by using the standard Payments software development kit (SDK) that is provided with Commerce.</span></span> <span data-ttu-id="c326a-139">O [Conector de Pagamento do Dynamics 365 para Adyen](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3) fornece uma implementação pronta para uso de todos os cenários descritos aqui.</span><span class="sxs-lookup"><span data-stu-id="c326a-139">The [Dynamics 365 Payment Connector for Adyen](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3) provides an out-of-box implementation of every scenario that is described here.</span></span> 

### <a name="prerequisites"></a><span data-ttu-id="c326a-140">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="c326a-140">Prerequisites</span></span>

<span data-ttu-id="c326a-141">Cada cenário descrito neste tópico requer um conector de pagamento que oferece suporte a pagamentos de omni-channel.</span><span class="sxs-lookup"><span data-stu-id="c326a-141">Every scenario that is described in this topic requires a payment connector that supports omni-channel payments.</span></span> <span data-ttu-id="c326a-142">O conector para Adyen pronto para uso também pode ser usado, pois oferece suporte aos cenários disponibilizados por meio do SDK de pagamentos.</span><span class="sxs-lookup"><span data-stu-id="c326a-142">The out-of-box Adyen connector can also be used, because it supports the scenarios that are made available through the Payments SDK.</span></span> <span data-ttu-id="c326a-143">Para obter mais informações sobre como implementar conectores de pagamento e sobre o SDK de varejo em geral, visite a [Página inicial de varejo para profissionais e desenvolvedores de TI](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/dev-retail-home-page#payment-connectors).</span><span class="sxs-lookup"><span data-stu-id="c326a-143">For more information about how to implement payment connectors, and about the Retail SDK in general, visit the [Retail for IT pros and developers home page](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/dev-retail-home-page#payment-connectors).</span></span>

#### <a name="supported-versions"></a><span data-ttu-id="c326a-144">Versões com suporte</span><span class="sxs-lookup"><span data-stu-id="c326a-144">Supported versions</span></span>

<span data-ttu-id="c326a-145">Os recursos de pagamento de omni-channel descritos neste tópico foram lançados como parte da versão 8.1.3 do Microsoft Dynamics 365 for Retail.</span><span class="sxs-lookup"><span data-stu-id="c326a-145">The omni-channel payment capabilities that are described in this topic were released as part of Microsoft Dynamics 365 for Retail version 8.1.3.</span></span> 

#### <a name="card-present-and-card-not-present-connectors"></a><span data-ttu-id="c326a-146">Conectores "cartão presente" e "cartão não presente"</span><span class="sxs-lookup"><span data-stu-id="c326a-146">"Card present" and "card not present" connectors</span></span>

<span data-ttu-id="c326a-147">O SDK de pagamentos depende de dois conjuntos de interfaces de programação de aplicativos (APIs) para pagamentos.</span><span class="sxs-lookup"><span data-stu-id="c326a-147">The Payments SDK relies on two sets of application programming interfaces (APIs) for payments.</span></span> <span data-ttu-id="c326a-148">O primeiro conjunto de APIs é denominado **iPaymentProcessor**.</span><span class="sxs-lookup"><span data-stu-id="c326a-148">The first set of APIs is named **iPaymentProcessor**.</span></span> <span data-ttu-id="c326a-149">Ele é usado para implementar conectores de pagamento "cartão não presente" que podem ser usados em call centers e com a plataforma de comércio eletrônico do Microsoft Dynamics.</span><span class="sxs-lookup"><span data-stu-id="c326a-149">It's used to implement "card not present" payment connectors that can be used in call centers and with the Microsoft Dynamics e-Commerce platform.</span></span> <span data-ttu-id="c326a-150">Para obter informações sobre a interface **iPaymentProcessor**, consulte o white paper [Implementar um conector de pagamento e um dispositivo de pagamento](https://download.microsoft.com/download/e/2/7/e2735c65-1e66-4b8d-8a3c-e6ef3a319137/The%20Guide%20to%20Implementing%20Payment%20Connector%20and%20Payment%20Device_update.pdf), que abrande pagamentos.</span><span class="sxs-lookup"><span data-stu-id="c326a-150">For more information about the **iPaymentProcessor** interface, see the [Implement a payment connector and a payment device](https://download.microsoft.com/download/e/2/7/e2735c65-1e66-4b8d-8a3c-e6ef3a319137/The%20Guide%20to%20Implementing%20Payment%20Connector%20and%20Payment%20Device_update.pdf) white paper, which covers payments.</span></span> 

<span data-ttu-id="c326a-151">O segundo conjunto de APIs é denominado **iNamedRequestHandler**.</span><span class="sxs-lookup"><span data-stu-id="c326a-151">The second set of APIs is named **iNamedRequestHandler**.</span></span> <span data-ttu-id="c326a-152">Ele permite a implementação de integrações de pagamento "cartão presente" que usam um terminal de pagamento.</span><span class="sxs-lookup"><span data-stu-id="c326a-152">It supports the implementation of "card present" payment integrations that use a payment terminal.</span></span> <span data-ttu-id="c326a-153">Para obter mais informações sobre a interface **iNamedRequestHandler**, consulte [Criar uma integração de pagamento para um terminal de pagamento](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/end-to-end-payment-extension).</span><span class="sxs-lookup"><span data-stu-id="c326a-153">For more information about the **iNamedRequestHandler** interface, see [Create a payment integration for a payment terminal](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/end-to-end-payment-extension).</span></span> 

### <a name="setup-and-configuration"></a><span data-ttu-id="c326a-154">Instalação e configuração</span><span class="sxs-lookup"><span data-stu-id="c326a-154">Setup and configuration</span></span>

<span data-ttu-id="c326a-155">Os seguintes componentes e etapas de configuração são necessários:</span><span class="sxs-lookup"><span data-stu-id="c326a-155">The following components and setup steps are required:</span></span>

- <span data-ttu-id="c326a-156">**Integração de comércio eletrônico:** é necessária uma integração com o Commerce para dar suporte a cenários em que uma ordem se origina em uma vitrine online.</span><span class="sxs-lookup"><span data-stu-id="c326a-156">**eCommerce integration:** An integration with Commerce is required to support scenarios where an order originates in an online storefront.</span></span> <span data-ttu-id="c326a-157">Para obter mais informações sobre o SDK de comércio eletrônico do Retail, consulte [kit de desenvolvimento de software (SDK) da plataforma de comércio eletrônico](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/ecommerce-platform-sdk).</span><span class="sxs-lookup"><span data-stu-id="c326a-157">For more information about the Retail e-Commerce SDK, see [e-Commerce platform software development kit (SDK)](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/ecommerce-platform-sdk).</span></span> <span data-ttu-id="c326a-158">Em um ambiente de demonstração, a vitrine de referência oferece suporte a cenários de pagamento de omni-channel.</span><span class="sxs-lookup"><span data-stu-id="c326a-158">In a demo environment, the reference storefront supports omni-channel payment scenarios.</span></span> 
- <span data-ttu-id="c326a-159">**Configuração de pagamentos online:** a configuração do canal online deve incluir um conector de pagamento que foi atualizado para oferecer suporte a pagamentos de omni-channel.</span><span class="sxs-lookup"><span data-stu-id="c326a-159">**Online payments configuration:** The setup of the online channel must include a payment connector that has been updated to support omni-channel payments.</span></span> <span data-ttu-id="c326a-160">Como alternativa, o conector de pagamento pronto para uso pode ser usado.</span><span class="sxs-lookup"><span data-stu-id="c326a-160">Alternatively, the out-of-box payment connector can be used.</span></span> <span data-ttu-id="c326a-161">Para obter informações sobre como configurar o conector de pagamento de Adyen para lojas online, consulte [Conector de pagamento de Adyen](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3#e-commerce).</span><span class="sxs-lookup"><span data-stu-id="c326a-161">For information about how to configure the Adyen payment connector for online stores, see [Adyen payment connector](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3#e-commerce).</span></span> <span data-ttu-id="c326a-162">Além das etapas de configuração do comércio eletrônico descritas neste tópico, o parâmetro **Permitir salvar informações de pagamento no comércio eletrônico** deve ser definido como **Verdadeiro** nas configurações do conector de Adyen.</span><span class="sxs-lookup"><span data-stu-id="c326a-162">In addition to the eCommerce setup steps that are described in that topic, the **Allow saving payment information in e-commerce** parameter must be set to **True** in the settings for the Adyen connector.</span></span> 
- <span data-ttu-id="c326a-163">**Configuração de pagamentos de omni-channel:** no back office, vá para **Retail e Commerce \> Configuração da sede \> Parâmetros \> Parâmetros compartilhados do Commerce**.</span><span class="sxs-lookup"><span data-stu-id="c326a-163">**Omni-channel payments configuration:** In the back office, go to **Retail and Commerce \> Headquarters setup \> Parameters \> Commerce shared parameters**.</span></span> <span data-ttu-id="c326a-164">Depois, na guia **Pagamentos de omni-channel**, define a opção **Usar pagamentos de omni-channel** como **Sim**.</span><span class="sxs-lookup"><span data-stu-id="c326a-164">Then, on the **Omni-channel payments** tab, set the **Use omni-channel payments** option to **Yes**.</span></span> <span data-ttu-id="c326a-165">No Commerce versões 10.0.12 e posterior, essa configuração está no espaço de trabalho **Gerenciamento de Recursos**.</span><span class="sxs-lookup"><span data-stu-id="c326a-165">In Commerce versions 10.0.12 and later, this setting is in the **Feature Management** workspace.</span></span> <span data-ttu-id="c326a-166">Selecione o recurso **Pagamentos de omnicanal** e clique em **Habilitar agora**.</span><span class="sxs-lookup"><span data-stu-id="c326a-166">Select the **Omni-channel payments** feature and click **Enable now**.</span></span> 
- <span data-ttu-id="c326a-167">**Serviços de pagamento:** o call center usa o conector de pagamento padrão na página **Serviços de pagamento** para processar pagamentos.</span><span class="sxs-lookup"><span data-stu-id="c326a-167">**Payment services:** The call center uses the default payment connector on the **Payment services** page to process payments.</span></span> <span data-ttu-id="c326a-168">Para suportar cenários como "Comprar em uma call center, retirar na loja", esse conector de pagamento padrão deve ser o conector de pagamento de Adyen ou um conector de pagamento que atenda aos requisitos de implementação para pagamentos de omni-channel.</span><span class="sxs-lookup"><span data-stu-id="c326a-168">To support scenarios such as "Buy in call center, pick up in store," this default payment connector must be the Adyen payment connector or a payment connector that meets the implementation requirements for omni-channel payments.</span></span>
- <span data-ttu-id="c326a-169">**Serviço de TEF:** os pagamentos por meio de um terminal de pagamento devem ser configurados na Guia Rápida **Serviço de TEF** do perfil de hardware.</span><span class="sxs-lookup"><span data-stu-id="c326a-169">**EFT service:** Payments through a payment terminal must be set up on the **EFT service** FastTab of the hardware profile.</span></span> <span data-ttu-id="c326a-170">O conector de Adyen oferece suporte a cenários de pagamentos de omni-channel prontos para uso.</span><span class="sxs-lookup"><span data-stu-id="c326a-170">The Adyen connector supports omni-channel payments scenarios out of the box.</span></span> <span data-ttu-id="c326a-171">Outros conectores de pagamento que oferecem suporte à interface **iNamedRequestHandler** também podem ser usados se permitirem pagamentos de omni-channel.</span><span class="sxs-lookup"><span data-stu-id="c326a-171">Other payment connectors that support the **iNamedRequestHandler** interface can also be used if they support omni-channel payments.</span></span>
- <span data-ttu-id="c326a-172">**Disponibilidade do conector de pagamento:** quando uma ordem é cancelada, as linhas de proposta de pagamento que são canceladas juntamente com a ordem incluem o nome do conector de pagamento que foi usado para criar as autorizações associadas a essa ordem.</span><span class="sxs-lookup"><span data-stu-id="c326a-172">**Payment connector availability:** When an order is recalled, the payment tender lines that are recalled together with the order include the name of the payment connector that was used to create the authorizations that are associated with that order.</span></span> <span data-ttu-id="c326a-173">Quando a ordem é atendida, o SDK de pagamentos tenta usar o mesmo conector usado para criar a autorização original.</span><span class="sxs-lookup"><span data-stu-id="c326a-173">When the order is fulfilled, the Payments SDK tries to use the same connector that was used to create the original authorization.</span></span> <span data-ttu-id="c326a-174">Portanto, um conector de pagamento que tenha as mesmas propriedades do comerciante deve estar disponível para captura.</span><span class="sxs-lookup"><span data-stu-id="c326a-174">Therefore, a payment connector that has the same merchant properties must be available for capture.</span></span> 
- <span data-ttu-id="c326a-175">**Tipos de cartão:** para que os cenários de omni-channel funcionem corretamente, cada canal deve ter a mesma configuração para os tipos de proposta que podem ser usados para o omni-channel.</span><span class="sxs-lookup"><span data-stu-id="c326a-175">**Card types:** For omni-channel scenarios to work properly, each channel must have the same setup for tender types that can be used for omni-channel.</span></span> <span data-ttu-id="c326a-176">Essa configuração inclui IDs de método de pagamento e IDs de tipo de cartão.</span><span class="sxs-lookup"><span data-stu-id="c326a-176">This setup includes payment method IDs and card type IDs.</span></span> <span data-ttu-id="c326a-177">Por exemplo, se o tipo de proposta **Cartões** tiver uma ID de **2** na configuração da loja online, ele deverá ter a mesma ID na configuração da loja de varejo.</span><span class="sxs-lookup"><span data-stu-id="c326a-177">For example, if the **Cards** tender type has an ID of **2** in the online store setup, it should have the same ID in the retail store setup.</span></span> <span data-ttu-id="c326a-178">O mesmo requisito se aplica às IDs do tipo de cartão.</span><span class="sxs-lookup"><span data-stu-id="c326a-178">The same requirement applies to card type IDs.</span></span> <span data-ttu-id="c326a-179">Se o número do cartão **12** estiver definido como **VISA** na loja online, a mesma ID deverá ser configurada para a loja de varejo.</span><span class="sxs-lookup"><span data-stu-id="c326a-179">If card number **12** is set to **VISA** in the online store, the same ID should be set up for the retail store.</span></span> 
- <span data-ttu-id="c326a-180">O Retail Modern POS para Windows ou Android com uma estação de hardware integrada — ou —</span><span class="sxs-lookup"><span data-stu-id="c326a-180">The Retail Modern POS for Windows or Android with built-in hardware station   -or-</span></span>
- <span data-ttu-id="c326a-181">Modern POS para iOS ou PDV em Nuvem com estação de hardware compartilhada conectada.</span><span class="sxs-lookup"><span data-stu-id="c326a-181">Modern POS for iOS or Cloud POS with connected shared hardware station.</span></span> 

### <a name="basic-principle-supporting-omni-channel-payments"></a><span data-ttu-id="c326a-182">Princípio básico com suporte aos pagamentos de omni-channel</span><span class="sxs-lookup"><span data-stu-id="c326a-182">Basic principle supporting omni-channel payments</span></span>

<span data-ttu-id="c326a-183">Os conectores de pagamento e os processadores de pagamento usam tokens ou referências para fazer referência a interações relacionadas a pagamentos com cartão.</span><span class="sxs-lookup"><span data-stu-id="c326a-183">Payment connectors and payment processors use tokens, or references, to reference interactions that are related to card payments.</span></span> <span data-ttu-id="c326a-184">Por exemplo, quando uma autorização de pagamento é solicitada, uma referência a essa autorização é fornecida.</span><span class="sxs-lookup"><span data-stu-id="c326a-184">For example, when a payment authorization is requested, a reference to that authorization is provided.</span></span> <span data-ttu-id="c326a-185">Portanto, a autorização pode ser referenciada posteriormente, quando os fundos são capturados no momento do atendimento.</span><span class="sxs-lookup"><span data-stu-id="c326a-185">Therefore, the authorization can be referenced later, when funds are captured at the time of fulfillment.</span></span> <span data-ttu-id="c326a-186">Essa autorização é exclusiva do comerciante, do conector de pagamento e do processador.</span><span class="sxs-lookup"><span data-stu-id="c326a-186">This authorization is unique to the merchant, payment connector, and processor.</span></span> 

<span data-ttu-id="c326a-187">Se uma ordem criada online estiver sendo retirada na loja, os mesmos detalhes de pagamento dessa ordem deverão ser recuperados e usados.</span><span class="sxs-lookup"><span data-stu-id="c326a-187">If an order that was created online is being picked up in the store, the same payment details for that order must be recalled and used.</span></span> <span data-ttu-id="c326a-188">Quando os detalhes originais forem fornecidos como parte da solicitação para capturar um pagamento em relação à autorização original, o processador de pagamento poderá processar a solicitação e capturar o pagamento.</span><span class="sxs-lookup"><span data-stu-id="c326a-188">When the original details are provided as part of the request to capture a payment against the original authorization, the payment processor will be able to handle the request and capture the payment.</span></span> 

<span data-ttu-id="c326a-189">Para referenciar corretamente o pedido online, um conector de pagamento "cartão não presente" que oferece ao mesmo processador também deve estar disponível.</span><span class="sxs-lookup"><span data-stu-id="c326a-189">To correctly reference the online order, a "card not present" payment connector that supports the same processor must also be available.</span></span> <span data-ttu-id="c326a-190">Dessa forma, o sistema de PDV pode ter um processador para pagamentos com "cartão presente", mas também pode ter acesso a outros conectores de pagamento para poder atender a ordens que são criadas em outros canais usando diferentes processadores de pagamento.</span><span class="sxs-lookup"><span data-stu-id="c326a-190">In this way, the POS system can have one processor for "card present" payments, but it can also have access to other payment connectors so that it can fulfill orders that are created in other channels by using different payment processors.</span></span> 

## <a name="supported-scenarios"></a><span data-ttu-id="c326a-191">Cenários com suporte</span><span class="sxs-lookup"><span data-stu-id="c326a-191">Supported scenarios</span></span>

<span data-ttu-id="c326a-192">Os seguintes cenários de pagamento de omni-channel são compatíveis:</span><span class="sxs-lookup"><span data-stu-id="c326a-192">The following omni-channel payment scenarios are supported:</span></span>

- <span data-ttu-id="c326a-193">Comprar online, retirar na loja</span><span class="sxs-lookup"><span data-stu-id="c326a-193">Buy online, pick up in store</span></span>
- <span data-ttu-id="c326a-194">Comprar em uma call center, retirar na loja</span><span class="sxs-lookup"><span data-stu-id="c326a-194">Buy in call center, pick up in store</span></span>
- <span data-ttu-id="c326a-195">Comprar na loja A, retirar na loja B</span><span class="sxs-lookup"><span data-stu-id="c326a-195">Buy in store A, pick up in store B</span></span>
- <span data-ttu-id="c326a-196">Comprar na loja A, enviar ao cliente</span><span class="sxs-lookup"><span data-stu-id="c326a-196">Buy in store A, ship to customer</span></span>

    > [!NOTE]
    > <span data-ttu-id="c326a-197">Os pagamentos feitos no call center que mapeiam para a função de pagamento "Normal" devem ser marcados como **Pagamento antecipado** = **Sim** para ser refletido no valor devido ao recuperar a ordem no PDV.</span><span class="sxs-lookup"><span data-stu-id="c326a-197">Payments made in the call center that map to the "Normal" payment function must be marked as **Prepay** = **Yes** to be reflected in the amount due when recalling the order in the POS.</span></span> <span data-ttu-id="c326a-198">Pagamentos não antecipados do tipo "Normal" não são reconhecidos quando a ordem é recuperada no PDV.</span><span class="sxs-lookup"><span data-stu-id="c326a-198">Non-prepay payments of type "Normal" are not recognized when the order is recalled in POS.</span></span> 

<span data-ttu-id="c326a-199">Variações desses cenários também são compatíveis.</span><span class="sxs-lookup"><span data-stu-id="c326a-199">Variations of these scenarios are also supported.</span></span> <span data-ttu-id="c326a-200">Por exemplo, uma ordem online pode incluir as duas linhas que serão enviadas ao cliente e as linhas que serão retiradas em uma loja.</span><span class="sxs-lookup"><span data-stu-id="c326a-200">For example, an online order might include both lines that will be shipped to the customer and lines that will be picked up in a store.</span></span> <span data-ttu-id="c326a-201">Todas as opções de atendimento de ordens são permitidas por meio de pagamentos de omni-channel.</span><span class="sxs-lookup"><span data-stu-id="c326a-201">All order fulfillment options are supported via omni-channel payments.</span></span> 

<span data-ttu-id="c326a-202">As seções a seguir descrevem as etapas para cada cenário e mostram como executar o cenário usando dados de demonstração.</span><span class="sxs-lookup"><span data-stu-id="c326a-202">The following sections describe the steps for each scenario and show how to run the scenario by using demo data.</span></span> 

### <a name="buy-online-pick-up-in-store"></a><span data-ttu-id="c326a-203">Comprar online, retirar na loja</span><span class="sxs-lookup"><span data-stu-id="c326a-203">Buy online, pick up in store</span></span>

<span data-ttu-id="c326a-204">Antes de começar, verifique se os seguintes pré-requisitos estão atendidos:</span><span class="sxs-lookup"><span data-stu-id="c326a-204">Before you start, make sure that the following prerequisites are in place:</span></span>

- <span data-ttu-id="c326a-205">Você tem uma loja de referência onde o conector de Adyen está configurado.</span><span class="sxs-lookup"><span data-stu-id="c326a-205">You have a reference storefront where the Adyen connector is configured.</span></span>
- <span data-ttu-id="c326a-206">A opção **Pagamentos de omni-channel** na página **Parâmetros compartilhados do Commerce** é definida como **Verdadeiro**.</span><span class="sxs-lookup"><span data-stu-id="c326a-206">The **Omni-channel payments** option on the **Commerce shared parameters** page is set to **True**.</span></span> <span data-ttu-id="c326a-207">Em versões mais recentes, essa configuração foi movida para o espaço de trabalho **Gerenciamento de Recursos**, no qual você pode selecionar o recurso **Pagamentos de omnicanal** e clicar em **Habilitar agora**.</span><span class="sxs-lookup"><span data-stu-id="c326a-207">In later versions this settng is moved to the **Feature Management** workspace where you can select the **Omni-channel payments** feature and click **Enable now**.</span></span> 
- <span data-ttu-id="c326a-208">O conector de pagamento de Adyen é configurado para o registro de PDV de Houston.</span><span class="sxs-lookup"><span data-stu-id="c326a-208">The Adyen payment connector is configured for the Houston POS register.</span></span>
- <span data-ttu-id="c326a-209">O Retail Modern POS para Windows ou Android com uma estação de hardware integrada — ou —</span><span class="sxs-lookup"><span data-stu-id="c326a-209">The Retail Modern POS for Windows or Android with built-in hardware station   -or-</span></span>
- <span data-ttu-id="c326a-210">Modern POS para iOS ou PDV em Nuvem com estação de hardware compartilhada conectada.</span><span class="sxs-lookup"><span data-stu-id="c326a-210">Modern POS for iOS or Cloud POS with connected shared hardware station.</span></span> 

<span data-ttu-id="c326a-211">Siga estas etapas para executar o cenário.</span><span class="sxs-lookup"><span data-stu-id="c326a-211">Follow these steps to run the scenario.</span></span>

1. <span data-ttu-id="c326a-212">Na vitrine de referência, crie uma ordem para retirada na loja.</span><span class="sxs-lookup"><span data-stu-id="c326a-212">In the reference storefront, create an order for in-store pickup.</span></span> <span data-ttu-id="c326a-213">Certifique-se de selecionar a loja de **Houston**.</span><span class="sxs-lookup"><span data-stu-id="c326a-213">Be sure to select the **Houston** store.</span></span> 
2. <span data-ttu-id="c326a-214">Siga as etapas de check-out e pague usando um número de cartão de crédito de teste.</span><span class="sxs-lookup"><span data-stu-id="c326a-214">Go through the checkout steps, and pay by using a test credit card number.</span></span> <span data-ttu-id="c326a-215">Você pode encontrar números de cartão de crédito de teste na [página de números de cartão de teste de Adyen](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description).</span><span class="sxs-lookup"><span data-stu-id="c326a-215">You can find test credit card numbers on the [Adyen test card numbers page](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description).</span></span>
3. <span data-ttu-id="c326a-216">No Commerce, use o trabalho em lotes **Sincronizar ordens** e a agenda de distribuição **P-001** para criar as ordens no back office.</span><span class="sxs-lookup"><span data-stu-id="c326a-216">In Commerce, use the **Synchronize orders** batch job and the **P-001** distribution schedule to create the orders in the back office.</span></span>
4. <span data-ttu-id="c326a-217">No PDV, na página de boas-vindas, selecione a operação **Ordens para retirada** para ver as ordens de retirada na loja.</span><span class="sxs-lookup"><span data-stu-id="c326a-217">In the POS, on the welcome page, select the **Orders to pickup** operation to see the orders for in-store pickup.</span></span> 
5. <span data-ttu-id="c326a-218">Selecione uma ou mais linhas da ordem que foi criada na vitrine da referência e, em seguida, selecione **Retirar**.</span><span class="sxs-lookup"><span data-stu-id="c326a-218">Select one or more lines from the order that was created in the reference storefront, and then select **Pick up**.</span></span>

    <span data-ttu-id="c326a-219">A ordem é recuperada do back office.</span><span class="sxs-lookup"><span data-stu-id="c326a-219">The order is retrieved from the back office.</span></span> 

6. <span data-ttu-id="c326a-220">Quando os detalhes da linha de ordem são recuperados do back office e um pagamento com cartão que pode ser usado para omni-channel é detectado, você é informado de que uma forma de pagamento está disponível.</span><span class="sxs-lookup"><span data-stu-id="c326a-220">When the order line details are retrieved from the back office, and a card payment that can be used for omni-channel is detected, you're informed that a payment method is available.</span></span>
7. <span data-ttu-id="c326a-221">Selecione **Usar a forma de pagamento disponível** para concluir a transação usando os detalhes do cartão que foram inseridos na vitrine de referência.</span><span class="sxs-lookup"><span data-stu-id="c326a-221">Select **Use available payment method** to complete the transaction by using the card details that were entered in the reference storefront.</span></span>

    <span data-ttu-id="c326a-222">As linhas da ordem são carregadas na página da transação e o saldo é 0 (zero).</span><span class="sxs-lookup"><span data-stu-id="c326a-222">The order lines are loaded on the transaction page, and the balance due is 0 (zero).</span></span> 

8. <span data-ttu-id="c326a-223">Selecione a guia **Pagamentos** para ver a linha de proposta retirada da ordem online.</span><span class="sxs-lookup"><span data-stu-id="c326a-223">Select the **Payments** tab to view the tender line that was pulled from the online order.</span></span> 
9. <span data-ttu-id="c326a-224">Selecione qualquer método de pagamento para concluir a transação.</span><span class="sxs-lookup"><span data-stu-id="c326a-224">Select any payment method to complete the transaction.</span></span> 

### <a name="buy-in-call-center-pick-up-in-store"></a><span data-ttu-id="c326a-225">Comprar em uma call center, retirar na loja</span><span class="sxs-lookup"><span data-stu-id="c326a-225">Buy in call center, pick up in store</span></span>

1. <span data-ttu-id="c326a-226">No Commerce, na página **Serviço de atendimento ao consumidor**, insira **Karen Berg** na barra de pesquisa e depois selecione **Pesquisar**.</span><span class="sxs-lookup"><span data-stu-id="c326a-226">In Commerce, on the **Customer service** page, enter **Karen Berg** in the search bar, and then select **Search**.</span></span> 
3. <span data-ttu-id="c326a-227">Selecione **Karen Berg** nos resultados da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="c326a-227">Select **Karen Berg** in the search results.</span></span>
4. <span data-ttu-id="c326a-228">Depois que Karen for carregada na página **Serviço de atendimento ao consumidor**, selecione **Nova ordem de venda**.</span><span class="sxs-lookup"><span data-stu-id="c326a-228">After Karen is loaded onto the **Customer service** page, select **New sales order**.</span></span>
5. <span data-ttu-id="c326a-229">Na página da nova ordem de venda, selecione **Cabeçalho** para exibir o cabeçalho da ordem.</span><span class="sxs-lookup"><span data-stu-id="c326a-229">On the new sales order page, select **Header** to view the order header.</span></span> 
6. <span data-ttu-id="c326a-230">Na página **Cabeçalho da ordem**, define o site como **Central** e o depósito como **Houston**.</span><span class="sxs-lookup"><span data-stu-id="c326a-230">On the **Order header** page, set the site to **Central** and the warehouse to **Houston**.</span></span>
7. <span data-ttu-id="c326a-231">Na guia **Entregar**, defina o campo **Modo de entrega** como **60** para a retirada do cliente.</span><span class="sxs-lookup"><span data-stu-id="c326a-231">On the **Deliver** tab, set the **Mode of delivery** field to **60** for customer pickup.</span></span>
8. <span data-ttu-id="c326a-232">Selecione **Linhas** e depois adicione uma ou mais linhas à ordem.</span><span class="sxs-lookup"><span data-stu-id="c326a-232">Select **Lines**, and then add one or more lines to the order.</span></span> 
9. <span data-ttu-id="c326a-233">Selecione **Concluir** para inserir o fluxo de conclusão da ordem.</span><span class="sxs-lookup"><span data-stu-id="c326a-233">Select **Complete** to enter the order completion flow.</span></span>
10. <span data-ttu-id="c326a-234">Role para baixo até a seção de pagamentos, selecione **Adicionar** e depois selecione uma linha na qual o tipo de método de pagamento está definido como **Cartões**.</span><span class="sxs-lookup"><span data-stu-id="c326a-234">Scroll down to the payments section, select **Add**, and then select a line where the payment method type is set to **Cards**.</span></span> 
11. <span data-ttu-id="c326a-235">Selecione o sinal de adição (**+**) para adicionar um pagamento com cartão.</span><span class="sxs-lookup"><span data-stu-id="c326a-235">Select the plus sign (**+**) to add a card payment.</span></span> 
12. <span data-ttu-id="c326a-236">Insira os detalhes de um número de cartão de crédito de teste encontrado na [página de números de cartão de teste de Adyen](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description) e depois selecione **OK**.</span><span class="sxs-lookup"><span data-stu-id="c326a-236">Enter the details for a test credit card number that you found on the [Adyen test card numbers page](https://docs.adyen.com/development-resources/test-cards/test-card-numbers/#description), and then select **OK**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="c326a-237">Se a marca do cartão referente ao número do cartão que você digitou for diferente da marca selecionada quando o pagamento foi iniciado, o pagamento ainda será processado.</span><span class="sxs-lookup"><span data-stu-id="c326a-237">If the card brand for the card number that you entered differs from the brand that was selected when the payment was initiated, the payment will still go through.</span></span> <span data-ttu-id="c326a-238">Contudo, ele será postado nas contas mapeadas para a marca de cartão que você selecionou na etapa 10.</span><span class="sxs-lookup"><span data-stu-id="c326a-238">However, it will be posted to the accounts that are mapped to the card brand that you selected in step 10.</span></span>

12. <span data-ttu-id="c326a-239">Selecione **OK** novamente para fechar a caixa de diálogo **Pagamentos de conclusão de ordem**.</span><span class="sxs-lookup"><span data-stu-id="c326a-239">Select **OK** again to close the **Order completion payments** dialog box.</span></span>
13. <span data-ttu-id="c326a-240">Na página **Resumo da ordem de venda**, selecione **Enviar**.</span><span class="sxs-lookup"><span data-stu-id="c326a-240">On the **Sales order summary** page, select **Submit**.</span></span>
14. <span data-ttu-id="c326a-241">No PDV, na página de boas-vindas, selecione a operação **Ordens para retirada** para ver as ordens de retirada na loja.</span><span class="sxs-lookup"><span data-stu-id="c326a-241">In the POS, on the welcome page, select the **Orders to pickup** operation to see the orders for in-store pickup.</span></span> 
15. <span data-ttu-id="c326a-242">Selecione uma ou mais linhas da ordem que foi criada na vitrine da referência e, em seguida, selecione **Retirar**.</span><span class="sxs-lookup"><span data-stu-id="c326a-242">Select one or more lines from the order that was created in the reference storefront, and then select **Pick up**.</span></span>

    <span data-ttu-id="c326a-243">A ordem é recuperada do back office.</span><span class="sxs-lookup"><span data-stu-id="c326a-243">The order is retrieved from the back office.</span></span> 

16. <span data-ttu-id="c326a-244">Quando os detalhes da linha de ordem são recuperados do back office e um pagamento com cartão que pode ser usado para omni-channel é detectado, você é informado de que uma forma de pagamento está disponível.</span><span class="sxs-lookup"><span data-stu-id="c326a-244">When the order line details are retrieved from the back office, and a card payment that can be used for omni-channel is detected, you're informed that a payment method is available.</span></span>
17. <span data-ttu-id="c326a-245">Selecione **Usar a forma de pagamento disponível** para concluir a transação usando os detalhes do cartão que foram inseridos na vitrine de referência.</span><span class="sxs-lookup"><span data-stu-id="c326a-245">Select **Use available payment method** to complete the transaction by using the card details that were entered in the reference storefront.</span></span>

    <span data-ttu-id="c326a-246">As linhas da ordem são carregadas na página da transação e o saldo é 0 (zero).</span><span class="sxs-lookup"><span data-stu-id="c326a-246">The order lines are loaded on the transaction page, and the balance due is 0 (zero).</span></span>

18. <span data-ttu-id="c326a-247">Selecione a guia **Pagamentos** para ver a linha de proposta retirada da ordem online.</span><span class="sxs-lookup"><span data-stu-id="c326a-247">Select the **Payments** tab to view the tender line that was pulled from the online order.</span></span> 
19. <span data-ttu-id="c326a-248">Selecione qualquer método de pagamento para concluir a transação.</span><span class="sxs-lookup"><span data-stu-id="c326a-248">Select any payment method to complete the transaction.</span></span> 

### <a name="buy-in-store-a-pick-up-in-store-b"></a><span data-ttu-id="c326a-249">Comprar na loja A, retirar na loja B</span><span class="sxs-lookup"><span data-stu-id="c326a-249">Buy in store A, pick up in store B</span></span>

1. <span data-ttu-id="c326a-250">Inicie o PDV para a loja de Houston.</span><span class="sxs-lookup"><span data-stu-id="c326a-250">Start the POS for the Houston store.</span></span>
2. <span data-ttu-id="c326a-251">Na página **Transação**, adicione Karen Berg à transação usando o teclado numérico para inserir **2001**.</span><span class="sxs-lookup"><span data-stu-id="c326a-251">On the **Transaction** page, add Karen Berg to the transaction by using the number pad to enter **2001**.</span></span>
3. <span data-ttu-id="c326a-252">Adicione uma ou mais linhas à transação.</span><span class="sxs-lookup"><span data-stu-id="c326a-252">Add one or more lines to the transaction.</span></span>
4. <span data-ttu-id="c326a-253">Selecione **Ordens** para ver as opções de ordem.</span><span class="sxs-lookup"><span data-stu-id="c326a-253">Select **Orders** to see the order options.</span></span>
5. <span data-ttu-id="c326a-254">Selecione **Retirar tudo** e, depois, quando for solicitado, selecione **Ordem do cliente**.</span><span class="sxs-lookup"><span data-stu-id="c326a-254">Select **Pick up all**, and then, when you're prompted, select **Customer order**.</span></span>
6. <span data-ttu-id="c326a-255">Na barra de pesquisa, insira **Seattle** e depois selecione a loja de **Seattle** para retirada.</span><span class="sxs-lookup"><span data-stu-id="c326a-255">In the search bar, enter **Seattle**, and then select the **Seattle** store for pickup.</span></span> 
7. <span data-ttu-id="c326a-256">Selecione **OK** para aceitar a data atual como a data de retirada.</span><span class="sxs-lookup"><span data-stu-id="c326a-256">Select **OK** to accept the current date as the date of pickup.</span></span>
9. <span data-ttu-id="c326a-257">Selecione **Pagar cartão** para iniciar o pagamento.</span><span class="sxs-lookup"><span data-stu-id="c326a-257">Select **Pay card** to initiate the payment.</span></span>
10. <span data-ttu-id="c326a-258">Conceda o pagamento com cartão para o valor que é devido para o depósito.</span><span class="sxs-lookup"><span data-stu-id="c326a-258">Tender the card payment for the amount that is due for the deposit.</span></span> 
11. <span data-ttu-id="c326a-259">Conclua o pagamento do depósito no terminal de pagamento.</span><span class="sxs-lookup"><span data-stu-id="c326a-259">Complete the deposit payment on the payment terminal.</span></span> 
12. <span data-ttu-id="c326a-260">Após o depósito ser pago, selecione a opção de usar o mesmo cartão para preenchimento e aguarde a conclusão da ordem.</span><span class="sxs-lookup"><span data-stu-id="c326a-260">After the deposit is paid, select the option to use the same card for fulfillment, and wait for the order to be completed.</span></span> 
13. <span data-ttu-id="c326a-261">Inicie o PDV para a loja de Seattle.</span><span class="sxs-lookup"><span data-stu-id="c326a-261">Start the POS for the Seattle store.</span></span>
14. <span data-ttu-id="c326a-262">No PDV, na página de boas-vindas, selecione a operação **Ordens para retirada** para ver as ordens de retirada na loja.</span><span class="sxs-lookup"><span data-stu-id="c326a-262">In the POS, on the welcome page, select the **Orders to pickup** operation to see the orders for in-store pickup.</span></span> 
15. <span data-ttu-id="c326a-263">Selecione uma ou mais linhas da ordem que foi criada na vitrine da referência e, em seguida, selecione **Retirar**.</span><span class="sxs-lookup"><span data-stu-id="c326a-263">Select one or more lines from the order that was created in the reference storefront, and then select **Pick up**.</span></span>

    <span data-ttu-id="c326a-264">A ordem é recuperada do back office.</span><span class="sxs-lookup"><span data-stu-id="c326a-264">The order is retrieved from the back office.</span></span> 

16. <span data-ttu-id="c326a-265">Quando os detalhes da linha de ordem são recuperados do back office e um pagamento com cartão que pode ser usado para omni-channel é detectado, você é informado de que uma forma de pagamento está disponível.</span><span class="sxs-lookup"><span data-stu-id="c326a-265">When the order line details are retrieved from the back office, and a card payment that can be used for omni-channel is detected, you're informed that a payment method is available.</span></span>
17. <span data-ttu-id="c326a-266">Selecione **Usar a forma de pagamento disponível** para concluir a transação usando os detalhes do cartão que foram inseridos na vitrine de referência.</span><span class="sxs-lookup"><span data-stu-id="c326a-266">Select **Use available payment method** to complete the transaction by using the card details that were entered in the reference storefront.</span></span>

    <span data-ttu-id="c326a-267">As linhas da ordem são carregadas na página da transação e o saldo é 0 (zero).</span><span class="sxs-lookup"><span data-stu-id="c326a-267">The order lines are loaded on the transaction page, and the balance due is 0 (zero).</span></span>

18. <span data-ttu-id="c326a-268">Selecione a guia **Pagamentos** para ver a linha de proposta retirada da ordem online.</span><span class="sxs-lookup"><span data-stu-id="c326a-268">Select the **Payments** tab to view the tender line that was pulled from the online order.</span></span> 
19. <span data-ttu-id="c326a-269">Selecione qualquer método de pagamento para concluir a transação.</span><span class="sxs-lookup"><span data-stu-id="c326a-269">Select any payment method to complete the transaction.</span></span> 

### <a name="buy-in-store-a-ship-to-customer"></a><span data-ttu-id="c326a-270">Comprar na loja A, enviar ao cliente</span><span class="sxs-lookup"><span data-stu-id="c326a-270">Buy in store A, ship to customer</span></span>

1. <span data-ttu-id="c326a-271">Inicie o PDV para a loja de Houston.</span><span class="sxs-lookup"><span data-stu-id="c326a-271">Start the POS for the Houston store.</span></span>
2. <span data-ttu-id="c326a-272">Na página **Transação**, adicione Karen Berg à transação usando o teclado numérico para inserir **2001**.</span><span class="sxs-lookup"><span data-stu-id="c326a-272">On the **Transaction** page, add Karen Berg to the transaction by using the number pad to enter **2001**.</span></span>
3. <span data-ttu-id="c326a-273">Adicione uma ou mais linhas à transação.</span><span class="sxs-lookup"><span data-stu-id="c326a-273">Add one or more lines to the transaction.</span></span>
4. <span data-ttu-id="c326a-274">Selecione **Ordens** para ver as opções de ordem.</span><span class="sxs-lookup"><span data-stu-id="c326a-274">Select **Orders** to see the order options.</span></span>
5. <span data-ttu-id="c326a-275">Selecione **Remeter tudo** e, depois, quando for solicitado, selecione **Ordem do cliente**.</span><span class="sxs-lookup"><span data-stu-id="c326a-275">Select **Ship all**, and then, when you're prompted, select **Customer order**.</span></span>
6. <span data-ttu-id="c326a-276">Na página do método de remessa, selecione **Padrão durante a noite** e, em seguida, selecione **OK** para aceitar a data de hoje como a data de envio.</span><span class="sxs-lookup"><span data-stu-id="c326a-276">In the shipping method page, select **Standard overnight**, and then select **OK** to accept today's date as the shipping date.</span></span> 
7. <span data-ttu-id="c326a-277">Selecione **OK** para aceitar a data atual como a data de retirada.</span><span class="sxs-lookup"><span data-stu-id="c326a-277">Select **OK** to accept the current date as the date of pickup.</span></span>
8. <span data-ttu-id="c326a-278">Selecione **Pagar cartão** para iniciar o pagamento.</span><span class="sxs-lookup"><span data-stu-id="c326a-278">Select **Pay card** to initiate the payment.</span></span>
9. <span data-ttu-id="c326a-279">Conceda o pagamento com cartão para o valor que é devido para o depósito.</span><span class="sxs-lookup"><span data-stu-id="c326a-279">Tender the card payment for the amount that is due for the deposit.</span></span> 
10. <span data-ttu-id="c326a-280">Conclua o pagamento do depósito no terminal de pagamento.</span><span class="sxs-lookup"><span data-stu-id="c326a-280">Complete the deposit payment on the payment terminal.</span></span> 
11. <span data-ttu-id="c326a-281">Após o depósito ser pago, selecione a opção de usar o mesmo cartão para preenchimento e aguarde a conclusão da ordem.</span><span class="sxs-lookup"><span data-stu-id="c326a-281">After the deposit is paid, select the option to use the same card for fulfillment, and wait for the order to be completed.</span></span>

<span data-ttu-id="c326a-282">Quando a ordem é retirada, embalada e faturada no back office, os detalhes de pagamento que são fornecidos no PDV serão usados para capturar os fundos para as mercadorias que estão sendo enviadas para o cliente.</span><span class="sxs-lookup"><span data-stu-id="c326a-282">When the order is picked, packed, and invoiced in the back office, the payment details that are provided at the POS will be used to capture the funds for the goods that are being shipped to the customer.</span></span> 

## <a name="scenario-details"></a><span data-ttu-id="c326a-283">Detalhes do cenário</span><span class="sxs-lookup"><span data-stu-id="c326a-283">Scenario details</span></span>

<span data-ttu-id="c326a-284">Além dos cenários básicos que acabamos de descrever, vários aprimoramentos foram feitos no SDK de pagamentos para oferecer suporte a pagamentos de omni-channel.</span><span class="sxs-lookup"><span data-stu-id="c326a-284">In addition to the basic scenarios that were just described, several enhancements have been made to the Payments SDK to support omni-channel payments.</span></span> 

### <a name="pos"></a><span data-ttu-id="c326a-285">PDV</span><span class="sxs-lookup"><span data-stu-id="c326a-285">POS</span></span>

#### <a name="single-swipedip-for-customer-orders"></a><span data-ttu-id="c326a-286">Passar/inserir apenas uma vez para ordens de cliente</span><span class="sxs-lookup"><span data-stu-id="c326a-286">Single swipe/dip for customer orders</span></span>

<span data-ttu-id="c326a-287">Antes que o recurso de pagamentos de omni-channel fosse implementado, quando as ordens dos clientes que incluíam depósitos eram criadas no PDV, os clientes precisavam passar duas vezes o cartão: uma vez para pagar o depósito e uma vez para tokenizar o cartão para cumprimento subsequente da ordem.</span><span class="sxs-lookup"><span data-stu-id="c326a-287">Before the omni-channel payments feature was implemented, when customer orders that included deposits were created at the POS, customers were required to swipe (or dip) their card two times: one time to pay the deposit and one time to tokenize the card for subsequent order fulfillment.</span></span> <span data-ttu-id="c326a-288">Quando o recurso de tokenização de omni-channel está ativado, os clientes devem passar o cartão apenas uma vez para pagar o depósito e autorizar o valor devido para as mercadorias que serão atendidas posteriormente.</span><span class="sxs-lookup"><span data-stu-id="c326a-288">When the omni-channel tokenization feature is turned on, customers must swipe their card only one time to both pay the deposit and authorize the amount that is due for goods that will be fulfilled later.</span></span> <span data-ttu-id="c326a-289">No momento do cumprimento, os fundos autorizados são capturados.</span><span class="sxs-lookup"><span data-stu-id="c326a-289">At the time of fulfillment, the authorized funds are captured.</span></span> <span data-ttu-id="c326a-290">Antes de o recurso de tokenização de omni-channel ser implementado, apenas um token de cartão recorrente era criado para o cumprimento subsequente da ordem.</span><span class="sxs-lookup"><span data-stu-id="c326a-290">Before the omni-channel tokenization feature was implemented, only a recurring card token was created for subsequent order fulfillment.</span></span> <span data-ttu-id="c326a-291">Portanto, os fundos para o cumprimento pendente não foram autorizados e, como esses fundos não estavam sendo mantidos para essa compra específica, era menos provável que eles pudessem ser capturados posteriormente.</span><span class="sxs-lookup"><span data-stu-id="c326a-291">Therefore, the funds for the pending fulfillment weren't authorized, and because those funds weren't being held for that specific purchase, it was less likely that they could be captured later.</span></span>

> [!NOTE]
> <span data-ttu-id="c326a-292">Não é possível passar apenas uma vez na versão 8.1.3 do Retail.</span><span class="sxs-lookup"><span data-stu-id="c326a-292">Single swipe isn't supported in Retail version 8.1.3.</span></span> <span data-ttu-id="c326a-293">Ordens de clientes na versão 8.1.3 usam o mesmo fluxo que foi usado antes que o recurso de tokenização de omni-channel fosse implementado.</span><span class="sxs-lookup"><span data-stu-id="c326a-293">Customer orders in version 8.1.3 use the same flow that was used before the omni-channel tokenization feature was implemented.</span></span> 

### <a name="cards-that-cant-issue-recurring-card-tokens"></a><span data-ttu-id="c326a-294">Cartões que não podem emitir tokens de cartão recorrentes</span><span class="sxs-lookup"><span data-stu-id="c326a-294">Cards that can't issue recurring card tokens</span></span>

<span data-ttu-id="c326a-295">Alguns cartões não podem ser usados para pagamentos de omni-channel, porque eles não permitem a emissão de tokens de cartão recorrentes.</span><span class="sxs-lookup"><span data-stu-id="c326a-295">Some cards can't be used for omni-channel payments, because they don't support issuing recurring card tokens.</span></span> <span data-ttu-id="c326a-296">Quando uma ordem é criada no PDV, se o depósito é pago usando um cartão que não é compatível com tokens de cartão recorrentes, o fluxo de tokenização de cartão anterior é usado.</span><span class="sxs-lookup"><span data-stu-id="c326a-296">When an order is created at the POS, if the deposit is paid by using a card that doesn't support recurring card tokens, the previous card tokenization flow is used.</span></span> <span data-ttu-id="c326a-297">Portanto, um cliente que deseja fornecer um pagamento que será usado para o cumprimento subsequente da ordem deve apresentar um segundo cartão.</span><span class="sxs-lookup"><span data-stu-id="c326a-297">Therefore, a customer who wants to provide a payment that will be used for subsequent order fulfillment must present a second card.</span></span> <span data-ttu-id="c326a-298">Se o segundo cartão não permitir tokens de cartão recorrentes, a ação de tokenização será recusada e o caixa será solicitado a pedir ao cliente que forneça um cartão diferente.</span><span class="sxs-lookup"><span data-stu-id="c326a-298">If the second card doesn't support recurring card tokens, the tokenization action will be declined, and the cashier will be prompted to ask the customer to provide a different card.</span></span> 

### <a name="using-a-different-card"></a><span data-ttu-id="c326a-299">Usando um cartão diferente</span><span class="sxs-lookup"><span data-stu-id="c326a-299">Using a different card</span></span>

<span data-ttu-id="c326a-300">Um cliente que chega à loja para retirada de ordem tem a opção de usar um cartão diferente.</span><span class="sxs-lookup"><span data-stu-id="c326a-300">A customer who comes to the store for order pickup has the option to use a different card.</span></span> <span data-ttu-id="c326a-301">Quando o caixa recebe o prompt **Usar a forma de pagamento disponível** no momento da retirada da ordem, ele pode perguntar se o cliente quer usar o mesmo cartão.</span><span class="sxs-lookup"><span data-stu-id="c326a-301">When the cashier receives the **Use available payment method** prompt at the time of order pickup, he or she can ask whether the customer wants to use the same card.</span></span> <span data-ttu-id="c326a-302">Se o cliente tiver perdido o cartão usado para criar a ordem e quiser pagar pela ordem usando um cartão diferente, o caixa poderá selecionar **Usar uma forma de pagamento diferente**.</span><span class="sxs-lookup"><span data-stu-id="c326a-302">If the customer has lost the card that was used to create the order and wants to pay for the order by using a different card, the cashier can select **Use a different payment method**.</span></span> <span data-ttu-id="c326a-303">Se o cliente voltar mais tarde para buscar mais itens da mesma ordem, se a autorização original do cartão ainda for válida, o caixa poderá perguntar novamente se o cliente deseja usar esse cartão.</span><span class="sxs-lookup"><span data-stu-id="c326a-303">If the customer comes back later to pick up more items for the same order, if the original card authorization is still valid, the cashier can again ask whether the customer wants to use that card.</span></span>

### <a name="invalid-authorizations"></a><span data-ttu-id="c326a-304">Autorizações inválidas</span><span class="sxs-lookup"><span data-stu-id="c326a-304">Invalid authorizations</span></span>

<span data-ttu-id="c326a-305">Se o cartão usado para criar uma ordem não for mais válido, quando os produtos forem selecionados para retirada, a solicitação de captura de pagamento falhará.</span><span class="sxs-lookup"><span data-stu-id="c326a-305">If the card that was used to create an order is no longer valid, when products are selected for pickup, the payment capture request will fail.</span></span> <span data-ttu-id="c326a-306">O conector de pagamento de PDV tentará criar uma autorização e capturar usando os mesmos detalhes do cartão.</span><span class="sxs-lookup"><span data-stu-id="c326a-306">The POS payment connector will then try to create a new authorization and capture by using the same card details.</span></span> <span data-ttu-id="c326a-307">Se a nova autorização ou captura falhar, o caixa será informado de que o pagamento não pôde ser processado.</span><span class="sxs-lookup"><span data-stu-id="c326a-307">If the new authorization or capture fails, the cashier will be informed that the payment could not be processed.</span></span> <span data-ttu-id="c326a-308">O caixa deve então receber um novo pagamento do cliente.</span><span class="sxs-lookup"><span data-stu-id="c326a-308">The cashier must then get a new payment from the customer.</span></span> 

### <a name="multiple-available-payments"></a><span data-ttu-id="c326a-309">Vários pagamentos disponíveis</span><span class="sxs-lookup"><span data-stu-id="c326a-309">Multiple available payments</span></span>

<span data-ttu-id="c326a-310">Quando uma ordem que tem várias propostas e várias linhas é selecionado, o caixa primeiro recebe o prompt **Usar a forma de pagamento disponível**.</span><span class="sxs-lookup"><span data-stu-id="c326a-310">When an order that has multiple tenders and multiple lines is picked up, the cashier first receives the **Use available payment method** prompt.</span></span> <span data-ttu-id="c326a-311">Se houver vários cartões, quando o caixa selecionar **Usar a forma de pagamento disponível**, as linhas de cartão existentes serão capturadas até que o saldo seja atendido para as mercadorias que estão sendo retiradas atualmente.</span><span class="sxs-lookup"><span data-stu-id="c326a-311">If there are multiple cards, when the cashier selects **Use available payment method**, existing card tender lines will be captured until the balance is met for the goods that are currently being picked up.</span></span> <span data-ttu-id="c326a-312">O caixa não terá a opção de selecionar o cartão que deve ser usado para as mercadorias que estão sendo retiradas.</span><span class="sxs-lookup"><span data-stu-id="c326a-312">The cashier won't have the option to select the card that should be used for the goods that are being picked up.</span></span> 

## <a name="related-topics"></a><span data-ttu-id="c326a-313">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="c326a-313">Related topics</span></span>

- [<span data-ttu-id="c326a-314">Perguntas frequentes sobre pagamentos</span><span class="sxs-lookup"><span data-stu-id="c326a-314">Payments FAQ</span></span>](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/payments-retail)
- [<span data-ttu-id="c326a-315">Conector de Pagamento do Dynamics 365 para Adyen</span><span class="sxs-lookup"><span data-stu-id="c326a-315">Dynamics 365 Payment Connector for Adyen</span></span>](https://docs.microsoft.com/dynamics365/unified-operations/retail/dev-itpro/adyen-connector?tabs=8-1-3)
- [<span data-ttu-id="c326a-316">Configurar BOPIS em um ambiente de avaliação do Dynamics 365 Commerce</span><span class="sxs-lookup"><span data-stu-id="c326a-316">Configure BOPIS in a Dynamics 365 Commerce evaluation environment</span></span>](https://docs.microsoft.com/dynamics365/commerce/cpe-bopis)

