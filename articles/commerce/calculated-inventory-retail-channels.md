---
title: Calcular disponibilidade de estoque para canais de varejo
description: Este tópico descreve como uma empresa pode usar o Microsoft Dynamics 365 Commerce para verificar a disponibilidade estimada de produtos nos canais online e na loja.
author: hhainesms
ms.date: 04/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: hhaines
ms.search.validFrom: 2020-02-11
ms.dyn365.ops.version: Release 10.0.10
ms.openlocfilehash: fdf6df7e393bcc401e770bd1b8afcaedcadc2660
ms.sourcegitcommit: 593438a145672c55ff6a910eabce2939300b40ad
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/23/2021
ms.locfileid: "5937425"
---
# <a name="calculate-inventory-availability-for-retail-channels"></a><span data-ttu-id="cb732-103">Calcular disponibilidade de estoque para canais de varejo</span><span class="sxs-lookup"><span data-stu-id="cb732-103">Calculate inventory availability for retail channels</span></span>

[!include [banner](../includes/banner.md)]
[!include [banner](includes/preview-banner.md)]

<span data-ttu-id="cb732-104">Este tópico descreve como uma empresa pode usar o Microsoft Dynamics 365 Commerce para verificar a disponibilidade estimada de produtos nos canais online e na loja.</span><span class="sxs-lookup"><span data-stu-id="cb732-104">This topic describes how a company can use Microsoft Dynamics 365 Commerce to view estimated on-hand availability for products in the online and store channels.</span></span>

## <a name="accuracy-of-inventory-availability"></a><span data-ttu-id="cb732-105">Precisão da disponibilidade do estoque</span><span class="sxs-lookup"><span data-stu-id="cb732-105">Accuracy of inventory availability</span></span>

<span data-ttu-id="cb732-106">O Commerce usa vários servidores e bancos de dados para garantir escalabilidade e desempenho.</span><span class="sxs-lookup"><span data-stu-id="cb732-106">Commerce uses multiple servers and databases to ensure scalability and performance.</span></span> <span data-ttu-id="cb732-107">Portanto, é importante que você entenda que os valores de estoque disponíveis fornecidos pelo aplicativo de ponto de venda (PDV), pelas APIs (interfaces de programação de aplicativos de disponibilidade de estoque de comércio eletrônico) e pelas páginas de estoque disponíveis no Commerce headquarters podem não ser 100% precisos em tempo real.</span><span class="sxs-lookup"><span data-stu-id="cb732-107">Therefore, it's important that you understand that the available inventory values that are provided through the point of sale (POS) application, the e-commerce inventory availability application programming interfaces (APIs), and the on-hand inventory pages in Commerce headquarters might not be 100 percent accurate in real time.</span></span> <span data-ttu-id="cb732-108">Se as transações criadas para produtos no canal online ou na loja ainda não foram sincronizadas com o headquarters, as páginas de estoque disponíveis no headquarters talvez não exibam o valor exato do estoque em tempo real desses produtos.</span><span class="sxs-lookup"><span data-stu-id="cb732-108">If transactions that are created for products in the online or store channel haven't yet been synced to headquarters, the on-hand inventory pages in headquarters might not show an accurate real-time inventory value for those products.</span></span> <span data-ttu-id="cb732-109">Por outro lado, se você configurou sua empresa para que os usuários no headquarters ou em outros aplicativos integrados possam vender, receber, devolver ou ajustar o estoque de uma loja ou depósito online, talvez o PDV ou o canal online não tenha todas as informações necessárias para mostrar valores precisos em tempo real dos itens.</span><span class="sxs-lookup"><span data-stu-id="cb732-109">Conversely, if you configured your company so that users in headquarters or other integrated applications can sell, receive, return, or otherwise adjust inventory out of a store or online warehouse, the POS or online channel might not have all the information that is required to show accurate real-time values for items.</span></span>

<span data-ttu-id="cb732-110">É fundamental que você entenda que todos os dados de disponibilidade fornecidos durante o dia operacional são considerados um valor estimado.</span><span class="sxs-lookup"><span data-stu-id="cb732-110">It's critical to understand that all on-hand availability data that is provided during the operational day is considered an estimated value.</span></span> <span data-ttu-id="cb732-111">Portanto, se você tentar comparar as informações de estoque disponíveis que o aplicativo fornece com o estoque físico real nas prateleiras ou se tentar comparar os valores disponíveis mostrados no PDV com os dados disponíveis encontrados no mesmo depósito na sede do headquarters, os valores podem ser diferentes.</span><span class="sxs-lookup"><span data-stu-id="cb732-111">Therefore, if you try to compare the on-hand inventory information that the application provides with actual physical inventory on the shelves, or if you try to compare the on-hand values that are shown in POS with the on-hand data that you find for the same warehouse in headquarters, the values might differ.</span></span> <span data-ttu-id="cb732-112">Essa diferença durante o dia operacional é esperada e não deve ser considerada um problema.</span><span class="sxs-lookup"><span data-stu-id="cb732-112">This difference during the operational day is expected and should not be considered an issue.</span></span> <span data-ttu-id="cb732-113">Se você deseja auditar dados e garantir que os valores fornecidos em PDV, APIs e headquarters correspondam às unidades físicas reais encontradas nas prateleiras de sua loja ou depósito, o melhor momento para fazer isso é quando as operações do canal tiverem sido interrompidas durante o dia e todas as transações tiverem sido sincronizadas corretamente entre o headquarters e o canal.</span><span class="sxs-lookup"><span data-stu-id="cb732-113">If you want to audit data and make sure that the values provided in POS, APIs, and headquarters match the actual physical units that you find on your store or warehouse shelves, the best time to do it is after channel operations have stopped for the day and all transactions have been correctly synced between headquarters and the channels.</span></span>

## <a name="channel-side-inventory-calculation"></a><span data-ttu-id="cb732-114">Cálculo de estoque do canal</span><span class="sxs-lookup"><span data-stu-id="cb732-114">Channel-side inventory calculation</span></span>

<span data-ttu-id="cb732-115">O cálculo de estoque do canal é um mecanismo que pega os últimos dados de estoque de canal conhecidos no Commerce headquarters como uma linha de base e, em seguida, separa em alterações de estoque adicionais que ocorreram no canal, que não estão incluídas nessa linha de base, para calcular um estoque disponível previsto quase em tempo real.</span><span class="sxs-lookup"><span data-stu-id="cb732-115">The channel-side inventory calculation is a mechanism that takes the last-known channel inventory data in Commerce headquarters as a baseline, and then factors in additional inventory changes that occurred on the channel side that aren't included in that baseline to calculate a near-real-time estimated on-hand inventory.</span></span> 

<span data-ttu-id="cb732-116">As alterações de estoque a seguir são consideradas atualmente na lógica de cálculo de estoque do canal:</span><span class="sxs-lookup"><span data-stu-id="cb732-116">The following inventory changes are currently considered in the channel-side inventory calculation logic:</span></span>

- <span data-ttu-id="cb732-117">Estoque vendido por meio de ordens de cash and carry na loja</span><span class="sxs-lookup"><span data-stu-id="cb732-117">Inventory sold through cash-and-carry orders in store</span></span>
- <span data-ttu-id="cb732-118">Estoque vendido por meio de ordens de cliente na loja ou no canal online</span><span class="sxs-lookup"><span data-stu-id="cb732-118">Inventory sold through customer orders in store or online channel</span></span>
- <span data-ttu-id="cb732-119">Estoque devolvido para loja</span><span class="sxs-lookup"><span data-stu-id="cb732-119">Inventory returned to store</span></span>
- <span data-ttu-id="cb732-120">Estoque atendido (separação, embalagem, remessa) do depósito da loja</span><span class="sxs-lookup"><span data-stu-id="cb732-120">Inventory fulfilled (pick, pack, ship) from store warehouse</span></span>

<span data-ttu-id="cb732-121">Para usar o cálculo de estoque do canal, como um pré-requisito, um instantâneo periódico de dados de estoque do headquarters criado pelo trabalho **Disponibilidade do produto** deve ser enviado aos bancos de dados de canais.</span><span class="sxs-lookup"><span data-stu-id="cb732-121">To use the channel-side inventory calculation, as a prerequisite a periodic snapshot of inventory data from headquarters created by the **Product availability** job must be sent to the channel databases.</span></span> <span data-ttu-id="cb732-122">O instantâneo representa as informações que o headquarters tem sobre a disponibilidade de estoque quanto a uma combinação específica de um produto ou variante de produto e um depósito.</span><span class="sxs-lookup"><span data-stu-id="cb732-122">The snapshot represents the information that headquarters has about inventory availability for a specific combination of a product or product variant and a warehouse.</span></span> <span data-ttu-id="cb732-123">Ele inclui somente as transações de estoque que foram processadas e lançadas no headquarters no momento em que o instantâneo foi obtido e talvez não seja 100% preciso em tempo real devido ao processamento de vendas constante que ocorre entre os servidores distribuídos.</span><span class="sxs-lookup"><span data-stu-id="cb732-123">It includes only the inventory transactions that were processed and posted in headquarters at the time when the snapshot was taken, and it might not be 100 percent accurate in real time because of the constant sales processing that occurs across distributed servers.</span></span>

- <span data-ttu-id="cb732-124">Se o estoque foi vendido para um produto em uma loja por meio de uma ordem de venda do cliente cash-and-carry ou assíncrona no aplicativo de PDV, o headquarters não terá imediatamente as informações sobre a transação de emissão de estoque relacionada da venda.</span><span class="sxs-lookup"><span data-stu-id="cb732-124">If inventory was sold for a product in a store through a cash-and-carry or asynchronous customer order sale in the POS application, headquarters won't immediately have information about the related inventory issue transaction for the sale.</span></span> <span data-ttu-id="cb732-125">O headquarters terá informações sobre o estoque vendido em relação a esses tipos de vendas da loja só após o trabalho P carregar a transação relacionada usando o banco de dados do canal da loja para o headquarters e as ordens de venda relacionadas serem criadas por meio do lançamento de demonstrativos ou dos processos de lançamento de fluxo constante.</span><span class="sxs-lookup"><span data-stu-id="cb732-125">Headquarters will have information about the inventory that is sold for these types of store sales only after the P-job uploads the related transaction from the store's channel database into headquarters and the related sales orders are created through statement posting or the trickle feed posting processes.</span></span> <span data-ttu-id="cb732-126">O processo de criação das ordens no headquarters cria as transações de estoque relacionadas.</span><span class="sxs-lookup"><span data-stu-id="cb732-126">The process of creating the orders in headquarters creates the related inventory transactions.</span></span> 
- <span data-ttu-id="cb732-127">Para ordens de canal de comércio eletrônico, o headquarters tem informações sobre as transações de estoque somente depois que as transações são enviadas ao headquarters por meio do trabalho P e o processo de sincronização da ordem é concluído.</span><span class="sxs-lookup"><span data-stu-id="cb732-127">For e-commerce channel orders, headquarters has information about the inventory transactions only after the transactions are sent to headquarters through the P-job and the order synchronization process is completed.</span></span>

<span data-ttu-id="cb732-128">Para obter um instantâneo do estoque no Commerce headquarters, siga as etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="cb732-128">To take a snapshot of inventory in Commerce headquarters, follow these steps.</span></span>

1. <span data-ttu-id="cb732-129">Vá para **Varejo e Comércio \> TI de Varejo e Comércio \> Produtos e estoque \> Disponibilidade do produto**.</span><span class="sxs-lookup"><span data-stu-id="cb732-129">Go to **Retail and Commerce \> Retail and Commerce IT \> Products and inventory \> Product availability**.</span></span>
1. <span data-ttu-id="cb732-130">Selecione **OK** para executar o trabalho **Disponibilidade do produto**.</span><span class="sxs-lookup"><span data-stu-id="cb732-130">Select **OK** to run the **Product availability** job.</span></span> <span data-ttu-id="cb732-131">Você também pode programar esse trabalho para que seja executado em lote.</span><span class="sxs-lookup"><span data-stu-id="cb732-131">You can also schedule this job to run in batch.</span></span>

<span data-ttu-id="cb732-132">Após a execução do trabalho **Disponibilidade do produto**, os dados coletados devem ser enviados para os bancos de dados do canal de comércio eletrônico, a fim de que o último instantâneo do estoque do headquarters possa ser considerado no cálculo do canal do estoque disponível estimado.</span><span class="sxs-lookup"><span data-stu-id="cb732-132">After the **Product availability** job has finished running, the data that was captured must be pushed to the channel databases, so that the latest headquarters inventory snapshot can be considered in the channel-side calculation of estimated on-hand inventory.</span></span>

<span data-ttu-id="cb732-133">Para sincronizar os dados de instantâneo do headquarters com os bancos de dado de canal, siga estas etapas.</span><span class="sxs-lookup"><span data-stu-id="cb732-133">To sync snapshot data from headquarters to your channel databases, follow these steps.</span></span>

1. <span data-ttu-id="cb732-134">Vá para **Varejo e Comércio \> TI de Varejo e Comércio \> Agenda de distribuição**.</span><span class="sxs-lookup"><span data-stu-id="cb732-134">Go to **Retail and Commerce \> Retail and Commerce IT \> Distribution schedule**.</span></span>
1. <span data-ttu-id="cb732-135">Execute o trabalho **1130** (**Disponibilidade do produto**) para sincronizar os dados do instantâneo que o trabalho **Disponibilidade do produto** criou do headquarters para os bancos de dados do canal.</span><span class="sxs-lookup"><span data-stu-id="cb732-135">Run the **1130** (**Product availability**) job to sync the snapshot data that the **Product availability** job has created from headquarters to your channel databases.</span></span>

## <a name="inventory-availability-apis-for-e-commerce"></a><span data-ttu-id="cb732-136">APIs de disponibilidade de estoque para o comércio eletrônico</span><span class="sxs-lookup"><span data-stu-id="cb732-136">Inventory availability APIs for e-commerce</span></span>

<span data-ttu-id="cb732-137">O Commerce fornece as seguintes APIs para cenários de comércio eletrônico para consultar a disponibilidade de estoque de um produto:</span><span class="sxs-lookup"><span data-stu-id="cb732-137">Commerce provides the following APIs for e-commerce scenarios to query inventory availability of a product:</span></span>

- <span data-ttu-id="cb732-138">**GetEstimatedAvailability** – Use esta API para consultar o estoque de um produto ou variante de produto no depósito de canal online ou nos depósitos vinculados ao grupo de preenchimento do canal online.</span><span class="sxs-lookup"><span data-stu-id="cb732-138">**GetEstimatedAvailability** – Use this API to query inventory for a product or product variant in the online channel warehouse or warehouses that are linked to the online channel's fulfillment group.</span></span>
- <span data-ttu-id="cb732-139">**GetEstimatedProductWarehouseAvailability** – Use esta API para consultar estoque de um produto ou variante do produto de um depósito específico.</span><span class="sxs-lookup"><span data-stu-id="cb732-139">**GetEstimatedProductWarehouseAvailability** – Use this API to query inventory for a product or product variant from a specific warehouse.</span></span>

> [!NOTE]
> <span data-ttu-id="cb732-140">Essas APIs substituem as APIs **GetProductAvailabilities** e **GetAvailableInventoryNearby** na versão 10.0.7 e anterior do Commerce.</span><span class="sxs-lookup"><span data-stu-id="cb732-140">These APIs replace the **GetProductAvailabilities** and **GetAvailableInventoryNearby** APIs in Commerce release 10.0.7 and earlier.</span></span>

<span data-ttu-id="cb732-141">Ambas as APIs usam internamente a lógica de cálculo do canal e retornam a quantidade **física disponível** estimada, quantidade **disponível total**, **unidade de medida (UdM)** e o **nível de estoque** para o produto e o depósito solicitados.</span><span class="sxs-lookup"><span data-stu-id="cb732-141">Both APIs internally use the channel-side calculation logic and return estimated **physical available** quantity, **total available** quantity, **unit of measure (UoM)**, and **inventory level** for the requested product and warehouse.</span></span> <span data-ttu-id="cb732-142">Os valores retornados podem ser mostrados no seu site de comércio eletrônico, se você preferir, ou podem ser usados para acionar outra lógica comercial no seu site de comércio eletrônico.</span><span class="sxs-lookup"><span data-stu-id="cb732-142">The returned values can be shown on your e-commerce site if you want, or they can be used to trigger other business logic on your e-commerce site.</span></span> <span data-ttu-id="cb732-143">Por exemplo, você pode impedir a compra de produtos com um nível de estoque "fora de estoque".</span><span class="sxs-lookup"><span data-stu-id="cb732-143">For example, you can prevent the purchase of products with an "out of stock" inventory level.</span></span>

<span data-ttu-id="cb732-144">Embora outras APIs disponíveis no Commerce possam ser utilizadas diretamente no headquarters para buscar as quantidades de produtos disponíveis, não recomendamos que elas sejam usadas em um ambiente de comércio eletrônico por causa de possíveis problemas de desempenho e impacto relacionado que essas solicitações frequentes podem ter nos servidores da sede do headquarters.</span><span class="sxs-lookup"><span data-stu-id="cb732-144">Although other APIs that are available in Commerce can go directly to headquarters to fetch on-hand quantities for products, we don't recommend that they be used in an e-commerce environment because of potential performance issues and the impact that these frequent requests can have on your headquarters servers.</span></span> <span data-ttu-id="cb732-145">Além disso, com o cálculo do canal, as duas APIs mencionadas acima podem fornecer uma estimativa mais precisa da disponibilidade de um produto ao levar em conta as transações criadas nos canais que ainda não foram conhecidas pela matriz.</span><span class="sxs-lookup"><span data-stu-id="cb732-145">Additionally, with channel-side calculation, the two APIs mentioned above can provide a more accurate estimate of a product's availability by taking into account the transactions created in the channels that aren’t yet known to headquarters.</span></span>

<span data-ttu-id="cb732-146">Para usar as duas APIs, você deve habilitar o recurso **Cálculo otimizado de disponibilidade de produtos** pelo espaço de trabalho **Gerenciamento de recursos** no headquarters.</span><span class="sxs-lookup"><span data-stu-id="cb732-146">To use the two APIs, you must enable the **Optimized product availability calculation** feature through the **Feature management** workspace in headquarters.</span></span> <span data-ttu-id="cb732-147">Se os canais online e de armazenamento usarem os mesmos depósitos de atendimento, você também deverá habilitar o recurso **Lógica de cálculo de estoque do canal de comércio eletrônico avançado** para ter a lógica de cálculo do canal dentro das duas APIs para levar em consideração nas transações não lançadas (cash-and-carry, ordens do cliente, devoluções) criadas no canal da loja.</span><span class="sxs-lookup"><span data-stu-id="cb732-147">If your online and store channels use the same fulfillment warehouses, you must also enable the **Enhanced e-Commerce channel-side inventory calculation logic** feature to have the channel-side calculation logic within the two APIs to factor in the unposted transactions (cash-and-carry, customer orders, returns) created in the store channel.</span></span> <span data-ttu-id="cb732-148">Será necessário executar o trabalho **1070** (**Configuração do canal**) após habilitar esses recursos.</span><span class="sxs-lookup"><span data-stu-id="cb732-148">You will need to run the **1070** (**Channel configuration**) job after enabling these features.</span></span>

<span data-ttu-id="cb732-149">Para definir como a quantidade de produto deve ser retornada na saída da API, siga estas etapas.</span><span class="sxs-lookup"><span data-stu-id="cb732-149">To define how product quantity should be returned in the API output, follow these steps.</span></span>

1. <span data-ttu-id="cb732-150">Vá para **Retail e Commerce \> Configuração da sede \> Parâmetros \> Parâmetros do Commerce**.</span><span class="sxs-lookup"><span data-stu-id="cb732-150">Go to **Retail and Commerce \> Headquarters setup \> Parameters \> Commerce parameters**.</span></span>
1. <span data-ttu-id="cb732-151">Selecione a guia **Estoque** e, em seguida, na FastTab **APIs de disponibilidade de estoque para comércio eletrônico** configure o valor da configuração **Quantidade na saída da API**.</span><span class="sxs-lookup"><span data-stu-id="cb732-151">Select the **Inventory** tab, and then on the **Inventory availability APIs for e-Commerce** FastTab configure the value of the **Quantity in API output** setting.</span></span>
1. <span data-ttu-id="cb732-152">Execute o trabalho **1070** (**configuração do canal**) para sincronizar a última configuração para os canais.</span><span class="sxs-lookup"><span data-stu-id="cb732-152">Run the **1070** (**Channel configuration**) job to sync the latest setting to channels.</span></span>

<span data-ttu-id="cb732-153">A configuração **Quantidade na saída da API** fornece três opções:</span><span class="sxs-lookup"><span data-stu-id="cb732-153">The **Quantity in API output** setting provides three options:</span></span>

- <span data-ttu-id="cb732-154">**Devolver quantidade de estoque** -quantidade disponível total e disponível física de um produto solicitado são devolvidas na saída da API.</span><span class="sxs-lookup"><span data-stu-id="cb732-154">**Return inventory quantity** - Physical available and total available quantity of a requested product are returned in API output.</span></span>
- <span data-ttu-id="cb732-155">**Devolver quantidade de estoque subtraindo buffer de estoque** - A quantidade devolvida na saída da API é ajustada subtraindo-se o valor do buffer de estoque.</span><span class="sxs-lookup"><span data-stu-id="cb732-155">**Return inventory quantity subtracting inventory buffer** - The quantity returned in the API output is adjusted by subtracting the inventory buffer value.</span></span> <span data-ttu-id="cb732-156">Para obter mais informações sobre o buffer de estoque, consulte [Configurar buffers de estoque e níveis de estoque](inventory-buffers-levels.md).</span><span class="sxs-lookup"><span data-stu-id="cb732-156">For more information about the inventory buffer, see [Configure inventory buffers and inventory levels](inventory-buffers-levels.md).</span></span>
- <span data-ttu-id="cb732-157">**Não devolver quantidade de estoque** - Somente o nível de estoque é retornado na saída da API.</span><span class="sxs-lookup"><span data-stu-id="cb732-157">**Not return inventory quantity** - Only the inventory level is returned in the API output.</span></span> <span data-ttu-id="cb732-158">Para obter mais informações sobre os níveis de estoque, consulte [Configurar buffers de estoque e níveis de estoque](inventory-buffers-levels.md).</span><span class="sxs-lookup"><span data-stu-id="cb732-158">For more information about inventory levels, see [Configure inventory buffers and inventory levels](inventory-buffers-levels.md).</span></span>

<span data-ttu-id="cb732-159">Você pode usar o parâmetro da API `QuantityUnitTypeValue` para especificar o tipo de unidade no qual você deseja que as APIs devolvam a quantidade.</span><span class="sxs-lookup"><span data-stu-id="cb732-159">You can use the `QuantityUnitTypeValue` API parameter to specify the unit type in which you would like the APIs to return quantity.</span></span> <span data-ttu-id="cb732-160">Esse parâmetro oferece suporte a opções de **unidade de estoque** (padrão), **unidade de compra** e **unidade de venda**.</span><span class="sxs-lookup"><span data-stu-id="cb732-160">This parameter supports the **inventory unit** (default), **purchase unit**, and **sell unit** options.</span></span> <span data-ttu-id="cb732-161">A quantidade devolvida é arredondada para a precisão definida da unidade de medida (UOM) correspondente na matriz.</span><span class="sxs-lookup"><span data-stu-id="cb732-161">The returned quantity is rounded to the defined precision of the corresponding unit of measure (UOM) in headquarters.</span></span>

<span data-ttu-id="cb732-162">A API **GetEstimatedAvailability** oferece os seguintes parâmetros de entrada para oferecer suporte a diferentes cenários de consulta:</span><span class="sxs-lookup"><span data-stu-id="cb732-162">The **GetEstimatedAvailability** API offers the following input parameters to support different query scenarios:</span></span>

- <span data-ttu-id="cb732-163">`DefaultWarehouseOnly` - Use este parâmetro para consultar o estoque de um produto no depósito padrão do canal online.</span><span class="sxs-lookup"><span data-stu-id="cb732-163">`DefaultWarehouseOnly` - Use this parameter to query inventory for a product in the online channel's default warehouse.</span></span> 
- <span data-ttu-id="cb732-164">`FilterByChannelFulfillmentGroup` e `SearchArea` - Use esses dois parâmetros para consultar o estoque de um produto de todos os locais de retirada em uma área de pesquisa específica, com base em `longitude`, `latitude` e `radius`.</span><span class="sxs-lookup"><span data-stu-id="cb732-164">`FilterByChannelFulfillmentGroup` and `SearchArea` - Use these two parameters to query inventory for a product from all pickup locations within a specific search area, based on `longitude`, `latitude`, and `radius`.</span></span> 
- <span data-ttu-id="cb732-165">`FilterByChannelFulfillmentGroup` e `DeliveryModeTypeFilterValue` - Use esses dois parâmetros para consultar o estoque de um produto de depósitos específicos vinculados ao grupo de preenchimento do canal online e são configurados para dar suporte a certos modos de entrega.</span><span class="sxs-lookup"><span data-stu-id="cb732-165">`FilterByChannelFulfillmentGroup` and `DeliveryModeTypeFilterValue` - Use these two parameters to query inventory for a product from specific warehouses that are linked to an online channel's fulfillment group and are configured to support certain modes of delivery.</span></span> <span data-ttu-id="cb732-166">O parâmetro `DeliveryModeTypeFilterValue` oferece suporte às opções **tudo** (padrão), **remessa** e **retirada**.</span><span class="sxs-lookup"><span data-stu-id="cb732-166">The `DeliveryModeTypeFilterValue` parameter supports the **all** (default), **shipping**, and **pickup** options.</span></span> <span data-ttu-id="cb732-167">Por exemplo, em um cenário no qual uma ordem online pode ser executada a partir de vários depósitos de remessa, você pode usar esses dois parâmetros para consultar a disponibilidade de estoque de um produto em todos esses depósitos de remessa.</span><span class="sxs-lookup"><span data-stu-id="cb732-167">For example, in a scenario where an online order can be fulfilled from multiple shipping warehouses, you can use these two parameters to query a product's inventory availability in all of those shipping warehouses.</span></span> <span data-ttu-id="cb732-168">Nesse caso, a API retorna a quantidade disponível e o nível de estoque do produto em cada depósito de remessa, além de uma quantidade agregada e um nível de estoque agregado de todos os depósitos de remessa no escopo da consulta.</span><span class="sxs-lookup"><span data-stu-id="cb732-168">The API in this case returns the product's on-hand quantity and inventory level in each of the shipping warehouses, plus an aggregated quantity and an aggregated inventory level from all shipping warehouses in the query scope.</span></span>
 
<span data-ttu-id="cb732-169">Os módulos do ícone do carrinho, caixa de compra, seletor de armazenamento, lista de desejos e carrinho do Commerce consomem as APIs e os parâmetros mencionados acima para exibir mensagens no nível de estoque no site de comércio eletrônico.</span><span class="sxs-lookup"><span data-stu-id="cb732-169">The Commerce buy box, store selector, wishlist, cart, and cart icon modules consume the APIs and parameters mentioned above to display inventory level messages across the e-commerce site.</span></span> <span data-ttu-id="cb732-170">O construtor de sites do Commerce fornece várias configurações de estoque para controlar o comportamento de compras e merchandising.</span><span class="sxs-lookup"><span data-stu-id="cb732-170">Commerce site builder provides various inventory settings to control merchandising and purchase behavior.</span></span> <span data-ttu-id="cb732-171">Para obter mais informações, consulte [aplicar configurações de estoque](inventory-settings.md).</span><span class="sxs-lookup"><span data-stu-id="cb732-171">For more information, see [Apply inventory settings](inventory-settings.md).</span></span>

## <a name="pos-inventory-lookup-with-channel-side-calculation"></a><span data-ttu-id="cb732-172">Pesquisa de estoque de PDV com cálculo do canal</span><span class="sxs-lookup"><span data-stu-id="cb732-172">POS inventory lookup with channel-side calculation</span></span>

<span data-ttu-id="cb732-173">Na versão 10.0.9 e anterior do Commerce, a operação **Pesquisa de estoque** do PDV usava uma chamada de serviço em tempo real para o headquarters para obter informações de estoque do produto selecionado, para a loja atual do usuário e quaisquer outras lojas que são configuradas para o grupo de atendimento como parte da configuração do canal da loja.</span><span class="sxs-lookup"><span data-stu-id="cb732-173">In the Commerce release 10.0.9 and earlier, the **Inventory lookup** operation in POS used a real-time service call to headquarters to get inventory information for the selected product for both the user's current store and any other stores that are configured for the fulfillment group as part of the channel configuration for the store.</span></span> <span data-ttu-id="cb732-174">Na versão 10.0.10 e posterior do Commerce, você pode desativar as chamadas de serviço em tempo real para o headquarters e, em vez disso, usar o cálculo do canal no Commerce Server para determinar o estoque disponível que está fisicamente disponível para a loja e quaisquer outros locais definidos no grupo de atendimento.</span><span class="sxs-lookup"><span data-stu-id="cb732-174">In Commerce release 10.0.10 and later, you can turn off real-time service calls to headquarters and instead use channel-side calculation on the Commerce server to determine the on-hand inventory that is physically available for the store and any other locations that are defined in the fulfillment group.</span></span> <span data-ttu-id="cb732-175">Essa configuração de estoque calculada por canal também é útil em locais nos quais a conectividade com a Internet não é confiável, porque não é preciso estar online para fazer pesquisas de estoque no headquarters.</span><span class="sxs-lookup"><span data-stu-id="cb732-175">This channel-calculated inventory configuration is also useful for locations where internet connectivity is unreliable, because you don't have to be online to get inventory lookups headquarters.</span></span>

<span data-ttu-id="cb732-176">Quando configurado e gerenciado corretamente, o cálculo de canal pode fornecer uma estimativa mais confiável do estoque atual da loja, já que usa os dados transacionais que estão no banco de dados do canal do Commerce, mas sobre os quais o headquarters talvez ainda não tenha informações.</span><span class="sxs-lookup"><span data-stu-id="cb732-176">When channel-side calculation is correctly configured and managed, it can provide a more reliable estimate of the current store inventory because it uses the transactional data that is in the Commerce channel database but that headquarters might not yet have information about.</span></span> <span data-ttu-id="cb732-177">Por exemplo, se você usar a chamada de serviço em tempo real existente em pesquisas de estoque no PDV, o headquarters provavelmente ainda não terá informações sobre uma venda cash-and-carry de um produto que acabou de ocorrer.</span><span class="sxs-lookup"><span data-stu-id="cb732-177">For example, if you use the existing real-time service call for inventory lookups in POS, headquarters probably won't yet have information about a cash-and-carry sale that just occurred for a product.</span></span> <span data-ttu-id="cb732-178">Sendo assim, o valor do estoque disponível que o headquarters devolve em relação a esse produto provavelmente excederá o estoque disponível real da loja em uma unidade.</span><span class="sxs-lookup"><span data-stu-id="cb732-178">Therefore, the on-hand inventory value that headquarters returns for that product will probably exceed the store's actual on-hand inventory by one unit.</span></span> <span data-ttu-id="cb732-179">Entretanto, se o cálculo de canal for usado, a venda cash-and-carry poderá ser levada em consideração no cálculo e deduzida do valor disponível que é mostrado.</span><span class="sxs-lookup"><span data-stu-id="cb732-179">However, if you use channel-side calculation, the cash-and-carry sale can be factored into the calculation and deducted from the on-hand value that is shown.</span></span> <span data-ttu-id="cb732-180">Embora os valores fornecidos pelo cálculo de canal e pela chamada de serviço em tempo real sejam apenas estimativas do estoque disponível, é muito mais provável que o valor fornecido pelo cálculo seja preciso em relação à loja atual.</span><span class="sxs-lookup"><span data-stu-id="cb732-180">Although the values that both the channel-side calculation and the real-time service call provide are only estimates of on-hand inventory, the value that the channel-side calculation provides is much more likely to be accurate for the current store.</span></span>

<span data-ttu-id="cb732-181">Para configurar a operação **Pesquisa de estoque** no PDV no headquarters para usar a lógica de cálculo do canal e desativar a chamada de serviço em tempo real, siga estas etapas.</span><span class="sxs-lookup"><span data-stu-id="cb732-181">To configure the POS **Inventory lookup** operation in headquarters to use the channel-side calculation logic and turn off real-time service call, follow these steps.</span></span>

1. <span data-ttu-id="cb732-182">Vá para **Retail e Commerce \> Configuração de canal \> Configuração do PDV \> Perfis de PDV \> Perfis de funcionalidade**.</span><span class="sxs-lookup"><span data-stu-id="cb732-182">Go to **Retail and Commerce \> Channel setup \> POS setup \> POS profiles \> Functionality profiles**.</span></span>
1. <span data-ttu-id="cb732-183">Selecione um perfil de funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="cb732-183">Select a functionality profile.</span></span>
1. <span data-ttu-id="cb732-184">Na FastTab **Funções**, na seção **Cálculo da disponibilidade de estoque**, altere o valor do campo **Modo de cálculo da disponibilidade de estoque** de **Serviço em tempo real** para **Canal**.</span><span class="sxs-lookup"><span data-stu-id="cb732-184">On the **Functions** FastTab, in the **Inventory availability calculation** section, change the value of **Inventory availability calculation mode** from **Real time service** to **Channel**.</span></span> <span data-ttu-id="cb732-185">Por padrão, todos os perfis de funcionalidade usam chamadas de serviço em tempo real.</span><span class="sxs-lookup"><span data-stu-id="cb732-185">By default, all functionality profiles use real-time service calls.</span></span> <span data-ttu-id="cb732-186">Você deve alterar o valor desse campo se quiser usar a lógica de cálculo do canal.</span><span class="sxs-lookup"><span data-stu-id="cb732-186">You must change the value of this field if you want to use channel-side calculation logic.</span></span> <span data-ttu-id="cb732-187">Toda loja de varejo vinculada ao perfil de funcionalidade selecionado será afetada por essa alteração.</span><span class="sxs-lookup"><span data-stu-id="cb732-187">Every retail store that is linked to the selected functionality profile will be affected by this change.</span></span>

<span data-ttu-id="cb732-188">Você deve sincronizar as alterações nos canais usando o processo de agenda de distribuição no headquarters executando as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="cb732-188">You must then sync the changes to the channels through the distribution schedule process in headquarters by following these steps.</span></span>

1. <span data-ttu-id="cb732-189">Vá para **Varejo e Comércio \> TI de Varejo e Comércio \> Agenda de distribuição**.</span><span class="sxs-lookup"><span data-stu-id="cb732-189">Go to **Retail and Commerce \> Retail and Commerce IT \> Distribution schedule**.</span></span>
1. <span data-ttu-id="cb732-190">Execute o trabalho **1070** (**Configuração do canal**).</span><span class="sxs-lookup"><span data-stu-id="cb732-190">Run the **1070** (**Channel configuration**) job.</span></span>

<span data-ttu-id="cb732-191">Após a conclusão da configuração, as informações fornecidas sobre o estoque disponível fisicamente não usam mais uma chamada de serviço em tempo real quando um usuário no aplicativo de PDV usa a operação **Pesquisa de estoque** (exibições padrão e matriciais).</span><span class="sxs-lookup"><span data-stu-id="cb732-191">After the configuration is completed, the information that is provided about physically available inventory no longer uses a real-time service call when a user in the POS application uses the **Inventory lookup** operation (standard and matrix views).</span></span> <span data-ttu-id="cb732-192">Em vez disso, os dados sobre o estoque disponível fisicamente da loja atual e de todas as lojas do grupo de atendimento são calculados com base no último instantâneo conhecido fornecido ao banco de dados do canal na sede do Commerce.</span><span class="sxs-lookup"><span data-stu-id="cb732-192">Instead, data about physically available inventory for the current store and all the stores in the fulfillment group is calculated based on the last-known snapshot that was delivered to the channel database from Commerce Headquarters.</span></span> <span data-ttu-id="cb732-193">O valor do instantâneo é refinado ainda mais pelo cálculo de canal para ajustar o valor disponível fisicamente, com base em vendas adicionais ou transações de retorno existentes do produto selecionado no banco de dados do canal que não foram incluídas no último instantâneo sincronizado do trabalho 1130.</span><span class="sxs-lookup"><span data-stu-id="cb732-193">The snapshot value is further refined by the channel-side calculation to adjust the physically available value, based on additional sales or return transactions that exist for the selected product in the channel database that were not included in the last synchronized snapshot from the 1130 job.</span></span> <span data-ttu-id="cb732-194">Se o banco de dados do canal não contiver dados transacionais de nenhum dos depósitos ou lojas do grupo de atendimento, ele não conterá transações adicionais que possam ser fatoradas em um recálculo do valor.</span><span class="sxs-lookup"><span data-stu-id="cb732-194">If the channel database doesn't contain transactional data for any of the warehouses or stores in the fulfillment group, it contains no additional transactions that can be factored into a recalculation of the value.</span></span> <span data-ttu-id="cb732-195">Com isso, a melhor estimativa de estoque disponível a ser mostrada sobre esses depósitos ou lojas são os dados do último instantâneo conhecido da sede do Commerce.</span><span class="sxs-lookup"><span data-stu-id="cb732-195">Therefore, the best estimate of on-hand inventory that can be shown for those warehouses or stores is the data from the last-known Commerce Headquarters snapshot.</span></span>

<span data-ttu-id="cb732-196">As telas **Atendimento da ordem** do PDV também aproveitam o cálculo de canal para mostrar o estoque disponível de itens quando uma linha de atendimento de ordens é selecionada e um usuário visualiza o painel **Detalhes** do estoque disponível sobre o item selecionado.</span><span class="sxs-lookup"><span data-stu-id="cb732-196">The **Order fulfillment** screens of POS also leverage the channel side calculation to show on-hand inventory for items when an order fulfillment line is selected and a user views the **Details** panel for on-hand inventory for the selected item.</span></span>

## <a name="optimize-your-inventory-data"></a><span data-ttu-id="cb732-197">Otimizar os dados de estoque</span><span class="sxs-lookup"><span data-stu-id="cb732-197">Optimize your inventory data</span></span>

<span data-ttu-id="cb732-198">Para garantir a melhor estimativa de estoque possível, é essencial que você use os seguintes trabalhos em lotes do Commerce e os execute com frequência:</span><span class="sxs-lookup"><span data-stu-id="cb732-198">To ensure the best possible estimate of inventory, it's critical that you use the following Commerce batch jobs and run them frequently:</span></span>

- <span data-ttu-id="cb732-199">**Trabalho P** – O trabalho P é encontrado na página **Agendas de distribuição** e deve ser executado com frequência.</span><span class="sxs-lookup"><span data-stu-id="cb732-199">**P-job** – The P-job is found on the **Distribution schedules** page and should be run frequently.</span></span> <span data-ttu-id="cb732-200">Tal trabalho reúne ordens de comércio eletrônico, ordens de clientes assíncronas criadas pelo PDV e ordens de cash-and-carry criadas pelo PDV dos bancos de dados do canal para a sede do Commerce, para que possam ser processadas posteriormente.</span><span class="sxs-lookup"><span data-stu-id="cb732-200">This job brings e-Commerce orders, asynchronous customer orders that POS created, and cash-and-carry orders that POS created from the channel databases into Commerce Headquarters, so that they can be processed further.</span></span> <span data-ttu-id="cb732-201">Até que esses dados sejam sincronizados do canal para a sede do Commerce, a última não terá informações sobre ajustes de estoque de produtos nos depósitos resultantes dessas transações.</span><span class="sxs-lookup"><span data-stu-id="cb732-201">Until this data is synced from the channel to Commerce Headquarters, Commerce Headquarters has no information about inventory adjustments to products in the warehouses that result from those transactions.</span></span>
- <span data-ttu-id="cb732-202">**Sincronizar ordens** – Este trabalho processa os dados transacionais brutos na sede do Commerce, fornecidos pelo trabalho P, e converte transações de ordens de comércio eletrônico e de clientes assíncronas em ordens de venda na sede do Commerce.</span><span class="sxs-lookup"><span data-stu-id="cb732-202">**Synchronize orders** – This job processes the raw transactional data in Commerce Headquarters that the P-job provides and converts e-Commerce and asynchronous customer order transactions into sales orders in Commerce Headquarters.</span></span> <span data-ttu-id="cb732-203">Até que tal trabalho seja processado e as ordens do cliente sejam criadas, nenhuma transação de estoque será gerada.</span><span class="sxs-lookup"><span data-stu-id="cb732-203">Until this job is processed and the sales orders are created, no inventory transactions are created.</span></span> <span data-ttu-id="cb732-204">Portanto, o estoque disponível na sede do Commerce não considerará as transações.</span><span class="sxs-lookup"><span data-stu-id="cb732-204">Therefore, on-hand inventory in Commerce Headquarters won't consider the transactions.</span></span>
- <span data-ttu-id="cb732-205">**Calcular demonstrativos transacionais em lote** – Em transações cash-and-carry criadas na loja, o processo de lançamento de fluxo constante garante que o estoque relacionado às vendas seja atualizado com eficiência.</span><span class="sxs-lookup"><span data-stu-id="cb732-205">**Calculate transactional statements in batch** – For cash-and-carry transactions that are created in the store, the trickle feed posting process ensures that inventory that is related to the sales is updated efficiently.</span></span> <span data-ttu-id="cb732-206">Para obter o processamento mais eficiente de transações de estoque para ordens de cash-and-carry, configure seu sistema para usar [lançamento de fluxo constante](./trickle-feed.md).</span><span class="sxs-lookup"><span data-stu-id="cb732-206">To get the most efficient processing of inventory transactions for cash-and-carry orders, make sure that you configure your system to use [trickle feed posting](./trickle-feed.md).</span></span>
- <span data-ttu-id="cb732-207">**Lançar demonstrativos financeiros em lote** – Este trabalho também é necessário para lançamento de fluxo constante.</span><span class="sxs-lookup"><span data-stu-id="cb732-207">**Post transactional statements in batch** – This job is also required for trickle feed posting.</span></span> <span data-ttu-id="cb732-208">Segue o trabalho **Calcular demonstrativos transacionais em lote**.</span><span class="sxs-lookup"><span data-stu-id="cb732-208">It follows the **Calculate transactional statements in batch** job.</span></span> <span data-ttu-id="cb732-209">Esse trabalho lança sistematicamente os demonstrativos calculados, para que as ordens de vendas de cash-and-carry sejam criadas na sede do Commerce e esta reflita com mais precisão o estoque da loja.</span><span class="sxs-lookup"><span data-stu-id="cb732-209">This job systematically posts the calculated statements, so that sales orders for cash-and-carry sales are created in Commerce Headquarters and Commerce Headquarters more accurately reflects your store's inventory.</span></span>
- <span data-ttu-id="cb732-210">**Disponibilidade do produto** – Este trabalho cria o instantâneo do estoque da sede do Commerce.</span><span class="sxs-lookup"><span data-stu-id="cb732-210">**Product availability** – This job creates the snapshot of inventory from Commerce Headquarters.</span></span>
- <span data-ttu-id="cb732-211">**1130 (Disponibilidade do produto)** – Este trabalho é encontrado na página **Agendas de distribuição** e deve ser executado imediatamente após o trabalho **Disponibilidade do produto**.</span><span class="sxs-lookup"><span data-stu-id="cb732-211">**1130 (Product availability)** – This job is found on the **Distribution schedules** page and should be run immediately after the **Product availability** job.</span></span> <span data-ttu-id="cb732-212">Ele desloca os dados do instantâneo do estoque da sede do Commerce para os bancos de dados do canal.</span><span class="sxs-lookup"><span data-stu-id="cb732-212">This job transports the inventory snapshot data from Commerce Headquarters to the channel databases.</span></span>

> [!NOTE]
> - <span data-ttu-id="cb732-213">É uma boa prática executar os trabalhos **Disponibilidade do produto** e **1130** por hora e agendar o trabalho P, sincronizar ordens e reduzir trabalhos relacionados à publicação de feed com a mesma frequência ou uma frequência superior.</span><span class="sxs-lookup"><span data-stu-id="cb732-213">It is a best practice to run the **Product availability** and **1130** jobs on an hourly basis, and to schedule P-job, synchronize orders, and trickle feed posting-related jobs with the same or higher frequency.</span></span>
> - <span data-ttu-id="cb732-214">Por motivos de desempenho, quando os cálculos de disponibilidade de estoque de canal são usados para fazer uma solicitação de disponibilidade de estoque usando a API de comércio eletrônico ou a lógica de estoque do canal de PDV, o cálculo usa um cache para determinar se já passou tempo suficiente para justificar a execução da lógica de cálculo novamente.</span><span class="sxs-lookup"><span data-stu-id="cb732-214">For performance reasons, when channel-side inventory availability calculations are used to make an inventory availability request using the e-Commerce API's or the POS channel-side inventory logic, the calculation uses a cache to determine whether enough time has passed to justify running the calculation logic again.</span></span> <span data-ttu-id="cb732-215">O cache padrão é definido como 60 segundos.</span><span class="sxs-lookup"><span data-stu-id="cb732-215">The default cache is set to 60 seconds.</span></span> <span data-ttu-id="cb732-216">Por exemplo, você ativou o cálculo do canal da sua loja e exibiu o estoque disponível de um produto na página **Pesquisa de estoque**.</span><span class="sxs-lookup"><span data-stu-id="cb732-216">For example, you turned on channel-side calculation for your store and viewed the on-hand inventory for a product on the **Inventory lookup** page.</span></span> <span data-ttu-id="cb732-217">Se uma unidade do produto for vendida, a página **Pesquisa de estoque** não mostrará o estoque reduzido até que o cache tenha sido limpo.</span><span class="sxs-lookup"><span data-stu-id="cb732-217">If one unit of the product is then sold, the **Inventory lookup** page won't show the reduced inventory until the cache has been cleared.</span></span> <span data-ttu-id="cb732-218">Depois que os usuários lançam transações no PDV, eles devem esperar 60 segundos antes de verificar se o estoque disponível foi reduzido.</span><span class="sxs-lookup"><span data-stu-id="cb732-218">After users post transactions in POS, they should wait 60 seconds before they verify that the on-hand inventory has been reduced.</span></span>

<span data-ttu-id="cb732-219">Se o seu cenário comercial exigir um tempo de cache menor, entre em contato com o representante de suporte do produto para obter ajuda.</span><span class="sxs-lookup"><span data-stu-id="cb732-219">If your business scenario requires a smaller cache time, contact your product support representative for assistance.</span></span>


[!INCLUDE[footer-include](../includes/footer-banner.md)]
